<?xml version="1.0" ?><PAPER><mode2 hasDoc="yes" name="S0021869313002846.tmf1" version="elsevier"/>
<TITLE>Sets of lengths in maximal orders in central simple algebras
</TITLE>
<ABSTRACT>

Abstract
<s sid="1"><CoreSc1 advantage="None" conceptID="Res1" novelty="None" type="Res"/><text>Let O be a holomorphy ring in a global field K, and R a classical maximal O-order in a central simple algebra over K.</text></s>
<s sid="2"><CoreSc1 advantage="None" conceptID="Obj1" novelty="None" type="Obj"/><text>We study sets of lengths of factorizations of cancellative elements of R into atoms (irreducibles).</text></s>
<s sid="3"><CoreSc1 advantage="None" conceptID="Res2" novelty="None" type="Res"/><text>In a large majority of cases there exists a transfer homomorphism to a monoid of zero-sum sequences over a ray class group of O, which implies that all the structural finiteness results for sets of lengths-valid for commutative Krull monoids with finite class group-hold also true for R.</text></s>
<s sid="4"><CoreSc1 advantage="None" conceptID="Res3" novelty="None" type="Res"/><text>If O is the ring of algebraic integers of a number field K, we prove that in the remaining cases no such transfer homomorphism can exist and that several invariants dealing with sets of lengths are infinite.</text></s>
</ABSTRACT>
<BODY>

Introduction
<s sid="5"><CoreSc1 advantage="None" conceptID="Res4" novelty="None" type="Res"/><text>Let H be a (left- and right-) cancellative semigroup and H× its group of units.</text></s>
<s sid="6"><CoreSc1 advantage="None" conceptID="Res5" novelty="None" type="Res"/><text>An element u∈H∖H× is called irreducible (or an atom) if u=ab with a,b∈H implies that a∈H× or b∈H×.</text></s>
<s sid="7"><CoreSc1 advantage="None" conceptID="Res6" novelty="None" type="Res"/><text>If a∈H∖H×, then l∈N is a length of a if there exist atoms u1,…,ul∈H with a=u1⋅⋯⋅ul, and the set of lengths of a, written as L(a), consists of all such lengths.</text></s>
<s sid="8"><CoreSc1 advantage="None" conceptID="Res7" novelty="None" type="Res"/><text>If there is a non-unit a∈H with |L(a)|&gt;1, say 1&lt;k&lt;l∈L(a), then for every n∈N, we have L(an)⊃{kn+ν(l-k)|ν∈[0,n]}, which shows that sets of lengths become arbitrarily large.</text></s>
<s sid="9"><CoreSc1 advantage="None" conceptID="Res8" novelty="None" type="Res"/><text>If H is commutative and satisfies the ACC on divisorial ideals, then all sets of lengths are finite and non-empty.</text></s>
<s sid="10"><CoreSc1 advantage="None" conceptID="Goa1" novelty="None" type="Goa"/><text>Sets of lengths (and all invariants derived from them, such as the set of distances) are among the most investigated invariants in factorization theory.</text></s>
<s sid="11"><CoreSc1 advantage="None" conceptID="Bac1" novelty="None" type="Bac"/><text>So far research has almost been entirely devoted to the commutative setting, and it has focused on commutative noetherian domains, commutative Krull monoids, numerical monoids, and others (cf.</text></s>
[1,12,27,28,26,20,7]).
<s sid="12"><CoreSc1 advantage="None" conceptID="Bac2" novelty="None" type="Bac"/><text>Recall that a commutative noetherian domain is a Krull domain if and only if the monoid of non-zero elements is a Krull monoid and this is the case if and only if the domain is integrally closed.</text></s>
<s sid="13"><CoreSc1 advantage="None" conceptID="Bac3" novelty="None" type="Bac"/><text>Suppose that H is a Krull monoid (so completely integrally closed and the ACC on divisorial two-sided ideals holds true).</text></s>
<s sid="14"><CoreSc1 advantage="None" conceptID="Obj2" novelty="None" type="Obj"/><text>Then the monoid of divisorial two-sided ideals is a free abelian monoid.</text></s>
<s sid="15"><CoreSc1 advantage="None" conceptID="Obj3" novelty="None" type="Obj"/><text>If H is commutative (or at least normalizing), this gives rise to the construction of a transfer homomorphism θ:H→B(GP), where B(GP) is the monoid of zero-sum sequences over a subset GP of the class group G of H.</text></s>
<s sid="16"><CoreSc1 advantage="None" conceptID="Obj4" novelty="None" type="Obj"/><text>Transfer homomorphisms preserve sets of lengths, and if GP is finite, then B(GP) is a finitely generated commutative Krull monoid, whose sets of lengths can be studied with methods from combinatorial number theory.</text></s>
<s sid="17"><CoreSc1 advantage="None" conceptID="Obj5" novelty="None" type="Obj"/><text>This approach has lead to a large variety of structural results for sets of lengths in commutative Krull monoids (see [27,24] for an overview).</text></s>
<s sid="18"><CoreSc1 advantage="None" conceptID="Obj6" novelty="None" type="Obj"/><text>Only first hesitant steps were taken so far to study factorization properties in a non-commutative setting (for example, quaternion orders are investigated in [19,18,16]), semifirs in ([14,15], semigroup algebras in [37]).</text></s>
<s sid="19"><CoreSc1 advantage="None" conceptID="Obj7" novelty="None" type="Obj"/><text>The present paper provides an in-depth study of sets of lengths in classical maximal orders over holomorphy rings in global fields.</text></s>
<s sid="20"><CoreSc1 advantage="None" conceptID="Res9" novelty="None" type="Res"/><text>Let O be a commutative Krull domain with quotient field K, A a central simple algebra over K, R a maximal order in A, and R• the semigroup of cancellative elements (equivalently, R is a PI Krull ring).</text></s>
<s sid="21"><CoreSc1 advantage="None" conceptID="Obj8" novelty="None" type="Obj"/><text>Any approach to study sets of lengths, which runs as described above and involves divisorial two-sided ideals, is restricted to normalizing Krull monoids [25, Theorem 4.13].</text></s>
<s sid="22"><CoreSc1 advantage="None" conceptID="Obj9" novelty="None" type="Obj"/><text>For this reason we develop the theory of divisorial one-sided ideals.</text></s>
<s sid="23"><CoreSc1 advantage="None" conceptID="Res10" novelty="None" type="Res"/><text>In Section 3 we fix our terminology in the setting of cancellative small categories.</text></s>
<s sid="24"><CoreSc1 advantage="None" conceptID="Res11" novelty="None" type="Res"/><text>Following ideas of Asano and Murata [5] and partly of Rehm [45,46], we provide in Section 4 a factorization theory of integral elements in arithmetical groupoids, and introduce an abstract transfer homomorphism for a subcategory of such a groupoid (Theorem 4.15).</text></s>
<s sid="25"><CoreSc1 advantage="None" conceptID="Res12" novelty="None" type="Res"/><text>In Section 5 the divisorial one-sided ideal theory of maximal orders in quotient semigroups is given, and Proposition 5.16 establishes the relationship with arithmetical groupoids.</text></s>
<s sid="26"><CoreSc1 advantage="None" conceptID="Res13" novelty="None" type="Res"/><text>Theorem 5.23 is a main result in the abstract setting of arithmetical maximal orders (Remarks 5.17.2 and 5.24.1 reveal how the well-known transfer homomorphisms for normalizing Krull monoids fit into our abstract theory).</text></s>
<s sid="27"><CoreSc1 advantage="None" conceptID="Res14" novelty="None" type="Res"/><text>For maximal orders over commutative Krull domains, we see that all sets of lengths are finite and non-empty (Corollary 5.30).</text></s>
<s sid="28"><CoreSc1 advantage="None" conceptID="Res15" novelty="None" type="Res"/><text>In Section 6 we demonstrate that classical maximal orders over holomorphy rings in global fields fulfill the abstract assumptions of Theorem 5.23, which implies the following structural finiteness results on sets of lengths.</text></s>
Theorem 1.1
<s sid="29"><CoreSc1 advantage="None" conceptID="Res16" novelty="None" type="Res"/><text>Let O be a holomorphy ring in a global field K, A a central simple algebra over K, and R a classical maximal O-order of A.</text></s>
<s sid="30"><CoreSc1 advantage="None" conceptID="Mod1" novelty="None" type="Mod"/><text>Suppose that every stably free left R-ideal is free.</text></s>
<s sid="31"><CoreSc1 advantage="None" conceptID="Mod2" novelty="None" type="Mod"/><text>Then there exists a transfer homomorphism θ:R•→B(CA(O)), whereCA(O)=F×(O)/{aO|a∈K×,av&gt;0 for all archimedean places v of K where A is ramified} is a ray class group of O, and B(CA(O)) is the monoid of zero-sum sequences over CA(O).</text></s>
In particular,1.
<s sid="32"><CoreSc1 advantage="None" conceptID="Mod3" novelty="None" type="Mod"/><text>The set of distances Δ(R•) is a finite interval, and if it is non-empty, then minΔ(R•)=1.</text></s>
2.
<s sid="33"><CoreSc1 advantage="None" conceptID="Exp1" novelty="None" type="Exp"/><text>For every k∈N, the union of sets of lengths containing k, denoted by Uk(R•), is a finite interval.</text></s>
3.
<s sid="34"><CoreSc1 advantage="None" conceptID="Res17" novelty="None" type="Res"/><text>There is an M∈N0 such that for every a∈R• the set of lengths L(a) is an AAMP with difference d∈Δ(R•) and bound M.</text></s>
<s sid="35"><CoreSc1 advantage="None" conceptID="Con1" novelty="None" type="Con"/><text>Thus, under the additional hypothesis that every stably free left R-ideal is free, we obtain a transfer homomorphism to a monoid of zero-sum sequences over a finite abelian group.</text></s>
<s sid="36"><CoreSc1 advantage="None" conceptID="Mot1" novelty="None" type="Mot"/><text>Therefore, sets of lengths in R are the same as sets of lengths in a commutative Krull monoid with finite class group.</text></s>
<s sid="37"><CoreSc1 advantage="None" conceptID="Mot2" novelty="None" type="Mot"/><text>If A satisfies the Eichler condition relative to O, then every stably free left R-ideal is free by Eichlerʼs Theorem.</text></s>
<s sid="38"><CoreSc1 advantage="None" conceptID="Mot3" novelty="None" type="Mot"/><text>In particular, if K is a number field and O is its ring of algebraic integers, then A satisfies the Eichler condition relative to O unless A is a totally definite quaternion algebra.</text></s>
<s sid="39"><CoreSc1 advantage="None" conceptID="Res18" novelty="None" type="Res"/><text>Thus in this setting Theorem 1.1 covers the large majority of cases, and the following complementary theorem shows that the condition that every stably free left R-ideal is free is indeed necessary.</text></s>
Theorem 1.2
<s sid="40"><CoreSc1 advantage="None" conceptID="Res19" novelty="None" type="Res"/><text>Let O be the ring of algebraic integers in a number field K, A a central simple algebra over K, and R a classical maximal O-order of A.</text></s>
<s sid="41"><CoreSc1 advantage="None" conceptID="Res20" novelty="None" type="Res"/><text>If there exists a stably free left R-ideal that is not free, then there exists no transfer homomorphism θ:R•→B(GP), where GP is any subset of an abelian group. Moreover,1.</text></s>
Δ(R•)=N.
2.
<s sid="42"><CoreSc1 advantage="None" conceptID="Res21" novelty="None" type="Res"/><text>For every k⩾3, we have N⩾3⊂Uk(R•)⊂N⩾2.</text></s>
<s sid="43"><CoreSc1 advantage="None" conceptID="Res22" novelty="None" type="Res"/><text>The proof of Theorem 1.2 is based on recent work of Kirschmer and Voight [39,40], and will be given in Section 7.</text></s>
<s sid="44"><CoreSc1 advantage="None" conceptID="Res23" novelty="None" type="Res"/><text>If H is a commutative Krull monoid with an infinite class group such that every class contains a prime divisor, then Kainrath showed that every finite subset of N⩾2 can be realized as a set of lengths ([38], or [27, Section 7.4]), whence Δ(H)=N and Uk(H)=N⩾2 for all k⩾2.</text></s>
<s sid="45"><CoreSc1 advantage="None" conceptID="Res24" novelty="None" type="Res"/><text>However, we explicitly show that in the above situation no transfer homomorphism is possible, implying that the factorization of R• cannot be modeled by a monoid of zero-sum sequences.</text></s>
<s sid="46"><CoreSc1 advantage="None" conceptID="Mod4" novelty="None" type="Mod"/><text>A similar statement about sets of lengths in the integer-valued polynomials, as well as the impossibility of a transfer homomorphism to a monoid of zero-sum sequences, was recently shown by Frisch [21].</text></s>
Preliminaries
<s sid="47"><CoreSc1 advantage="None" conceptID="Mod5" novelty="None" type="Mod"/><text>Let N denote the set of positive integers and put N0={0}∪N.</text></s>
<s sid="48"><CoreSc1 advantage="None" conceptID="Mod6" novelty="None" type="Mod"/><text>For integers a,b∈Z, let [a,b]={x∈Z|a⩽x⩽b} denote the discrete interval.</text></s>
<s sid="49"><CoreSc1 advantage="None" conceptID="Mod7" novelty="None" type="Mod"/><text>All semigroups and rings are assumed to have an identity element, and all homomorphisms respect the identity.</text></s>
<s sid="50"><CoreSc1 advantage="None" conceptID="Mod8" novelty="None" type="Mod"/><text>By a factorization we always mean a factorization of a cancellative element into irreducible elements (a formal definition follows in Section 3).</text></s>
<s sid="51"><CoreSc1 advantage="None" conceptID="Goa2" novelty="None" type="Goa"/><text>In order to study factorizations in semigroups we will have to investigate their divisorial one-sided ideal theory, in which the multiplication of ideals only gains sufficiently nice properties if one considers it as a partial operation that is only defined for certain pairs of ideals.</text></s>
<s sid="52"><CoreSc1 advantage="None" conceptID="Goa3" novelty="None" type="Goa"/><text>This is the reason why we introduce our concepts in the setting of groupoids and consider subcategories of these groupoids.</text></s>
<s sid="53"><CoreSc1 advantage="None" conceptID="Bac4" novelty="None" type="Bac"/><text>Throughout the paper there will be many statements that can be either formulated &quot;from the left&quot; or &quot;from the right&quot;, and most of the time it is obvious how the symmetric statement should look like.</text></s>
<s sid="54"><CoreSc1 advantage="None" conceptID="Bac5" novelty="None" type="Bac"/><text>Therefore often just one variant is formulated and it is left to the reader to fill in the symmetric definition or statement if required.</text></s>
<s sid="55"><CoreSc1 advantage="None" conceptID="Bac6" novelty="None" type="Bac"/><text>Small categories as generalizations of semigroups</text></s>
<s sid="56"><CoreSc1 advantage="None" conceptID="Bac7" novelty="None" type="Bac"/><text>Let H be a small category.</text></s>
<s sid="57"><CoreSc1 advantage="None" conceptID="Mod9" novelty="None" type="Mod"/><text>In the sequel the objects of H play no role, and therefore we shall identify H with the set of morphisms of H.</text></s>
<s sid="58"><CoreSc1 advantage="None" conceptID="Mod10" novelty="None" type="Mod"/><text>We denote by H0 the set of identity morphisms (representing the objects of the category).</text></s>
<s sid="59"><CoreSc1 advantage="None" conceptID="Bac8" novelty="None" type="Bac"/><text>There are two maps s,t:H→H0 such that two elements a,b∈H are composable to a (uniquely determined) element ab∈H if and only if t(a)=s(b).22</text></s>
<s sid="60"><CoreSc1 advantage="None" conceptID="Res25" novelty="None" type="Res"/><text>This choice of t and s is compatible with the usual convention for groupoids, but unfortunately opposite to the usual convention for categories.</text></s>
<s sid="61"><CoreSc1 advantage="None" conceptID="Obj10" novelty="None" type="Obj"/><text>For e,f∈H0 we set H(e,f)={a∈H|s(a)=e,t(a)=f}, H(e)=H(e,e), H(e,⋅)=⋃f′∈H0H(e,f′) and H(⋅,f)=⋃e′∈H0H(e′,f).</text></s>
<s sid="62"><CoreSc1 advantage="None" conceptID="Obs1" novelty="None" type="Obs"/><text>Note that an element e∈H lies in H0 if and only if s(e)=t(e)=e, ea=a for all a∈H(e,⋅) and ae=a for all a∈H(⋅,e).</text></s>
<s sid="63"><CoreSc1 advantage="None" conceptID="Obj11" novelty="None" type="Obj"/><text>A semigroup may be viewed as a category with a single object (corresponding to its identity element), and elements of the semigroup as morphisms with source and target this unique object.</text></s>
<s sid="64"><CoreSc1 advantage="None" conceptID="Obj12" novelty="None" type="Obj"/><text>In this way the notion of a small category generalizes the usual notion of a semigroup (H is a semigroup if and only if |H0|=1).</text></s>
<s sid="65"><CoreSc1 advantage="None" conceptID="Obj13" novelty="None" type="Obj"/><text>We will consider a semigroup to be a small category in this sense whenever this is convenient, without explicitly stating this anymore.</text></s>
<s sid="66"><CoreSc1 advantage="None" conceptID="Mod11" novelty="None" type="Mod"/><text>For A,B⊂H we write AB={ab∈H|a∈A,b∈Bandt(a)=s(b)} for the set of all possible products, and if b∈H, then Ab=A{b} and bA={b}A.</text></s>
<s sid="67"><CoreSc1 advantage="None" conceptID="Mod12" novelty="None" type="Mod"/><text>An element a∈H is called left-cancellative if it is an epimorphism (ab=ac implies b=c for all b,c∈H(t(a),⋅)), and it is called right-cancellative if it is a monomorphism (ba=ca implies b=c for all b,c∈H(⋅,s(a))), and cancellative if it is both.</text></s>
<s sid="68"><CoreSc1 advantage="None" conceptID="Mod13" novelty="None" type="Mod"/><text>The set of all cancellative elements is denoted by H•, and H is called cancellative if H=H•.</text></s>
<s sid="69"><CoreSc1 advantage="None" conceptID="Mod14" novelty="None" type="Mod"/><text>The set of isomorphisms of H will also be called the set of units, and we denote it by H×.</text></s>
<s sid="70"><CoreSc1 advantage="None" conceptID="Mod15" novelty="None" type="Mod"/><text>A subcategory D⊂H is wide if D0=H0.</text></s>
<s sid="71"><CoreSc1 advantage="None" conceptID="Mod16" novelty="None" type="Mod"/><text>In line with the multiplicative notation, if H and D are two small categories, we call a functor f:H→D a homomorphism (of small categories).</text></s>
<s sid="72"><CoreSc1 advantage="None" conceptID="Mod17" novelty="None" type="Mod"/><text>Explicitly, a map f:H→D is a homomorphism if f(H0)⊂D0 and whenever a,b∈H with t(a)=s(b) then also f(a)⋅f(b) is defined (i.e., t(f(a))=s(f(b))) and f(ab)=f(a)f(b).</text></s>
<s sid="73"><CoreSc1 advantage="None" conceptID="Met1" novelty="None" type="Met"/><text>If H is a commutative semigroup, and D⊂H is a subsemigroup, then a localization D-1H with an embedding H↪D-1H exists whenever all elements of D are cancellative, and in particular H has a group of fractions if and only if H is cancellative.</text></s>
<s sid="74"><CoreSc1 advantage="None" conceptID="Met2" novelty="None" type="Met"/><text>If H is a non-commutative semigroup and D⊂H, then a semigroup of right fractions with respect to D, HD-1, in which every element can be represented as a fraction ad-1 with a∈H, d∈D, together with an embedding H↪HD-1, exists if and only if D is cancellative and D satisfies the right Ore condition, meaning aD∩dH≠∅ for all a∈H and d∈D.</text></s>
<s sid="75"><CoreSc1 advantage="None" conceptID="Met3" novelty="None" type="Met"/><text>For a semigroup of left fractions, D-1H, one gets the analogous left Ore condition, and if D satisfies both, the left and the right Ore condition, then every semigroup of right fractions is a semigroup of left fractions and conversely.</text></s>
<s sid="76"><CoreSc1 advantage="None" conceptID="Met4" novelty="None" type="Met"/><text>In this case we write D-1H=HD-1.</text></s>
<s sid="77"><CoreSc1 advantage="None" conceptID="Met5" novelty="None" type="Met"/><text>If H• satisfies the left and right Ore condition, we also write q(H)=H(H•)-1=(H•-1)H for the corresponding semigroup of fractions.</text></s>
<s sid="78"><CoreSc1 advantage="None" conceptID="Res26" novelty="None" type="Res"/><text>The notion of semigroups of fractions generalizes to categories of fractions with analogous conditions [23].</text></s>
<s sid="79"><CoreSc1 advantage="None" conceptID="Res27" novelty="None" type="Res"/><text>Let H be a small category, and D⊂H• a subset of the cancellative elements.</text></s>
<s sid="80"><CoreSc1 advantage="None" conceptID="Res28" novelty="None" type="Res"/><text>Then D admits a calculus of right fractions if D is a wide subcategory of H and it satisfies the right Ore condition, i.e., aD∩dH≠∅ for all a∈H and d∈D with s(a)=s(d).</text></s>
<s sid="81"><CoreSc1 advantage="None" conceptID="Hyp1" novelty="None" type="Hyp"/><text>In that case there exists a small category HD-1 with (HD-1)0=H0 and an embedding j:H→HD-1 (i.e., j is a faithful functor) with j|H0=id and such that every element of HD-1 can be represented in the form j(a)j(d)-1 with a∈H, d∈D and t(a)=t(d), j(D)⊂H× and it is universal with respect to that property, i.e., if f:H→S is any homomorphism with f(D)⊂S×, then there exists a unique D-1f:HD-1→S such that D-1f∘j=f.</text></s>
<s sid="82"><CoreSc1 advantage="None" conceptID="Mod18" novelty="None" type="Mod"/><text>We can assume H⊂HD-1 and take j to be the inclusion map, and we call HD-1 the category of right fractions of H with respect to D.</text></s>
<s sid="83"><CoreSc1 advantage="None" conceptID="Mod19" novelty="None" type="Mod"/><text>If D also admits a left calculus of fractions, then HD-1 is also a category of left fractions, and we write HD-1=D-1H.</text></s>
<s sid="84"><CoreSc1 advantage="None" conceptID="Mod20" novelty="None" type="Mod"/><text>A monoid is a cancellative semigroup satisfying the left and right Ore condition (following the convention of [25]).</text></s>
<s sid="85"><CoreSc1 advantage="None" conceptID="Obj14" novelty="None" type="Obj"/><text>Every monoid has a (left and right) group of fractions which is unique up to unique isomorphism.</text></s>
<s sid="86"><CoreSc1 advantage="None" conceptID="Obj15" novelty="None" type="Obj"/><text>A semigroup H is called normalizing if aH=Ha for all a∈H.</text></s>
<s sid="87"><CoreSc1 advantage="None" conceptID="Obj16" novelty="None" type="Obj"/><text>It is easily checked that a normalizing cancellative semigroup is already a normalizing monoid.</text></s>
<s sid="88"><CoreSc1 advantage="None" conceptID="Obj17" novelty="None" type="Obj"/><text>Let M be a directed multigraph (i.e., a quiver).</text></s>
<s sid="89"><CoreSc1 advantage="None" conceptID="Obj18" novelty="None" type="Obj"/><text>For every edge a of M we write s(a) for the vertex that is its source and t(a) for the vertex that is its target.</text></s>
<s sid="90"><CoreSc1 advantage="None" conceptID="Mod21" novelty="None" type="Mod"/><text>The path category on M, denoted by F(M), is defined as follows: It consists of all tuples y=(e,a1,…,ak,f) with k∈N0, e, f vertices of M and a1,…,ak edges of M with either k=0 and e=f or k&gt;0, s(a1)=e, t(ai)=s(ai+1) for all i∈[1,k-1] and t(ak)=f.</text></s>
<s sid="91"><CoreSc1 advantage="None" conceptID="Mod22" novelty="None" type="Mod"/><text>The set of identities F(M)0 is the set of all tuples with k=0, and given any tuple y as above, s(y)=(e,e) and t(y)=(f,f).</text></s>
<s sid="92"><CoreSc1 advantage="None" conceptID="Mod23" novelty="None" type="Mod"/><text>Composition is defined in the obvious manner by concatenating tuples and removing the two vertices in the middle.</text></s>
<s sid="93"><CoreSc1 advantage="None" conceptID="Goa4" novelty="None" type="Goa"/><text>We identify the set of vertices of M with F(M)0 so that (e,e)=e.</text></s>
<s sid="94"><CoreSc1 advantage="None" conceptID="Goa5" novelty="None" type="Goa"/><text>Every subset M of a small category H will be viewed as a quiver, with vertices {s(a)|a∈M}∪{t(a)|a∈M} and for each a∈M a directed edge (again called a) from s(a) to t(a).</text></s>
Groupoids
<s sid="95"><CoreSc1 advantage="None" conceptID="Obj19" novelty="None" type="Obj"/><text>A groupoid G is a small category in which every element is a unit (i.e., every morphism is an isomorphism).</text></s>
<s sid="96"><CoreSc1 advantage="None" conceptID="Obj20" novelty="None" type="Obj"/><text>If e,f,e′,f′∈G0 and there exist a∈G(e,f) and b∈G(e′,f′), then(1){G(e,e′)→G(f,f′),x↦a-1xb is a bijection.</text></s>
<s sid="97"><CoreSc1 advantage="None" conceptID="Obj21" novelty="None" type="Obj"/><text>For all e∈G0 the set G(e) is a group, called the vertex group or isotropy group of G at e.</text></s>
<s sid="98"><CoreSc1 advantage="None" conceptID="Obj22" novelty="None" type="Obj"/><text>If f∈G0 and a∈G(e,f), then, taking b=a, the map in (1) is a group isomorphism from G(e) to G(f).</text></s>
<s sid="99"><CoreSc1 advantage="None" conceptID="Obj23" novelty="None" type="Obj"/><text>If G(e) is abelian, it can be easily checked that this isomorphism does not depend on the choice of a: If a,a′∈G(e,f), thena′(a-1xa)a′-1=(a′a-1)x(aa′-1)=(a′a-1)(aa′-1)x=x.</text></s>
<s sid="100"><CoreSc1 advantage="None" conceptID="Obj24" novelty="None" type="Obj"/><text>In particular, if G is connected (meaning G(e,e′)≠∅ for all e,e′∈G0) and one vertex group is abelian, then all vertex groups are abelian, and they are canonically isomorphic.</text></s>
<s sid="101"><CoreSc1 advantage="None" conceptID="Obj25" novelty="None" type="Obj"/><text>In this case we define for e∈G0 and x∈G(e) the set (x)={a-1xa|a∈G(e,⋅)}, and the universal vertex group asG={(x)|x∈G(e),e∈G0}.</text></s>
<s sid="102"><CoreSc1 advantage="None" conceptID="Obj26" novelty="None" type="Obj"/><text>G indeed has a natural abelian group structure: For every e∈G0 there is a bijection je:G(e)→G, x↦(x) inducing the structure of an abelian group on G, and because the diagrams commute for every choice of e,f∈G0 and a∈G(e,f), this group structure is independent of the choice of e, yielding a canonical group isomorphism je:G(e)→G for every e∈G0.</text></s>
<s sid="103"><CoreSc1 advantage="None" conceptID="Obj27" novelty="None" type="Obj"/><text>We will use calligraphic letters to denote elements of G.</text></s>
<s sid="104"><CoreSc1 advantage="None" conceptID="Mod24" novelty="None" type="Mod"/><text>If X∈G, then the unique representative of X in G(e), je-1(X), will be denoted by Xe.</text></s>
<s sid="105"><CoreSc1 advantage="None" conceptID="Mod25" novelty="None" type="Mod"/><text>If G is a groupoid, and H⊂G is a subcategory, then HH-1 denotes the set of all right fractions of elements of H.</text></s>
<s sid="106"><CoreSc1 advantage="None" conceptID="Mod26" novelty="None" type="Mod"/><text>Furthermore, HH-1⊂G is a subgroupoid if and only if H satisfies the right Ore condition.</text></s>
<s sid="107"><CoreSc1 advantage="None" conceptID="Mod27" novelty="None" type="Mod"/><text>Krull monoids and Krull rings</text></s>
<s sid="108"><CoreSc1 advantage="None" conceptID="Mod28" novelty="None" type="Mod"/><text>A monoid H is called a Krull monoid if it is completely integrally closed (in other words, a maximal order) and satisfies the ACC on divisorial two-sided ideals.</text></s>
<s sid="109"><CoreSc1 advantage="None" conceptID="Obj28" novelty="None" type="Obj"/><text>A prime Goldie ring R is a Krull ring if it is completely integrally closed and satisfies the ACC on divisorial two-sided ideals (equivalently, its monoid R• of cancellative elements is a Krull monoid; see [25]).</text></s>
<s sid="110"><CoreSc1 advantage="None" conceptID="Obj29" novelty="None" type="Obj"/><text>The theory of commutative Krull monoids is presented in [32,27].</text></s>
<s sid="111"><CoreSc1 advantage="None" conceptID="Obj30" novelty="None" type="Obj"/><text>The simplest examples of non-commutative Krull rings are classical maximal orders in central simple algebras over Dedekind domains (see Section 5.2).</text></s>
<s sid="112"><CoreSc1 advantage="None" conceptID="Obj31" novelty="None" type="Obj"/><text>We discuss monoids of zero-sum sequences.</text></s>
<s sid="113"><CoreSc1 advantage="None" conceptID="Mod29" novelty="None" type="Mod"/><text>Let G=(G,0G,+) be an additively written abelian group, GP⊂G a subset and let Fab(GP) be the (multiplicatively written) free abelian monoid with basis GP.</text></s>
<s sid="114"><CoreSc1 advantage="None" conceptID="Mod30" novelty="None" type="Mod"/><text>Elements S∈Fab(GP) are called sequences over GP, and are written in the form S=g1⋅⋯⋅gl where l∈N0 and g1,…,gl∈GP.</text></s>
<s sid="115"><CoreSc1 advantage="None" conceptID="Mod31" novelty="None" type="Mod"/><text>We denote by |S|=l the length of S. Such a sequence S is said to be a zero-sum sequence if σ(S)=g1+⋯+gl=0G.</text></s>
<s sid="116"><CoreSc1 advantage="None" conceptID="Mod32" novelty="None" type="Mod"/><text>The submonoidB(GP)={S∈Fab(GP)|σ(S)=0}⊂Fab(GP) is called the monoid of zero-sum sequences over GP.</text></s>
<s sid="117"><CoreSc1 advantage="None" conceptID="Mod33" novelty="None" type="Mod"/><text>It is a reduced commutative Krull monoid, which is finitely generated whenever GP is finite [27, Theorem 3.4.2].</text></s>
<s sid="118"><CoreSc1 advantage="None" conceptID="Mod34" novelty="None" type="Mod"/><text>Moreover, every commutative Krull monoid possesses a transfer homomorphism onto a monoid of zero-sum sequences, and thus B(GP) provides a model for the factorization behavior of commutative Krull monoids [27, Section 3.4].</text></s>
Arithmetical invariants
<s sid="119"><CoreSc1 advantage="None" conceptID="Obj32" novelty="None" type="Obj"/><text>In this section we introduce our main arithmetical invariants (rigid factorizations, sets of lengths, sets of distances) and transfer homomorphisms in the setting of cancellative small categories.</text></s>
<s sid="120"><CoreSc1 advantage="None" conceptID="Obj33" novelty="None" type="Obj"/><text>Throughout this section, let H be a cancellative small category.</text></s>
<s sid="121"><CoreSc1 advantage="None" conceptID="Obs2" novelty="None" type="Obs"/><text>H is reduced if H×=H0.</text></s>
<s sid="122"><CoreSc1 advantage="None" conceptID="Obs3" novelty="None" type="Obs"/><text>An element u∈H∖H× is an atom (or irreducible) if u=bc with b,c∈H implies b∈H× or c∈H×.</text></s>
<s sid="123"><CoreSc1 advantage="None" conceptID="Mod35" novelty="None" type="Mod"/><text>By A(H) we denote the set of all atoms of H, and call H atomic if every a∈H∖H× can be written as a (finite) product of atoms.</text></s>
<s sid="124"><CoreSc1 advantage="None" conceptID="Mod36" novelty="None" type="Mod"/><text>A left ideal of H is a subset I⊂H with HI⊂I, and a right ideal of H is defined similarly.</text></s>
<s sid="125"><CoreSc1 advantage="None" conceptID="Obs4" novelty="None" type="Obs"/><text>A principal left (right) ideal of H is a set of the form Ha (aH) for some a∈H.</text></s>
<s sid="126"><CoreSc1 advantage="None" conceptID="Obs5" novelty="None" type="Obs"/><text>If H is a commutative monoid, then p∈H∖H× is a prime element if p|ab implies p|a or p|b for all a,b∈H.</text></s>
Proposition 3.1
<s sid="127"><CoreSc1 advantage="None" conceptID="Obs6" novelty="None" type="Obs"/><text>If H satisfies the ACC on principal left and right ideals, then H is atomic.</text></s>
Proof
<s sid="128"><CoreSc1 advantage="None" conceptID="Obs7" novelty="None" type="Obs"/><text>We first note that if a,b∈H then aH=bH if and only if a=bε with ε∈H×, and similarly Ha=Hb if and only if a=εb with ε∈H×.</text></s>
<s sid="129"><CoreSc1 advantage="None" conceptID="Res29" novelty="None" type="Res"/><text>[We only show the statement for the right ideals.</text></s>
<s sid="130"><CoreSc1 advantage="None" conceptID="Res30" novelty="None" type="Res"/><text>The non-trivial direction is showing that aH=bH implies a=bε.</text></s>
<s sid="131"><CoreSc1 advantage="None" conceptID="Res31" novelty="None" type="Res"/><text>Since aH=bH implies a=bx and b=ay with x,y∈H, we get a=a(yx) and b=b(xy).</text></s>
<s sid="132"><CoreSc1 advantage="None" conceptID="Res32" novelty="None" type="Res"/><text>Since H is cancellative, this implies xy=t(b)=s(x) and yx=t(a)=s(y), hence y=x-1 and therefore x,y∈H×.] Claim A</text></s>
<s sid="133"><CoreSc1 advantage="None" conceptID="Res33" novelty="None" type="Res"/><text>If a∈H∖H×, then there exist u∈A(H) and a0∈H such that a=ua0.</text></s>
Proof of Claim A
Assume the contrary.
<s sid="134"><CoreSc1 advantage="None" conceptID="Res34" novelty="None" type="Res"/><text>Then the setΩ={a′H|a′∈H∖H× such that there are no u∈A(H),a0∈H with a′=ua0} is non-empty, and hence, using the ascending chain condition on the principal right ideals, possesses a maximal element aH with a∈H∖H×.</text></s>
<s sid="135"><CoreSc1 advantage="None" conceptID="Res35" novelty="None" type="Res"/><text>Then a∉A(H), and therefore a=bc with b,c∈H∖H×.</text></s>
<s sid="136"><CoreSc1 advantage="None" conceptID="Res36" novelty="None" type="Res"/><text>But aH⊊bH since c∉H×, and thus maximality of aH in Ω implies b=ub0 with u∈A(H) and b0∈H.</text></s>
<s sid="137"><CoreSc1 advantage="None" conceptID="Res37" novelty="None" type="Res"/><text>But then a=u(b0c), a contradiction. □</text></s>
<s sid="138"><CoreSc1 advantage="None" conceptID="Res38" novelty="None" type="Res"/><text>We proceed to show that every a∈H∖H× is a product of atoms.</text></s>
<s sid="139"><CoreSc1 advantage="None" conceptID="Res39" novelty="None" type="Res"/><text>Again, assume that this is not the case.</text></s>
<s sid="140"><CoreSc1 advantage="None" conceptID="Res40" novelty="None" type="Res"/><text>ThenΩ′={Ha′|a′∈H∖H× such that a′ is not a product of atoms} is non-empty, and hence possesses a maximal element Ha with a∈H∖H× (this time using the ascending chain condition on principal left ideals).</text></s>
<s sid="141"><CoreSc1 advantage="None" conceptID="Hyp2" novelty="None" type="Hyp"/><text>Again a∉A(H) as otherwise it would be a product of atoms.</text></s>
<s sid="142"><CoreSc1 advantage="None" conceptID="Mod37" novelty="None" type="Mod"/><text>By Claim A, a=ua0 with u∈A(H) and a0∈H.</text></s>
Since a∉A(H), a0∉H×.
<s sid="143"><CoreSc1 advantage="None" conceptID="Mod38" novelty="None" type="Mod"/><text>Moreover, Ha⊊Ha0 since u∉H× and therefore a0=u1⋅⋯⋅ul with l∈N and u1,…,ul∈A(H).</text></s>
<s sid="144"><CoreSc1 advantage="None" conceptID="Mod39" novelty="None" type="Mod"/><text>Thus a=uu1⋅⋯⋅ul is a product of atoms, a contradiction. □</text></s>
<s sid="145"><CoreSc1 advantage="None" conceptID="Mod40" novelty="None" type="Mod"/><text>The following definition provides a natural notion of an ordered factorization (called a rigid factorization) in a cancellative small category.</text></s>
<s sid="146"><CoreSc1 advantage="None" conceptID="Mod41" novelty="None" type="Mod"/><text>It is modeled after a terminology by Cohn [14,15].</text></s>
<s sid="147"><CoreSc1 advantage="None" conceptID="Mod42" novelty="None" type="Mod"/><text>Let F(A(H)) denote the path category on atoms of H.</text></s>
<s sid="148"><CoreSc1 advantage="None" conceptID="Mod43" novelty="None" type="Mod"/><text>We defineH××rF(A(H))={(ε,y)∈H××F(A(H))|t(ε)=s(y)}, and define an associative partial operation on H××rF(A(H)) as follows: If (ε,y),(ε′,y′)∈H××rF(A(H)) with ε,ε′∈H×,y=(e,u1,u2,…,uk,f)∈F(A(H))andy′=(e′,v1,v2,…,vl,f′)∈F(A(H)), then the operation is defined if t(y)=s(ε′), and(ε,y)⋅(ε′,y′)=(ε,(e,u1,…,ukε′,v1,v2,…,vl,f′))if k&gt;0, while (ε,y)⋅(ε′,y′)=(εε′,y′) if k=0.</text></s>
<s sid="149"><CoreSc1 advantage="None" conceptID="Mod44" novelty="None" type="Mod"/><text>In this way H××rF(A(H)) is again a cancellative small category (with identities {(e,(e,e))|e∈H0} that we identify with H0 again, s(ε,y)=s(ε) and t(ε,y)=t(y)).</text></s>
<s sid="150"><CoreSc1 advantage="None" conceptID="Mod45" novelty="None" type="Mod"/><text>We define a congruence relation ∼ on it as follows: If (ε,y),(ε′,y′)∈H××rF(A(H)) with y, y′ as before, then (ε,y)∼(ε′,y′) if k=l, εu1⋅⋯⋅uk=ε′v1⋅⋯⋅vl∈H and either k=0 or there exist δ2,…,δk∈H× and δk+1=t(uk) such thatε′v1=εu1δ2-1andvi=δiuiδi+1-1for all i∈[2,k].</text></s>
Definition 3.2
<s sid="151"><CoreSc1 advantage="None" conceptID="Mod46" novelty="None" type="Mod"/><text>The category of rigid factorizations of H is defined asZ⁎(H)=(H××rF(A(H)))/∼.</text></s>
<s sid="152"><CoreSc1 advantage="None" conceptID="Mod47" novelty="None" type="Mod"/><text>For z∈Z⁎(H) with z=[(ε,(e,u1,u2,…,uk,f))]∼ we write z=εu1⁎⋯⁎uk and the operation on Z⁎(H) is also denoted by ⁎.</text></s>
<s sid="153"><CoreSc1 advantage="None" conceptID="Obj34" novelty="None" type="Obj"/><text>The length of z is |z|=k.</text></s>
<s sid="154"><CoreSc1 advantage="None" conceptID="Obj35" novelty="None" type="Obj"/><text>There is a surjective homomorphism π:Z⁎(H)→H, induced by multiplying out the elements of the factorization in H, explicitly π(z)=εu1u2⋅⋯⋅uk∈H.</text></s>
<s sid="155"><CoreSc1 advantage="None" conceptID="Mod48" novelty="None" type="Mod"/><text>For a∈H, we define Z⁎(a)=ZH⁎(a)=π-1({a}) to be the set of rigid factorization of a.</text></s>
<s sid="156"><CoreSc1 advantage="None" conceptID="Mod49" novelty="None" type="Mod"/><text>To simplify the notation, we make the following conventions:•</text></s>
<s sid="157"><CoreSc1 advantage="None" conceptID="Mod50" novelty="None" type="Mod"/><text>If, for a rigid factorization z=εu1⁎⋯⁎uk∈Z⁎(H), we have k&gt;0 (i.e., π(z)∉H×), then the unit ε can be absorbed into the first factor u1 (replacing it by εu1), and we can essentially just work in F(A(H))/∼, with ∼ defined to match the equivalence relation on H××rF(A(H)).</text></s>
•
<s sid="158"><CoreSc1 advantage="None" conceptID="Met6" novelty="None" type="Met"/><text>If H is reduced but |H0|&gt;1, we often still write s(u1)u1⁎⋯⁎uk instead of the shorter u1⁎⋯⁎uk, as k=0 is allowed and in the path category there is a different empty path for every e∈H0.</text></s>
Remark 3.3
1.
<s sid="159"><CoreSc1 advantage="None" conceptID="Met7" novelty="None" type="Met"/><text>If H is reduced, then Z⁎(H)=F(A(H)).</text></s>
<s sid="160"><CoreSc1 advantage="None" conceptID="Met8" novelty="None" type="Met"/><text>If H is not reduced, the H× factor allows us to represent trivial factorizations of units, and the equivalence relation ∼ allows us to deal with trivial insertion of units.</text></s>
<s sid="161"><CoreSc1 advantage="None" conceptID="Met9" novelty="None" type="Met"/><text>In the commutative setting these technicalities can easily be avoided by identifying associated elements and passing to the reduced monoid Hred={aH×|a∈H}.</text></s>
<s sid="162"><CoreSc1 advantage="None" conceptID="Mod51" novelty="None" type="Mod"/><text>Unfortunately, associativity (left, right or two-sided) is in general no congruence relation in the non-commutative case.</text></s>
2.
<s sid="163"><CoreSc1 advantage="None" conceptID="Mod52" novelty="None" type="Mod"/><text>If H is a commutative monoid, then Z⁎(H)≅H××F(A(Hred)), where F(A(Hred)) is the free monoid on A(Hred), while a factorization in this setting is usually defined as an element of the free abelian monoid Z(H)=Fab(A(Hred)), implying in particular that factorizations are unordered while rigid factorizations are ordered.</text></s>
<s sid="164"><CoreSc1 advantage="None" conceptID="Mod53" novelty="None" type="Mod"/><text>The homomorphism π:Z⁎(Hred)→Hred obviously factors through the multiplication homomorphism Z(Hred)→Hred, and the fibers consist of the different permutations of a factorization.</text></s>
<s sid="165"><CoreSc1 advantage="None" conceptID="Mod54" novelty="None" type="Mod"/><text>In the following we will only be concerned with invariants related to the lengths of factorizations, which may as well be defined using rigid factorizations.</text></s>
Definition 3.4
Let a∈H.1.
<s sid="166"><CoreSc1 advantage="None" conceptID="Mod55" novelty="None" type="Mod"/><text>We callL(a)=LH(a)={|z|∈N0|z∈Z⁎(a)} the set of lengths of a.</text></s>
2.
<s sid="167"><CoreSc1 advantage="None" conceptID="Mod56" novelty="None" type="Mod"/><text>The system of sets of lengths of H is defined as L(H)={L(a)⊂N0|a∈H}.</text></s>
3.
<s sid="168"><CoreSc1 advantage="None" conceptID="Mod57" novelty="None" type="Mod"/><text>A positive integer d∈N is a distance of a if there exists an l∈L(a) such that {l,l+d}∈L(a) and L(a)∩[l+1,l+d-1]=∅.</text></s>
<s sid="169"><CoreSc1 advantage="None" conceptID="Mod58" novelty="None" type="Mod"/><text>The set of distances of a is the set consisting of all such distances and is denoted by Δ(a)=ΔH(a).</text></s>
<s sid="170"><CoreSc1 advantage="None" conceptID="Mod59" novelty="None" type="Mod"/><text>The set of distances of H is defined asΔ(H)=⋃a∈HΔ(a).</text></s>
4.
<s sid="171"><CoreSc1 advantage="None" conceptID="Mod60" novelty="None" type="Mod"/><text>We define Uk(H)=⋃L∈L(H),k∈LL for k∈N0.</text></s>
5.
<s sid="172"><CoreSc1 advantage="None" conceptID="Mod61" novelty="None" type="Mod"/><text>H is half-factorial if |L(a)|=1 for all a∈H (equivalently, H is atomic and Δ(H)=∅).</text></s>
<s sid="173"><CoreSc1 advantage="None" conceptID="Mod62" novelty="None" type="Mod"/><text>We write b|Hra if a∈Hb and similarly b|Hla if a∈bH.</text></s>
Definition &amp; Lemma 3.5
<s sid="174"><CoreSc1 advantage="None" conceptID="Mod63" novelty="None" type="Mod"/><text>Let H⊂D be subcategories of a groupoid.</text></s>
The following are equivalent:(a)
<s sid="175"><CoreSc1 advantage="None" conceptID="Mod64" novelty="None" type="Mod"/><text>For all a,b∈H, b|Dra implies b|Hra.</text></s>
(b)
HH-1∩D=H.
<s sid="176"><CoreSc1 advantage="None" conceptID="Mod65" novelty="None" type="Mod"/><text>H⊂D is called right-saturated if these equivalent conditions are fulfilled.</text></s>
Proof
<s sid="177"><CoreSc1 advantage="None" conceptID="Mod66" novelty="None" type="Mod"/><text>(a) ⇒ (b): Let c=ab-1 with a,b∈H, t(a)=t(b) and c∈D.</text></s>
<s sid="178"><CoreSc1 advantage="None" conceptID="Mod67" novelty="None" type="Mod"/><text>Then cb=a, i.e., b|Dra and hence also b|Hra.</text></s>
<s sid="179"><CoreSc1 advantage="None" conceptID="Mod68" novelty="None" type="Mod"/><text>Since the left factor is uniquely determined as c=ab-1, it follows that c∈H.</text></s>
<s sid="180"><CoreSc1 advantage="None" conceptID="Bac9" novelty="None" type="Bac"/><text>(b) ⇒ (a): Let b|Dra.</text></s>
<s sid="181"><CoreSc1 advantage="None" conceptID="Bac10" novelty="None" type="Bac"/><text>There exists c∈D with cb=a, and thus c=ab-1.</text></s>
<s sid="182"><CoreSc1 advantage="None" conceptID="Bac11" novelty="None" type="Bac"/><text>Therefore c∈HH-1∩D=H, hence b|Hra. □</text></s>
Definition 3.6
<s sid="183"><CoreSc1 advantage="None" conceptID="Bac12" novelty="None" type="Bac"/><text>Let B be a reduced cancellative small category.</text></s>
<s sid="184"><CoreSc1 advantage="None" conceptID="Bac13" novelty="None" type="Bac"/><text>A homomorphism θ:H→B is called a transfer homomorphism if it has the following properties:(T1)</text></s>
B=θ(H) and θ-1(B0)=H×.
(T2)
<s sid="185"><CoreSc1 advantage="None" conceptID="Bac14" novelty="None" type="Bac"/><text>If a∈H, b1,b2∈B and θ(a)=b1b2, then there exist a1,a2∈H such that a=a1a2, θ(a1)=b1 and θ(a2)=b2.</text></s>
<s sid="186"><CoreSc1 advantage="None" conceptID="Bac15" novelty="None" type="Bac"/><text>The notion of a transfer homomorphism plays a central role in studying sets of lengths.</text></s>
<s sid="187"><CoreSc1 advantage="None" conceptID="Bac16" novelty="None" type="Bac"/><text>It is easily checked that the following still holds in our generalized setting (cf.</text></s>
<s sid="188"><CoreSc1 advantage="None" conceptID="Obs8" novelty="None" type="Obs"/><text>[27, §3.2] for the commutative case, [25, Proposition 6.4] for the non-commutative monoid case).</text></s>
Proposition 3.7
<s sid="189"><CoreSc1 advantage="None" conceptID="Res41" novelty="None" type="Res"/><text>If θ:H→B is a transfer homomorphism, then LH(a)=LB(θ(a)) for all a∈H and hence all invariants defined in terms of lengths coincide for H and B.</text></s>
In particular,•
L(H)=L(B),
•
Uk(H)=Uk(B) for all k∈N0,
•
<s sid="190"><CoreSc1 advantage="None" conceptID="Obj36" novelty="None" type="Obj"/><text>ΔH(a)=ΔB(θ(a)) for all a∈H, and Δ(H)=Δ(B).</text></s>
Proposition 3.8
<s sid="191"><CoreSc1 advantage="None" conceptID="Obj37" novelty="None" type="Obj"/><text>Let H be a cancellative small category, G a finite abelian group and θ:H→B(G) a transfer homomorphism.</text></s>
<s sid="192"><CoreSc1 advantage="None" conceptID="Obj38" novelty="None" type="Obj"/><text>Then H is half-factorial if and only if |G|⩽2.</text></s>
<s sid="193"><CoreSc1 advantage="None" conceptID="Obj39" novelty="None" type="Obj"/><text>If |G|⩾3, then we have1.</text></s>
<s sid="194"><CoreSc1 advantage="None" conceptID="Obj40" novelty="None" type="Obj"/><text>Δ(H) is a finite interval, and if it is non-empty, then minΔ(H)=1,</text></s>
2.
<s sid="195"><CoreSc1 advantage="None" conceptID="Res42" novelty="None" type="Res"/><text>for every k⩾2, the set Uk(H) is a finite interval,</text></s>
3.
<s sid="196"><CoreSc1 advantage="None" conceptID="Res43" novelty="None" type="Res"/><text>there exists an M∈N0 such that for every a∈H the set of lengths L(a) is an almost arithmetical multiprogression (AAMP) with difference d∈Δ(H) and bound M.</text></s>
Proof
<s sid="197"><CoreSc1 advantage="None" conceptID="Res44" novelty="None" type="Res"/><text>By the previous lemma it is sufficient to show these statements for the monoid of zero-sum sequences B(G) over a finite abelian group G.</text></s>
<s sid="198"><CoreSc1 advantage="None" conceptID="Res45" novelty="None" type="Res"/><text>B(G) is half-factorial if and only if |G|⩽2 by [27, Proposition 2.5.6].</text></s>
<s sid="199"><CoreSc1 advantage="None" conceptID="Res46" novelty="None" type="Res"/><text>The first statement is proven in [29], the second can be found in [24, Theorem 3.1.3].</text></s>
<s sid="200"><CoreSc1 advantage="None" conceptID="Res47" novelty="None" type="Res"/><text>For the definition of AAMPs and a proof of 3 see [27, Chapter 4]. □</text></s>
<s sid="201"><CoreSc1 advantage="None" conceptID="Res48" novelty="None" type="Res"/><text>The description in 3 is sharp by a realization theorem of W.A.</text></s>
Schmid [49].
<s sid="202"><CoreSc1 advantage="None" conceptID="Obj41" novelty="None" type="Obj"/><text>Factorization of integral elements in arithmetical groupoids</text></s>
<s sid="203"><CoreSc1 advantage="None" conceptID="Obj42" novelty="None" type="Obj"/><text>In this section we introduce arithmetical groupoids and study the factorization behavior of integral elements.</text></s>
<s sid="204"><CoreSc1 advantage="None" conceptID="Res49" novelty="None" type="Res"/><text>In Section 5 we will see that the divisorial fractional one-sided ideals of suitable semigroups form such groupoids.</text></s>
<s sid="205"><CoreSc1 advantage="None" conceptID="Res50" novelty="None" type="Res"/><text>Thus in non-commutative semigroups arithmetical groupoids generalize the free abelian group of divisorial fractional two-sided ideals familiar from the commutative setting (see Proposition 4.6 and Remark 4.16).</text></s>
<s sid="206"><CoreSc1 advantage="None" conceptID="Obj43" novelty="None" type="Obj"/><text>This abstract approach to factorizations was first used by Asano and Murata in [5].</text></s>
<s sid="207"><CoreSc1 advantage="None" conceptID="Obj44" novelty="None" type="Obj"/><text>We follow their ideas and also those of Rehm in [45,46], who studies factorizations of ideals in rings in a different abstract framework.</text></s>
<s sid="208"><CoreSc1 advantage="None" conceptID="Obj45" novelty="None" type="Obj"/><text>The notation and terminology for lattices follows [30], a reference for l-groups is [51].</text></s>
<s sid="209"><CoreSc1 advantage="None" conceptID="Obj46" novelty="None" type="Obj"/><text>Proposition 4.12 is the main result on factorizations of integral elements in a lattice-ordered groupoid (due to Asano and Murata).</text></s>
<s sid="210"><CoreSc1 advantage="None" conceptID="Obj47" novelty="None" type="Obj"/><text>We introduce an abstract norm homomorphism η, and as the main result in this section, we present a transfer homomorphism to a monoid of zero-sum sequences in Theorem 4.15.</text></s>
Definition 4.1
<s sid="211"><CoreSc1 advantage="None" conceptID="Obj48" novelty="None" type="Obj"/><text>A lattice-ordered groupoid (G,⩽) is a groupoid G together with a relation ⩽ on G such that for all e,f∈G01.</text></s>
<s sid="212"><CoreSc1 advantage="None" conceptID="Obj49" novelty="None" type="Obj"/><text>(G(e,⋅),⩽|G(e,⋅)) is a lattice (we write ∧e′ and ∨e′ for the meet and join),</text></s>
2.
<s sid="213"><CoreSc1 advantage="None" conceptID="Obj50" novelty="None" type="Obj"/><text>(G(⋅,f),⩽|G(⋅,f)) is a lattice (we write ∧f″ and ∨f″ for the meet and join),</text></s>
3.
<s sid="214"><CoreSc1 advantage="None" conceptID="Res51" novelty="None" type="Res"/><text>(G(e,f),⩽|G(e,f)) is a sublattice of both G(e,⋅) and G(⋅,f).</text></s>
<s sid="215"><CoreSc1 advantage="None" conceptID="Res52" novelty="None" type="Res"/><text>Explicitly: For all a,b∈G(e,f) it holds that a∧e′b=a∧f″b∈G(e,f) and a∨e′b=a∨f″b∈G(e,f).</text></s>
<s sid="216"><CoreSc1 advantage="None" conceptID="Obj51" novelty="None" type="Obj"/><text>If a,b∈G and s(a)=s(b) we write a∧b=a∧s(a)′b and a∨b=a∨s(a)′b.</text></s>
<s sid="217"><CoreSc1 advantage="None" conceptID="Obj52" novelty="None" type="Obj"/><text>If t(a)=t(b) we write a∧b=a∧t(a)″b and a∨b=a∨t(a)″b.</text></s>
<s sid="218"><CoreSc1 advantage="None" conceptID="Obj53" novelty="None" type="Obj"/><text>By 3 this is unambiguous if s(a)=s(b) and t(a)=t(b) both hold.</text></s>
<s sid="219"><CoreSc1 advantage="None" conceptID="Obj54" novelty="None" type="Obj"/><text>The restriction of ⩽ to any of G(e,⋅), G(⋅,f) or G(e,f) will in the following simply be denoted by ⩽ again.</text></s>
<s sid="220"><CoreSc1 advantage="None" conceptID="Obj55" novelty="None" type="Obj"/><text>(Keep in mind however that ⩽ need not be a partial order on the entire set G, and ∧ and ∨ do not represent meet and join operations on the entire set G in the order-theoretic sense.)</text></s>
<s sid="221"><CoreSc1 advantage="None" conceptID="Obj56" novelty="None" type="Obj"/><text>An element a of a lattice-ordered groupoid is called integral if a⩽s(a) and a⩽t(a), and we write G+ for the subset of all integral elements of G.</text></s>
Definition 4.2
<s sid="222"><CoreSc1 advantage="None" conceptID="Obj57" novelty="None" type="Obj"/><text>A lattice-ordered groupoid G is called an arithmetical groupoid if it has the following properties for all e,f∈G0:(P1)</text></s>
<s sid="223"><CoreSc1 advantage="None" conceptID="Obs9" novelty="None" type="Obs"/><text>For a∈G, a⩽s(a) if and only if a⩽t(a).</text></s>
(P2)
<s sid="224"><CoreSc1 advantage="None" conceptID="Obs10" novelty="None" type="Obs"/><text>G(e,⋅) and G(⋅,f) are modular lattices.</text></s>
(P3)
<s sid="225"><CoreSc1 advantage="None" conceptID="Obs11" novelty="None" type="Obs"/><text>If a⩽b for a,b∈G(e,⋅) and c∈G(⋅,e), then ca⩽cb.</text></s>
<s sid="226"><CoreSc1 advantage="None" conceptID="Obs12" novelty="None" type="Obs"/><text>Analogously, if a,b∈G(⋅,f) and c∈G(f,⋅), then ac⩽bc.</text></s>
(P4)
<s sid="227"><CoreSc1 advantage="None" conceptID="Obs13" novelty="None" type="Obs"/><text>For every non-empty subset M⊂G(e,⋅)∩G+, sup(M)∈G(e,⋅) exists, and similarly for M⊂G(⋅,f)∩G+.</text></s>
<s sid="228"><CoreSc1 advantage="None" conceptID="Obs14" novelty="None" type="Obs"/><text>If moreover M⊂G(e,f) then supG(e,⋅)(M)=supG(⋅,f)(M).</text></s>
(P5)
<s sid="229"><CoreSc1 advantage="None" conceptID="Obs15" novelty="None" type="Obs"/><text>G(e,f) contains an integral element.</text></s>
(P6)
<s sid="230"><CoreSc1 advantage="None" conceptID="Obs16" novelty="None" type="Obs"/><text>G(e,⋅) and G(⋅,f) satisfy the ACC on integral elements.</text></s>
<s sid="231"><CoreSc1 advantage="None" conceptID="Obj58" novelty="None" type="Obj"/><text>For the remainder of this section, let G be an arithmetical groupoid.</text></s>
<s sid="232"><CoreSc1 advantage="None" conceptID="Obj59" novelty="None" type="Obj"/><text>P5 implies in particular G(e,f)≠∅ for all e,f∈G0, i.e., G is connected.</text></s>
<s sid="233"><CoreSc1 advantage="None" conceptID="Res53" novelty="None" type="Res"/><text>If e,e′∈G0 and c∈G(e′,e), then G(e,⋅)→G(e′,⋅), x↦cx is an order isomorphism by P3, and similarly every d∈G(f,f′) induces an order isomorphism from G(⋅,f) to G(⋅,f′).</text></s>
<s sid="234"><CoreSc1 advantage="None" conceptID="Res54" novelty="None" type="Res"/><text>P2 could therefore equivalently be required for a single e and a single f∈G0.</text></s>
<s sid="235"><CoreSc1 advantage="None" conceptID="Res55" novelty="None" type="Res"/><text>Moreover, since the map (G(e,⋅),⩽)→(G(⋅,e),⩾), x↦x-1 is also an order isomorphism (Lemma 4.3.1) and the property of being modular is self-dual, it is in fact sufficient that one of G(e,⋅) and G(⋅,e) is modular for one e∈G0.</text></s>
<s sid="236"><CoreSc1 advantage="None" conceptID="Res56" novelty="None" type="Res"/><text>Using P5 we also observe that it is sufficient to have the ACC on integral elements on one G(e,⋅) and one G(⋅,f): If, say, a1⩽a2⩽a3⩽⋯ is an ascending chain of integral elements in G(e′,⋅) and c∈G(e,e′) is integral, then ca1⩽ca2⩽ca3⩽⋯ is an ascending chain of integral elements in G(e,⋅) (Lemma 4.3.2), hence becomes stationary, and multiplying by c-1 from the left again shows that the original chain also becomes stationary.</text></s>
<s sid="237"><CoreSc1 advantage="None" conceptID="Res57" novelty="None" type="Res"/><text>We summarize some basic properties that follow immediately from the definitions.</text></s>
Lemma 4.3
Let e,f∈G0.1.
<s sid="238"><CoreSc1 advantage="None" conceptID="Obs17" novelty="None" type="Obs"/><text>a⩽x⇔a-1⩾x-1 holds if either a,x∈G(e,⋅) or a,x∈G(⋅,f).</text></s>
<s sid="239"><CoreSc1 advantage="None" conceptID="Obs18" novelty="None" type="Obs"/><text>In particular, for a∈G the following are equivalent: (a) a⩽s(a); (b) a⩽t(a); (c) a-1⩾s(a); (d) a-1⩾t(a).</text></s>
2.
Let a∈G(e,f).
<s sid="240"><CoreSc1 advantage="None" conceptID="Obs19" novelty="None" type="Obs"/><text>If x∈G(⋅,e) and y∈G(f,⋅) are integral, then xa⩽a and ay⩽a.</text></s>
3.
<s sid="241"><CoreSc1 advantage="None" conceptID="Obs20" novelty="None" type="Obs"/><text>If a∈G(e,f), x∈G(⋅,e) and y∈G(f,⋅), then(i)</text></s>
<s sid="242"><CoreSc1 advantage="None" conceptID="Obs21" novelty="None" type="Obs"/><text>x(a∨b)=xa∨xb and x(a∧b)=xa∧xb if b∈G(e,⋅),</text></s>
(ii)
<s sid="243"><CoreSc1 advantage="None" conceptID="Obs22" novelty="None" type="Obs"/><text>(a∨b)y=ay∨by and (a∧b)y=ay∧by if b∈G(⋅,f).</text></s>
4.
Let ∅≠M⊂G(e,⋅) and x∈G(⋅,e).
<s sid="244"><CoreSc1 advantage="None" conceptID="Res58" novelty="None" type="Res"/><text>If supG(e,⋅)(M) exists, then also supG(s(x),⋅)(xM) exists, and sup(xM)=xsup(M).</text></s>
<s sid="245"><CoreSc1 advantage="None" conceptID="Res59" novelty="None" type="Res"/><text>Moreover, then also infG(⋅,e)(M-1) exists and inf(M-1)=sup(M)-1.</text></s>
<s sid="246"><CoreSc1 advantage="None" conceptID="Res60" novelty="None" type="Res"/><text>Analogous statements hold for ∅≠M⊂G(⋅,f) and x∈G(f,⋅).</text></s>
5.
<s sid="247"><CoreSc1 advantage="None" conceptID="Res61" novelty="None" type="Res"/><text>G(e,⋅), G(⋅,f), G(e,f) and in particular G(e) are conditionally complete as lattices.</text></s>
6.
<s sid="248"><CoreSc1 advantage="None" conceptID="Res62" novelty="None" type="Res"/><text>The set G+ of all integral elements forms a reduced wide subcategory of G, and G=q(G+) is the groupoid of (left and right) fractions of this subcategory.</text></s>
7.
<s sid="249"><CoreSc1 advantage="None" conceptID="Res63" novelty="None" type="Res"/><text>For every a∈G(e,f), there exist b∈G(e) and c∈G(f) with b⩽a and c⩽a.</text></s>
Proof
1. Assume first s(x)=s(a).
<s sid="250"><CoreSc1 advantage="None" conceptID="Obs23" novelty="None" type="Obs"/><text>By P3, a⩽x if and only if x-1a⩽t(x).</text></s>
<s sid="251"><CoreSc1 advantage="None" conceptID="Res64" novelty="None" type="Res"/><text>By P1 this is equivalent to x-1a⩽t(a).</text></s>
<s sid="252"><CoreSc1 advantage="None" conceptID="Res65" novelty="None" type="Res"/><text>Again by P3 this is equivalent to x-1⩽a-1.</text></s>
<s sid="253"><CoreSc1 advantage="None" conceptID="Obs24" novelty="None" type="Obs"/><text>The case t(x)=t(a) is proven similarly.</text></s>
<s sid="254"><CoreSc1 advantage="None" conceptID="Obs25" novelty="None" type="Obs"/><text>(a) ⇔ (b) and (c) ⇔ (d) by P1.</text></s>
<s sid="255"><CoreSc1 advantage="None" conceptID="Obs26" novelty="None" type="Obs"/><text>For (a) ⇔ (c) set x=s(a).</text></s>
<s sid="256"><CoreSc1 advantage="None" conceptID="Res66" novelty="None" type="Res"/><text>2. Since x⩽t(x)=s(a), we have xa⩽s(a)a=a by P3.</text></s>
Similarly, by⩽y.
<s sid="257"><CoreSc1 advantage="None" conceptID="Res67" novelty="None" type="Res"/><text>3. We show (i), (ii) is similar.</text></s>
<s sid="258"><CoreSc1 advantage="None" conceptID="Res68" novelty="None" type="Res"/><text>Since a⩽a∨b and b⩽a∨b, P3 implies xa⩽x(a∨b) and xb⩽x(a∨b), thus xa∨xb⩽x(a∨b).</text></s>
<s sid="259"><CoreSc1 advantage="None" conceptID="Res69" novelty="None" type="Res"/><text>Thereforea∨b=(x-1xa)∨(x-1xb)⩽x-1(xa∨xb), and multiplying by x from the left gives x(a∨b)⩽xa∨xb.</text></s>
Dually, x(a∧b)=xa∧xb.
4. Let c=sup(M).
<s sid="260"><CoreSc1 advantage="None" conceptID="Res70" novelty="None" type="Res"/><text>Then for all m∈M, xm⩽xc, hence xc is an upper bound for xM.</text></s>
<s sid="261"><CoreSc1 advantage="None" conceptID="Res71" novelty="None" type="Res"/><text>If d∈G(s(x),⋅) is another upper bound for xM, then m⩽x-1d for all m∈M, hence c⩽x-1d and thus xc⩽d.</text></s>
Therefore xc=sup(xM).
<s sid="262"><CoreSc1 advantage="None" conceptID="Res72" novelty="None" type="Res"/><text>For d∈G(e,⋅) we have m⩽d for all m∈M if and only if m-1⩾d-1 (in G(⋅,e)), and inf(M-1)=sup(M)-1 follows.</text></s>
<s sid="263"><CoreSc1 advantage="None" conceptID="Res73" novelty="None" type="Res"/><text>5. We show the claim for G(e,⋅), for G(⋅,f) the proof is similar.</text></s>
<s sid="264"><CoreSc1 advantage="None" conceptID="Res74" novelty="None" type="Res"/><text>Let ∅≠M⊂G(e,⋅) be bounded, say x⩽m⩽y for some x,y∈G(e,⋅) and all m∈M.</text></s>
<s sid="265"><CoreSc1 advantage="None" conceptID="Res75" novelty="None" type="Res"/><text>Then y-1M⊂G(t(y),⋅) is integral, hence sup(y-1M) exists by P4, and sup(M)=ysup(y-1M) by 4.</text></s>
<s sid="266"><CoreSc1 advantage="None" conceptID="Res76" novelty="None" type="Res"/><text>Similarly, M-1x⊂G(⋅,t(x)) is integral, and therefore sup(M-1x) exists, implying inf(M)=sup(M-1)-1=xsup(M-1x)-1.</text></s>
<s sid="267"><CoreSc1 advantage="None" conceptID="Res77" novelty="None" type="Res"/><text>The proof for G(e,f) is similar but uses in addition supG(t(y),⋅)(y-1M)=supG(⋅,f)(y-1M) (from P4), to ensure that the supremum lies in G(e,f) again.</text></s>
<s sid="268"><CoreSc1 advantage="None" conceptID="Res78" novelty="None" type="Res"/><text>6. By 2 and the fact that every e∈G0 is integral by definition, G+ forms a wide subcategory of G.</text></s>
<s sid="269"><CoreSc1 advantage="None" conceptID="Res79" novelty="None" type="Res"/><text>If a∈G+∖G0, then a&lt;s(a), thus a-1&gt;s(a) and therefore a-1 is not integral.</text></s>
<s sid="270"><CoreSc1 advantage="None" conceptID="Res80" novelty="None" type="Res"/><text>Hence the subcategory of integral elements is reduced.</text></s>
Let x∈G and e=s(x).
<s sid="271"><CoreSc1 advantage="None" conceptID="Res81" novelty="None" type="Res"/><text>Then a=x∧e⩽e, hence a is integral.</text></s>
<s sid="272"><CoreSc1 advantage="None" conceptID="Res82" novelty="None" type="Res"/><text>Since a⩽x, also x-1a⩽t(x) is integral.</text></s>
Set b=x-1a.
Then x=ab-1 with a,b∈G+.
<s sid="273"><CoreSc1 advantage="None" conceptID="Res83" novelty="None" type="Res"/><text>Similarly one can find c,d∈G+ with x=d-1c.</text></s>
<s sid="274"><CoreSc1 advantage="None" conceptID="Res84" novelty="None" type="Res"/><text>7. By P5 there exist integral b′∈G(f,e) and c′∈G(e,f).</text></s>
Set b=ab′ and c=c′a.
<s sid="275"><CoreSc1 advantage="None" conceptID="Res85" novelty="None" type="Res"/><text>Then b⩽a, c⩽a and b∈G(e), c∈G(f). □</text></s>
<s sid="276"><CoreSc1 advantage="None" conceptID="Res86" novelty="None" type="Res"/><text>For e,f∈G it is immediate from the definitions that G+(e,⋅)=G(e,⋅)∩G+, G+(⋅,f)=G(⋅,f)∩G+ and G+(e,f)=G(e,f)∩G+.</text></s>
<s sid="277"><CoreSc1 advantage="None" conceptID="Res87" novelty="None" type="Res"/><text>Moreover, G+(e,⋅) is a sublattice of G(e,⋅), G+(⋅,f) is a sublattice of G(⋅,f), and G+(e,f) is a sublattice of G(e,f).</text></s>
<s sid="278"><CoreSc1 advantage="None" conceptID="Obs27" novelty="None" type="Obs"/><text>If a,b∈G+(e,⋅), then a⩽b if and only if b|G+la as a=b(b-1a), and b-1a is integral if and only if a⩽b.</text></s>
<s sid="279"><CoreSc1 advantage="None" conceptID="Obs28" novelty="None" type="Obs"/><text>Similarly, if a,b∈G+(⋅,f), then a⩽b if and only if b|G+ra.</text></s>
<s sid="280"><CoreSc1 advantage="None" conceptID="Mod69" novelty="None" type="Mod"/><text>Correspondingly, for integral elements with the same left (right) identity, we may view the join and meet operations as left (right) gcd and lcm.</text></s>
Definition &amp; Lemma 4.4
<s sid="281"><CoreSc1 advantage="None" conceptID="Mod70" novelty="None" type="Mod"/><text>For u∈G the following are equivalent:(a)</text></s>
<s sid="282"><CoreSc1 advantage="None" conceptID="Mod71" novelty="None" type="Mod"/><text>u is maximal in G+(s(u),⋅)∖{s(u)},</text></s>
(b)
<s sid="283"><CoreSc1 advantage="None" conceptID="Mod72" novelty="None" type="Mod"/><text>u is maximal in G+(⋅,t(u))∖{t(u)},</text></s>
(c)
u∈A(G+).
<s sid="284"><CoreSc1 advantage="None" conceptID="Mod73" novelty="None" type="Mod"/><text>An element u∈G satisfying these equivalent conditions is called maximal integral.</text></s>
Proof
<s sid="285"><CoreSc1 advantage="None" conceptID="Mod74" novelty="None" type="Mod"/><text>(a) ⇒ (b): By definition, u is maximal in G(s(u),⋅) with u&lt;s(u).</text></s>
<s sid="286"><CoreSc1 advantage="None" conceptID="Mod75" novelty="None" type="Mod"/><text>If u⩽y&lt;t(u) with y∈G(⋅,t(u)), then uy-1⩽yy-1=s(y), hence uy-1∈G(s(u),⋅) is integral, and therefore u&lt;uy-1⩽s(u).</text></s>
<s sid="287"><CoreSc1 advantage="None" conceptID="Obs29" novelty="None" type="Obs"/><text>By maximality of u in the first set, therefore uy-1=s(u), whence y=u and u is maximal in the second set.</text></s>
<s sid="288"><CoreSc1 advantage="None" conceptID="Obs30" novelty="None" type="Obs"/><text>(b) ⇒ (c): Assume u=vw with v,w∈G+∖G0.</text></s>
<s sid="289"><CoreSc1 advantage="None" conceptID="Obs31" novelty="None" type="Obs"/><text>Then u&lt;w&lt;t(u), contradicting the maximality of u in G+(⋅,t(u)).</text></s>
<s sid="290"><CoreSc1 advantage="None" conceptID="Obs32" novelty="None" type="Obs"/><text>(c) ⇒ (a): Let v∈G+(s(u),⋅) with u⩽v&lt;s(u).</text></s>
<s sid="291"><CoreSc1 advantage="None" conceptID="Obs33" novelty="None" type="Obs"/><text>Then u=v(v-1u) with v and v-1u integral, and since v∉G0 necessarily v-1u∈G0, i.e., u=v. □</text></s>
Lemma 4.5
<s sid="292"><CoreSc1 advantage="None" conceptID="Obs34" novelty="None" type="Obs"/><text>Let U be an l-group.</text></s>
<s sid="293"><CoreSc1 advantage="None" conceptID="Obs35" novelty="None" type="Obs"/><text>For p∈U the following are equivalent:(a)</text></s>
p is maximal integral,
(b)
<s sid="294"><CoreSc1 advantage="None" conceptID="Obs36" novelty="None" type="Obs"/><text>p is a prime element in U+,</text></s>
(c)
p∈A(U+).
Proof
<s sid="295"><CoreSc1 advantage="None" conceptID="Obs37" novelty="None" type="Obs"/><text>(a) ⇔ (c) is shown as in Definition &amp; Lemma 4.4.</text></s>
<s sid="296"><CoreSc1 advantage="None" conceptID="Obs38" novelty="None" type="Obs"/><text>It suffices to show (a) ⇒ (b) and (b) ⇒ (c).</text></s>
<s sid="297"><CoreSc1 advantage="None" conceptID="Obs39" novelty="None" type="Obs"/><text>Let e be the identity of U.</text></s>
<s sid="298"><CoreSc1 advantage="None" conceptID="Obs40" novelty="None" type="Obs"/><text>(a) ⇒ (b): Let p be maximal in U+ with p≠e.</text></s>
Assume p|ab for a,b⩽e.
That means ab⩽p.
Assume a⩽̸p.
Then b=(a∨p)b=ab∨pb⩽p∨pb=p, i.e., p|b.
<s sid="299"><CoreSc1 advantage="None" conceptID="Obs41" novelty="None" type="Obs"/><text>(b) ⇒ (c): Let p be a prime, p=ab with a,b⩽e.</text></s>
Say p|a, i.e., a⩽p.
<s sid="300"><CoreSc1 advantage="None" conceptID="Res88" novelty="None" type="Res"/><text>Then a⩽p⩽a implies p=a and therefore b=e. □</text></s>
Proposition 4.6
1.
<s sid="301"><CoreSc1 advantage="None" conceptID="Mod76" novelty="None" type="Mod"/><text>If G is a group (i.e., |G0|=1), then G is the free abelian group with basis A(G+), and G+ is the free abelian monoid with basis A(G+).</text></s>
Moreover gcd(a,b)=a∨b and lcm(a,b)=a∧b.
2.
<s sid="302"><CoreSc1 advantage="None" conceptID="Mod77" novelty="None" type="Mod"/><text>Let M be a set, F the free abelian group with basis M, and H⊂F the free abelian monoid with the same basis.</text></s>
<s sid="303"><CoreSc1 advantage="None" conceptID="Mod78" novelty="None" type="Mod"/><text>A lattice order is defined on F by a⩽b if a=cb with c∈H, and (F,⩽) is an arithmetical groupoid with F+=H and M=A(F+).</text></s>
3.
<s sid="304"><CoreSc1 advantage="None" conceptID="Mod79" novelty="None" type="Mod"/><text>For every e∈G0, the group isomorphism je:G(e)→G induces the structure of an arithmetical groupoid on G, and the induced structure on G is independent of the choice of e.</text></s>
<s sid="305"><CoreSc1 advantage="None" conceptID="Mod80" novelty="None" type="Mod"/><text>G (G(e)) is a free abelian group and G+ (G(e)+) is a free abelian monoid with basis A(G+) (A(G(e)+)).</text></s>
Moreover, je(G(e)+)=G+ and je(A(G(e)+))=A(G+).
Proof
<s sid="306"><CoreSc1 advantage="None" conceptID="Mod81" novelty="None" type="Mod"/><text>1. G is an l-group, and by Lemma 4.3.5 it is conditionally complete.</text></s>
<s sid="307"><CoreSc1 advantage="None" conceptID="Mod82" novelty="None" type="Mod"/><text>Therefore G is commutative [51, Theorems 2.3.1(d) and 2.3.9].</text></s>
<s sid="308"><CoreSc1 advantage="None" conceptID="Mod83" novelty="None" type="Mod"/><text>Since it satisfies the ACC on integral elements, G+ is atomic (Proposition 3.1).</text></s>
<s sid="309"><CoreSc1 advantage="None" conceptID="Mod84" novelty="None" type="Mod"/><text>By the previous lemma, every atom of G+ is a prime element, and therefore G+ is factorial.</text></s>
<s sid="310"><CoreSc1 advantage="None" conceptID="Mod85" novelty="None" type="Mod"/><text>Because it is also reduced, G+ is the free abelian monoid with basis A(G+).</text></s>
<s sid="311"><CoreSc1 advantage="None" conceptID="Mod86" novelty="None" type="Mod"/><text>Now G=q(G+) implies that G is the free abelian group with basis A(G+).</text></s>
<s sid="312"><CoreSc1 advantage="None" conceptID="Obs42" novelty="None" type="Obs"/><text>Finally, gcd(a,b)=a∨b and gcd(a,b)=a∧b for a,b∈G+ follow because c⩽d if and only if d|c for all c,d∈G+.</text></s>
<s sid="313"><CoreSc1 advantage="None" conceptID="Res89" novelty="None" type="Res"/><text>2. Clearly ⩽ defines a lattice order on F, and the properties of an arithmetical groupoid are, except for P2, either trivial, or easily checked.</text></s>
<s sid="314"><CoreSc1 advantage="None" conceptID="Res90" novelty="None" type="Res"/><text>For P2 recall that every l-group is distributive, hence modular, as a lattice [51, Theorem 2.1.3(a)].</text></s>
<s sid="315"><CoreSc1 advantage="None" conceptID="Res91" novelty="None" type="Res"/><text>Now F+=H and A(F+)=M are immediate from the definitions.</text></s>
<s sid="316"><CoreSc1 advantage="None" conceptID="Res92" novelty="None" type="Res"/><text>3. For every e∈G0 the vertex group G(e) is an arithmetical groupoid, as is easily checked.</text></s>
<s sid="317"><CoreSc1 advantage="None" conceptID="Res93" novelty="None" type="Res"/><text>Via the group isomorphism je:G(e)→G therefore G gains the structure of an arithmetical groupoid.</text></s>
<s sid="318"><CoreSc1 advantage="None" conceptID="Mod87" novelty="None" type="Mod"/><text>If f∈G0 and c∈G(e,f), then for all x,y∈G(e) we have x⩽y⇔c-1xc⩽c-1yc, and since jf-1∘je(x)=c-1xc, the induced order on G is independent of the choice of e.</text></s>
<s sid="319"><CoreSc1 advantage="None" conceptID="Mod88" novelty="None" type="Mod"/><text>By 1, applied to G, respectively G(e), the remaining claims follow (for je(A(G+))=A(G(e)+) use the characterization of atoms as maximal integral elements from Lemma 4.5). □</text></s>
<s sid="320"><CoreSc1 advantage="None" conceptID="Mod89" novelty="None" type="Mod"/><text>Let [a,b], [c,d] be intervals in a lattice.</text></s>
<s sid="321"><CoreSc1 advantage="None" conceptID="Mod90" novelty="None" type="Mod"/><text>Recall that [a,b] is down-perspective to [c,d] if c=a∧d and b=a∨d.</text></s>
<s sid="322"><CoreSc1 advantage="None" conceptID="Mod91" novelty="None" type="Mod"/><text>Moreover, [a,b] is perspective to [c,d] if either [a,b] is down-perspective to [c,d], or [c,d] is down-perspective to [a,b].</text></s>
<s sid="323"><CoreSc1 advantage="None" conceptID="Mod92" novelty="None" type="Mod"/><text>The intervals [a,b], [c,d] are projective if there exists a finite sequence of intervals [a,b]=[a0,b0],[a1,b1],…,[ak,bk]=[c,d] such that [ai-1,bi-1] is perspective to [ai,bi] for all i∈[1,k].</text></s>
(See [30, Chapter I.3.5].)
Definition 4.7
1.
<s sid="324"><CoreSc1 advantage="None" conceptID="Mod93" novelty="None" type="Mod"/><text>An element a∈G+(e,f) is transposable to an element b∈G+(e′,f′) if there exists an element c∈G+(e,e′) such that [a,e] is down-perspective to [cb,c].</text></s>
Explicitly: b=c-1(c∧a) and c∨a=e.
2.
<s sid="325"><CoreSc1 advantage="None" conceptID="Res94" novelty="None" type="Res"/><text>An element a∈G+ is projective to an element b∈G+ if there exists a sequence of integral elements a=c0,c1,…,cn,cn+1=b, such that for any pair of successive elements (ci,ci+1) either ci is transposable to ci+1 or ci+1 is transposable to ci.</text></s>
<s sid="326"><CoreSc1 advantage="None" conceptID="Res95" novelty="None" type="Res"/><text>It is easily checked that being transposable is a transitive and reflexive relation (but not symmetric), and projectivity is an equivalence relation.</text></s>
<s sid="327"><CoreSc1 advantage="None" conceptID="Obs43" novelty="None" type="Obs"/><text>Note that in a modular lattice perspective intervals are isomorphic [30, p.</text></s>
<s sid="328"><CoreSc1 advantage="None" conceptID="Obs44" novelty="None" type="Obs"/><text>308, Theorem 348], and therefore in particular the lengths of [a,s(a)] and [b,s(b)] coincide if a is projective to b.</text></s>
Lemma 4.8
<s sid="329"><CoreSc1 advantage="None" conceptID="Obs45" novelty="None" type="Obs"/><text>If a, b, c are as in the definition of transposability, then cb=c∧a=ad for some d∈G+ and c is transposable to d.</text></s>
Proof
<s sid="330"><CoreSc1 advantage="None" conceptID="Res96" novelty="None" type="Res"/><text>Since c∧a⩽a, there exists an integral d with ad=c∧a, and cb=c∧a by definition of transposability.</text></s>
<s sid="331"><CoreSc1 advantage="None" conceptID="Res97" novelty="None" type="Res"/><text>The claim follows from d=a-1(c∧a) and c∨a=e. □</text></s>
Lemma 4.9
<s sid="332"><CoreSc1 advantage="None" conceptID="Met10" novelty="None" type="Met"/><text>If two lattice intervals [a,b] and [c,d] of G(e,⋅) are projective, then the integral elements b-1a and d-1c are projective to each other in the sense of the previous definition.</text></s>
Proof
<s sid="333"><CoreSc1 advantage="None" conceptID="Mod94" novelty="None" type="Mod"/><text>It suffices to show that if the lattice interval [a,b] is down-perspective to [c,d], then b-1a is transposable to d-1c.</text></s>
<s sid="334"><CoreSc1 advantage="None" conceptID="Mod95" novelty="None" type="Mod"/><text>Then a=bx, d=by and c=dz=byz with x,y,z∈G+.</text></s>
<s sid="335"><CoreSc1 advantage="None" conceptID="Mod96" novelty="None" type="Mod"/><text>Since [a,b] is down-perspective to [c,d], we getb=a∨d=bx∨by=b(x∨y)and thereforex∨y=s(x)=t(b),andc=a∧d=bx∧by=b(x∧y)and thereforex∧y=b-1c=yz.</text></s>
<s sid="336"><CoreSc1 advantage="None" conceptID="Mod97" novelty="None" type="Mod"/><text>Thus d-1c=z=y-1(x∧y) with y∈G(t(b),t(d)), and hence x=b-1a is transposable to d-1c. □</text></s>
Definition &amp; Lemma 4.10
<s sid="337"><CoreSc1 advantage="None" conceptID="Mod98" novelty="None" type="Mod"/><text>For every a∈G,{X∈G|Xs(a)⩽a}={X∈G|Xt(a)⩽a}, and we write G⩽a for this set.</text></s>
<s sid="338"><CoreSc1 advantage="None" conceptID="Mod99" novelty="None" type="Mod"/><text>The lower bound Φ:G→G is defined by Φ(a)=sup(G⩽a).</text></s>
Proof
Let X∈G.
<s sid="339"><CoreSc1 advantage="None" conceptID="Res98" novelty="None" type="Res"/><text>Recall from Section 2.2 that Xs(a)=js(a)-1(X) denotes the unique representative of X in G(s(a)), and that Xt(a)=a-1Xs(a)a.</text></s>
<s sid="340"><CoreSc1 advantage="None" conceptID="Res99" novelty="None" type="Res"/><text>We have to show that Xs(a)⩽a if and only if Xt(a)⩽a, but this follows from Xs(a)⩽a⇔a-1Xs(a)a⩽a-1aa=a. □</text></s>
<s sid="341"><CoreSc1 advantage="None" conceptID="Res100" novelty="None" type="Res"/><text>With the definition of Φ and the notation of Section 2.2 we have: If a∈G(e,f), then Φ(a)e=sup{x∈G(e)|x⩽a}∈G(e), Φ(a)f=sup{x∈G(f)|x⩽a}∈G(f), Φ(a)f=a-1Φ(a)ea=b-1Φ(a)eb for all b∈G(e,f) and Φ(a)=je(Φ(a)e)=jf(Φ(a)f).</text></s>
Lemma 4.11
Let e,f∈G0.1.
<s sid="342"><CoreSc1 advantage="None" conceptID="Obs46" novelty="None" type="Obs"/><text>If a,b∈G(e,⋅) or a,b∈G(⋅,f) with a⩽b, then Φ(a)⩽Φ(b).</text></s>
<s sid="343"><CoreSc1 advantage="None" conceptID="Obs47" novelty="None" type="Obs"/><text>In particular, if a∈G+, then Φ(a)∈G+.</text></s>
2.
<s sid="344"><CoreSc1 advantage="None" conceptID="Obs48" novelty="None" type="Obs"/><text>If a∈G(e,f), b∈G(f,⋅) then Φ(a)Φ(b)⩽Φ(ab).</text></s>
<s sid="345"><CoreSc1 advantage="None" conceptID="Obs49" novelty="None" type="Obs"/><text>If moreover a,b∈G+, then Φ(ab)⩽Φ(a)∧Φ(b), and if furthermore Φ(a) and Φ(b) are coprime, then Φ(ab)=Φ(a)Φ(b).</text></s>
3.
<s sid="346"><CoreSc1 advantage="None" conceptID="Obs50" novelty="None" type="Obs"/><text>If u∈A(G+), then Φ(u)∈G+ is prime.</text></s>
4.
<s sid="347"><CoreSc1 advantage="None" conceptID="Obs51" novelty="None" type="Obs"/><text>Let u,v∈G+ be projective elements.</text></s>
<s sid="348"><CoreSc1 advantage="None" conceptID="Obs52" novelty="None" type="Obs"/><text>If u∈A(G+), then v∈A(G+), and Φ(u)=Φ(v).</text></s>
Proof
<s sid="349"><CoreSc1 advantage="None" conceptID="Obs53" novelty="None" type="Obs"/><text>1. Immediate from the definition of Φ.</text></s>
<s sid="350"><CoreSc1 advantage="None" conceptID="Obs54" novelty="None" type="Obs"/><text>2. Observe that c=a-1Φ(a)e∈G(f,e) is integral.</text></s>
ThereforeΦ(a)eΦ(b)e=acΦ(b)e=acc-1Φ(b)fc=aΦ(b)fc⩽aΦ(b)f⩽ab, and hence Φ(a)Φ(b)⩽Φ(ab).
<s sid="351"><CoreSc1 advantage="None" conceptID="Res101" novelty="None" type="Res"/><text>Let now a, b be integral.</text></s>
<s sid="352"><CoreSc1 advantage="None" conceptID="Res102" novelty="None" type="Res"/><text>Then 1 implies Φ(ab)⩽Φ(a) and Φ(ab)⩽Φ(b), so Φ(ab)⩽Φ(a)∧Φ(b).</text></s>
<s sid="353"><CoreSc1 advantage="None" conceptID="Res103" novelty="None" type="Res"/><text>The last statement follows because Φ(a)∧Φ(b)=lcm(Φ(a),Φ(b)) in G+.</text></s>
<s sid="354"><CoreSc1 advantage="None" conceptID="Res104" novelty="None" type="Res"/><text>3. By Lemma 4.5 it suffices to show Φ(u)∈A(G+).</text></s>
<s sid="355"><CoreSc1 advantage="None" conceptID="Res105" novelty="None" type="Res"/><text>If e=s(u), then it suffices to prove Φ(u)e∈A(G(e)+) (by Proposition 4.6.3).</text></s>
<s sid="356"><CoreSc1 advantage="None" conceptID="Res106" novelty="None" type="Res"/><text>Assume that Φ(u)e=ab with a,b∈G(e) such that a&lt;e and b&lt;e.</text></s>
<s sid="357"><CoreSc1 advantage="None" conceptID="Res107" novelty="None" type="Res"/><text>Then b∨u=e, since b&gt;ab=Φ(u)e, and thereforeu⩾ab∨au=a(b∨u)=a, a contradiction to a&gt;ab=Φ(u)e.</text></s>
<s sid="358"><CoreSc1 advantage="None" conceptID="Res108" novelty="None" type="Res"/><text>4. We first show that v is maximal integral, and may assume that either u is transposable to v or v is transposable to u.</text></s>
Let e=s(u) and f=s(v).
<s sid="359"><CoreSc1 advantage="None" conceptID="Res109" novelty="None" type="Res"/><text>Assume first that u is transposable to v via c∈G+(e,f).</text></s>
<s sid="360"><CoreSc1 advantage="None" conceptID="Res110" novelty="None" type="Res"/><text>Then [u,e] is down-perspective to [cv,c], and since G(e,⋅) is modular, the intervals are isomorphic, hence have the same length (namely 1).</text></s>
<s sid="361"><CoreSc1 advantage="None" conceptID="Res111" novelty="None" type="Res"/><text>Multiplying from the left by c-1 therefore also [v,f] has length 1, and thus v is maximal integral.</text></s>
<s sid="362"><CoreSc1 advantage="None" conceptID="Obs55" novelty="None" type="Obs"/><text>If v is transposable to u, one argues along similar lines.</text></s>
<s sid="363"><CoreSc1 advantage="None" conceptID="Hyp3" novelty="None" type="Hyp"/><text>For the remainder of the claim we may now assume that u is transposable to v (since we already know that v is also maximal integral).</text></s>
<s sid="364"><CoreSc1 advantage="None" conceptID="Res112" novelty="None" type="Res"/><text>Let again c∈G+(e,f) be such that cv=c∧u and e=c∨u.</text></s>
If p=Φ(u)e, then c-1pc=Φ(u)f.
<s sid="365"><CoreSc1 advantage="None" conceptID="Res113" novelty="None" type="Res"/><text>Since pc⩽c∧p⩽c∧u=cv, we get c-1pc⩽v and therefore Φ(v)⩾Φ(c-1pc)=Φ(Φ(u)f)=Φ(u).</text></s>
<s sid="366"><CoreSc1 advantage="None" conceptID="Res114" novelty="None" type="Res"/><text>By 3, Φ(u) is prime and thus maximal integral in G+, which implies Φ(u)=Φ(v). □</text></s>
<s sid="367"><CoreSc1 advantage="None" conceptID="Res115" novelty="None" type="Res"/><text>The converse of Lemma 4.11.3 is false in general: A non-maximal integral element can have a prime lower bound.</text></s>
Proposition 4.12
1.
<s sid="368"><CoreSc1 advantage="None" conceptID="Res116" novelty="None" type="Res"/><text>The category G+ is half-factorial.</text></s>
<s sid="369"><CoreSc1 advantage="None" conceptID="Res117" novelty="None" type="Res"/><text>Explicitly: Every a∈G+ possesses a rigid factorizations(a)u1⁎⋯⁎uk∈Z⁎(a) with k∈N0 and u1,…,uk∈A(G+) and the number of factors, k∈N0, is uniquely determined by a.</text></s>
<s sid="370"><CoreSc1 advantage="None" conceptID="Res118" novelty="None" type="Res"/><text>Moreover, if s(a)v1⁎⋯⁎vk∈Z⁎(a) is another rigid factorization with v1,…,vk∈A(G+), then there exists a permutation τ∈Sk such that uτ(i) is projective to vi for all i∈[1,k].</text></s>
<s sid="371"><CoreSc1 advantage="None" conceptID="Res119" novelty="None" type="Res"/><text>In particular, Φ(uτ(i))=Φ(vi) for all i∈[1,k].</text></s>
2.
<s sid="372"><CoreSc1 advantage="None" conceptID="Res120" novelty="None" type="Res"/><text>Any two rigid factorizations of a∈G+ can be transformed into each other by a number of steps, each of which only involves replacing two successive elements by two new ones.</text></s>
3.
<s sid="373"><CoreSc1 advantage="None" conceptID="Res121" novelty="None" type="Res"/><text>(Transposition.) If a=uv with u,v∈A(G+) and Φ(u)=P, Φ(v)=Q, Q≠P, then there exist uniquely determined v′,u′∈A(G+) such that Φ(v′)=Q, Φ(u′)=P and uv=v′u′.</text></s>
<s sid="374"><CoreSc1 advantage="None" conceptID="Res122" novelty="None" type="Res"/><text>Explicitly,u′=a∨Pt(a),u′∧v=a,u′∨v=t(a),v′=a∨Qs(a),u∧v′=a,u∨v′=s(a). So u is transposable to u′ and v′ is transposable to v.</text></s>
4.
<s sid="375"><CoreSc1 advantage="None" conceptID="Res123" novelty="None" type="Res"/><text>Given any permutation τ′∈Sk, there exist w1,…,wk∈A(G+), such thats(a)w1⁎⋯⁎wk∈Z⁎(a) and Φ(wi)=Φ(uτ′(i)) for all i∈[1,k].</text></s>
Proof
1, 2.
<s sid="376"><CoreSc1 advantage="None" conceptID="Res124" novelty="None" type="Res"/><text>We observe that rigid factorizations of a correspond bijectively to maximal chains of the sublattice [a,s(a)] of G(s(a),⋅): If s(a)u1⁎⋯⁎uk∈Z⁎(a), then s(a)&gt;u1&gt;u1u2&gt;⋯&gt;u1⋅⋯⋅uk=a is a chain in [a,s(a)] and since u1,…,uk are maximal integral, it is in fact a maximal chain of [a,s(a)].</text></s>
<s sid="377"><CoreSc1 advantage="None" conceptID="Mod100" novelty="None" type="Mod"/><text>Conversely, if s(a)=x0&gt;x1&gt;x2&gt;⋯&gt;xk=a is a maximal chain of [a,s(a)] then we set ui=xi-1-1xi for all i∈[1,k].</text></s>
<s sid="378"><CoreSc1 advantage="None" conceptID="Mod101" novelty="None" type="Mod"/><text>These elements are maximal integral, i.e., atoms of G+, and a=xk=s(a)x1(x1-1x2)⋅⋯⋅(xk-2-1xk-1)(xk-1-1xk)=s(a)u1⋅⋯⋅uk.</text></s>
<s sid="379"><CoreSc1 advantage="None" conceptID="Mod102" novelty="None" type="Mod"/><text>By P6, [a,s(a)] satisfies the ACC, but also the DCC because if s(a)=x0⩾x1⩾⋯⩾a is a descending chain in [a,s(a)], then x0-1a⩽x1-1a⩽⋯⩽a-1a=t(a) is an ascending chain in G+(⋅,t(a)) and therefore becomes stationary again by P6.</text></s>
<s sid="380"><CoreSc1 advantage="None" conceptID="Mod103" novelty="None" type="Mod"/><text>Being a modular lattice, [a,s(a)] is therefore of finite length.</text></s>
<s sid="381"><CoreSc1 advantage="None" conceptID="Mod104" novelty="None" type="Mod"/><text>The claims now follow from the Jordan-Hölder Theorem for modular lattices (see e.g., [30, p.</text></s>
333, Theorem 377]).
<s sid="382"><CoreSc1 advantage="None" conceptID="Mod105" novelty="None" type="Mod"/><text>The existence of maximal chains implies that G+ is atomic (alternatively, use Proposition 3.1 together with the ACC on integral elements).</text></s>
<s sid="383"><CoreSc1 advantage="None" conceptID="Mod106" novelty="None" type="Mod"/><text>For half-factoriality, and projectivity of the factors, assume that s(a)=x0&gt;x1&gt;x2&gt;⋯&gt;xk=a and s(a)=y0&gt;y1&gt;y2&gt;⋯&gt;yl=a are two maximal chains from which rigid factorizations with factors ui=xi-1-1xi for i∈[1,k] and vi=yi-1-1yi for i∈[1,l] are derived.</text></s>
<s sid="384"><CoreSc1 advantage="None" conceptID="Res125" novelty="None" type="Res"/><text>Then the uniqueness part of the Jordan-Hölder Theorem implies k=l and that there exists a permutation τ∈Sk such that [xτ(i),xτ(i)-1] is projective to [yi,yi-1] for all i∈[1,k].</text></s>
<s sid="385"><CoreSc1 advantage="None" conceptID="Res126" novelty="None" type="Res"/><text>By Lemma 4.9, this implies that uτ(i) is projective to vi for all i∈[1,k].</text></s>
<s sid="386"><CoreSc1 advantage="None" conceptID="Res127" novelty="None" type="Res"/><text>Finally, 2 follows in a similar manner by induction on the length of a.</text></s>
<s sid="387"><CoreSc1 advantage="None" conceptID="Res128" novelty="None" type="Res"/><text>Fix a composition series of [u1∧v1,a].</text></s>
<s sid="388"><CoreSc1 advantage="None" conceptID="Res129" novelty="None" type="Res"/><text>This gives rise to refinements of s(a)&gt;u1&gt;u1∧v1&gt;a and s(a)&gt;v1&gt;u1∧v1&gt;a to composition series of [a,s(a)].</text></s>
<s sid="389"><CoreSc1 advantage="None" conceptID="Res130" novelty="None" type="Res"/><text>Applying the induction hypothesis to u2⁎⋯⁎uk (respectively v2⁎⋯⁎vk), and the rigid factorization derived from the refined chain t(u1)&gt;u1-1(u1∧v1)&gt;⋯&gt;u1-1a (respectively t(v1)&gt;v1-1(u1∧v1)&gt;⋯&gt;v1-1a) one proves the claim.</text></s>
<s sid="390"><CoreSc1 advantage="None" conceptID="Res131" novelty="None" type="Res"/><text>3. Let e=s(u), q=Qe and set v′=uv∨q.</text></s>
<s sid="391"><CoreSc1 advantage="None" conceptID="Res132" novelty="None" type="Res"/><text>We first show: Claim A</text></s>
q⩽̸u.
Claim B
v′∧u=uv.
Claim C
v′ is maximal integral.
Proof of Claim A
Suppose q⩽u.
<s sid="392"><CoreSc1 advantage="None" conceptID="Res133" novelty="None" type="Res"/><text>Then Q⩽Φ(u)=P, a contradiction to P and Q being distinct prime elements of G+ (Lemma 4.11.3). □</text></s>
Proof of Claim B
<s sid="393"><CoreSc1 advantage="None" conceptID="Res134" novelty="None" type="Res"/><text>Since G(e,⋅) is modular and uv⩽u,v′∧u=(uv∨q)∧u=uv∨(q∧u).</text></s>
<s sid="394"><CoreSc1 advantage="None" conceptID="Res135" novelty="None" type="Res"/><text>Because q⩽̸u (Claim A), we have q&gt;q∧u⩾qu and thus, by maximality of u, qu=q∧u. Thereforeuv∨(q∧u)=uv∨qu=uv∨uQt(u)=u(v∨Qt(u))=uv.□</text></s>
Proof of Claim C
<s sid="395"><CoreSc1 advantage="None" conceptID="Res136" novelty="None" type="Res"/><text>Since uv is a product of two atoms and G+ is half-factorial, it suffices to show uv&lt;v′&lt;e.</text></s>
Suppose first uv=v′.
<s sid="396"><CoreSc1 advantage="None" conceptID="Res137" novelty="None" type="Res"/><text>Then q⩽uv⩽u, contradicting Claim A.</text></s>
Assume now v′=e.
<s sid="397"><CoreSc1 advantage="None" conceptID="Res138" novelty="None" type="Res"/><text>Then u=e∧u=v′∧u, and by Claim B therefore u=uv, contradicting v&lt;s(v). □</text></s>
<s sid="398"><CoreSc1 advantage="None" conceptID="Res139" novelty="None" type="Res"/><text>Existence. We have uv=v′u′ with v′∈A(G+) (by Claim C) and u′=v′-1uv∈G+.</text></s>
<s sid="399"><CoreSc1 advantage="None" conceptID="Res140" novelty="None" type="Res"/><text>Since G+ is half-factorial, this necessarily implies u′∈A(G+).</text></s>
<s sid="400"><CoreSc1 advantage="None" conceptID="Res141" novelty="None" type="Res"/><text>By definition of v′, Q⩽Φ(v′)&lt;1G, where the latter inequality is strict because v′&lt;e.</text></s>
<s sid="401"><CoreSc1 advantage="None" conceptID="Res142" novelty="None" type="Res"/><text>Thus Φ(v′)=Q and 1 implies Φ(u′)=P.</text></s>
<s sid="402"><CoreSc1 advantage="None" conceptID="Res143" novelty="None" type="Res"/><text>Uniqueness. If v″u″=uv with Φ(v″)=Q, then v″&lt;e and v″⩾uv∨q=v′.</text></s>
<s sid="403"><CoreSc1 advantage="None" conceptID="Res144" novelty="None" type="Res"/><text>By Claim C, v′ is maximal integral and thus v″=v′, and then also u″=u′.</text></s>
Explicit formulas.
<s sid="404"><CoreSc1 advantage="None" conceptID="Res145" novelty="None" type="Res"/><text>Since e⩾u∨v′⩾Φ(u)e∨Φ(v′)e=Pe∨Qe=(P∨Q)e=(1G)e=e, it follows that u∨v′=e.</text></s>
By Claim B, u∧v′=uv=a.
<s sid="405"><CoreSc1 advantage="None" conceptID="Res146" novelty="None" type="Res"/><text>The equalities u′=a∨Pt(a), u′∧v=a and u′∨v=t(a) are shown similarly.</text></s>
<s sid="406"><CoreSc1 advantage="None" conceptID="Res147" novelty="None" type="Res"/><text>4. Write τ′ as a product of transpositions and use 3. □</text></s>
<s sid="407"><CoreSc1 advantage="None" conceptID="Res148" novelty="None" type="Res"/><text>Proposition 4.12.3 gives an explicit and complete description of the possible relations between two maximal integral elements with coprime lower bound.</text></s>
<s sid="408"><CoreSc1 advantage="None" conceptID="Res149" novelty="None" type="Res"/><text>The case where the lower bounds coincide is more complicated (there can be no relations, or many), but in the case where we will need it, it is quite simple (see Section 7.2).</text></s>
Corollary 4.13
<s sid="409"><CoreSc1 advantage="None" conceptID="Res150" novelty="None" type="Res"/><text>If H⊂G+ is a subcategory, then LH(a) is finite and non-empty for all a∈H.</text></s>
<s sid="410"><CoreSc1 advantage="None" conceptID="Res151" novelty="None" type="Res"/><text>If for every prime P∈G+ and all (equivalently, one) e∈G0 the set {u∈A(G+)|Φ(u)=P and s(u)=e} is finite, then ZH⁎(a) is finite for all a∈H.</text></s>
Proof
<s sid="411"><CoreSc1 advantage="None" conceptID="Res152" novelty="None" type="Res"/><text>Using that G+ is reduced, it follows from P6 that H satisfies the ACC on principal left and right ideals, and hence ZH⁎(a)≠∅.</text></s>
<s sid="412"><CoreSc1 advantage="None" conceptID="Res153" novelty="None" type="Res"/><text>If s(a)u1⁎⋯⁎uk∈ZH⁎(a) with k∈N0 and u1,…,uk∈A(H), then in particular ui&lt;s(ui) for all i∈[1,k], and therefore k is bounded by the length of the factorization of a in G+.</text></s>
<s sid="413"><CoreSc1 advantage="None" conceptID="Obs56" novelty="None" type="Obs"/><text>A similar argument shows the second claim. □</text></s>
<s sid="414"><CoreSc1 advantage="None" conceptID="Obs57" novelty="None" type="Obs"/><text>The properties that all sets of lengths, respectively that all sets of factorizations, are finite have been studied a lot in the commutative setting.</text></s>
<s sid="415"><CoreSc1 advantage="None" conceptID="Obs58" novelty="None" type="Obs"/><text>Note, if H is a commutative monoid and a∈H, then ZH(a) is finite if and only if ZH⁎(a) is finite.</text></s>
Definition &amp; Lemma 4.14
<s sid="416"><CoreSc1 advantage="None" conceptID="Res154" novelty="None" type="Res"/><text>There exists a unique groupoid epimorphism η:G→G such that η(u)=Φ(u) for all u∈A(G+).</text></s>
<s sid="417"><CoreSc1 advantage="None" conceptID="Res155" novelty="None" type="Res"/><text>We call η the abstract norm of G.</text></s>
Proof
<s sid="418"><CoreSc1 advantage="None" conceptID="Res156" novelty="None" type="Res"/><text>We need to show existence and uniqueness of such a homomorphism.</text></s>
<s sid="419"><CoreSc1 advantage="None" conceptID="Res157" novelty="None" type="Res"/><text>Let a∈G+, and let s(a)u1⁎⋯⁎uk∈Z⁎(a) with u1,…,uk∈A(G+).</text></s>
<s sid="420"><CoreSc1 advantage="None" conceptID="Res158" novelty="None" type="Res"/><text>Since the sequence of Φ(u1),…,Φ(uk) is, up to order, uniquely determined by a (Proposition 4.12), it follows that we can define η(a)=Φ(u1)⋅⋯⋅Φ(uk), and this is a homomorphism G+→G+ with η(u)=Φ(u) for all u∈A(G+).</text></s>
<s sid="421"><CoreSc1 advantage="None" conceptID="Res159" novelty="None" type="Res"/><text>G is the category of (left and right) fractions of G+, and hence η extends to a unique groupoid homomorphism η:G→G.</text></s>
<s sid="422"><CoreSc1 advantage="None" conceptID="Res160" novelty="None" type="Res"/><text>To verify that η is surjective, let first P∈G be a prime element of G+, and let e∈G0.</text></s>
<s sid="423"><CoreSc1 advantage="None" conceptID="Res161" novelty="None" type="Res"/><text>Let u∈G+(e,⋅) be a maximal integral element with Pu⩽u.</text></s>
<s sid="424"><CoreSc1 advantage="None" conceptID="Res162" novelty="None" type="Res"/><text>Then Φ(u)=P, and therefore η(u)=P.</text></s>
<s sid="425"><CoreSc1 advantage="None" conceptID="Mod107" novelty="None" type="Mod"/><text>The claim follows since G is the free abelian group with basis A(G+). □</text></s>
<s sid="426"><CoreSc1 advantage="None" conceptID="Mod108" novelty="None" type="Mod"/><text>In general η≠Φ, since Φ need not be a homomorphism, but from Lemma 4.11.2 it follows that for integral a the prime factorizations of Φ(a) and η(a) have the same support and vP(η(a))⩾vP(Φ(a)) for all primes P of G+.</text></s>
Theorem 4.15
<s sid="427"><CoreSc1 advantage="None" conceptID="Mod109" novelty="None" type="Mod"/><text>Let G be an arithmetical groupoid, η:G→G the abstract norm, H a right-saturated subcategory of G+, and C=G/q(η(H)).</text></s>
<s sid="428"><CoreSc1 advantage="None" conceptID="Mod110" novelty="None" type="Mod"/><text>For G∈G set [G]=Gq(η(H))∈C, and CM={[η(u)]∈C|u∈A(G+)}.</text></s>
Assume that1.
<s sid="429"><CoreSc1 advantage="None" conceptID="Mod111" novelty="None" type="Mod"/><text>for a∈G with s(a)∈H0, a∈HH-1 if and only if η(a)∈q(η(H)),</text></s>
2.
<s sid="430"><CoreSc1 advantage="None" conceptID="Mod112" novelty="None" type="Mod"/><text>for every e∈G0 and g∈CM, there exists an element u∈A(G+) such that s(u)=e and [η(u)]=g.</text></s>
<s sid="431"><CoreSc1 advantage="None" conceptID="Mod113" novelty="None" type="Mod"/><text>Then there exists a transfer homomorphism θ:H→B(CM).</text></s>
Proof
<s sid="432"><CoreSc1 advantage="None" conceptID="Mod114" novelty="None" type="Mod"/><text>Let θ:H→B(CM) be defined as follows: For a∈H and s(a)u1⁎⋯⁎uk∈ZG+⁎(a) with u1,…,uk∈A(G+), set θ(a)=[η(u1)]⋅⋯⋅[η(uk)]∈B(CM) (in particular, identities are mapped to the empty sequence).</text></s>
<s sid="433"><CoreSc1 advantage="None" conceptID="Res163" novelty="None" type="Res"/><text>We have to show that this definition depends only on a, and not on the particular rigid factorization into maximal integral elements chosen.</text></s>
<s sid="434"><CoreSc1 advantage="None" conceptID="Res164" novelty="None" type="Res"/><text>Let s(a)v1⁎⋯⁎vk∈ZG+⁎(a) be another such rigid factorization.</text></s>
<s sid="435"><CoreSc1 advantage="None" conceptID="Res165" novelty="None" type="Res"/><text>Then there exists a permutation τ∈Sk with η(ui)=Φ(ui)=Φ(vτ(i))=η(vτ(i)) (due to Proposition 4.12.1 and by definition of η).</text></s>
Therefore [η(u1)]⋅⋯⋅[η(uk)]=[η(v1)]⋅⋯⋅[η(vk)].
<s sid="436"><CoreSc1 advantage="None" conceptID="Res166" novelty="None" type="Res"/><text>With this definition θ is a homomorphism: Obviously θ(e)=1B(CM) for all e∈H0, and if b∈H with t(a)=s(b) and s(b)w1⁎⋯⁎wl∈Z⁎(b) is a rigid factorization of b into maximal integral elements, then s(a)u1⁎⋯⁎uk⁎w1⁎⋯⁎wl is a rigid factorization of ab. Thusθ(ab)=[η(u1)]⋅⋯⋅[η(uk)][η(w1)]⋅⋯⋅[η(wl)]=θ(a)θ(b).</text></s>
<s sid="437"><CoreSc1 advantage="None" conceptID="Res167" novelty="None" type="Res"/><text>We still have to check that θ has properties T1 and T2.</text></s>
<s sid="438"><CoreSc1 advantage="None" conceptID="Res168" novelty="None" type="Res"/><text>If θ(a)=1B(CM), then a possesses an empty factorization into maximal elements, hence a∈G0∩H=H0=H×.</text></s>
<s sid="439"><CoreSc1 advantage="None" conceptID="Res169" novelty="None" type="Res"/><text>θ is surjective: θ(e)=1B(CM) for any e∈H0.</text></s>
Let k∈N and g1⋅⋯⋅gk∈B(CM).
<s sid="440"><CoreSc1 advantage="None" conceptID="Res170" novelty="None" type="Res"/><text>By definition of CM and our second assumption, there exists an element u1∈A(G+) with [η(u1)]=g1 and s(u1)∈H0.</text></s>
<s sid="441"><CoreSc1 advantage="None" conceptID="Res171" novelty="None" type="Res"/><text>Again by our second assumption, for all i∈[2,k], there exist ui∈A(G+) with s(ui)=t(ui-1) and [η(ui)]=gi.</text></s>
<s sid="442"><CoreSc1 advantage="None" conceptID="Res172" novelty="None" type="Res"/><text>With a=u1⋅⋯⋅uk∈G we get [η(a)]=[η(u1)⋅⋯⋅η(uk)]=[η(u1)]+⋯+[η(uk)]=0∈C and s(a)∈H0, and hence η(a)∈q(η(H)).</text></s>
<s sid="443"><CoreSc1 advantage="None" conceptID="Res173" novelty="None" type="Res"/><text>By our first assumption, therefore a∈HH-1, and since moreover a is integral in G and H is right-saturated in G+, we get a∈H and θ(a)=g1⋅⋯⋅gk.</text></s>
<s sid="444"><CoreSc1 advantage="None" conceptID="Res174" novelty="None" type="Res"/><text>θ satisfies T2: Let a∈H, θ(a)=ST with S,T∈B(CM) and S=g1⋅⋯⋅gk, T=gk+1⋅⋯⋅gl, where k∈N0 and l∈N⩾k.</text></s>
<s sid="445"><CoreSc1 advantage="None" conceptID="Res175" novelty="None" type="Res"/><text>By Proposition 4.12.4, we can find a rigid factorization s(a)u1⁎⋯⁎ul∈Z⁎(a) with ui∈A(G+) and [η(ui)]=gi for all i∈[1,l].</text></s>
Let b=s(a)u1⋅⋯⋅uk and c=t(b)uk+1⋅⋯⋅ul.
Then a=bc.
<s sid="446"><CoreSc1 advantage="None" conceptID="Res176" novelty="None" type="Res"/><text>Since s(b)∈H0 and [η(b)]=σ(S)=0, the first assumption implies b∈HH-1∩G+=H.</text></s>
<s sid="447"><CoreSc1 advantage="None" conceptID="Res177" novelty="None" type="Res"/><text>Then s(c)∈H0 and c∈H follows similarly.</text></s>
<s sid="448"><CoreSc1 advantage="None" conceptID="Res178" novelty="None" type="Res"/><text>Finally, θ(b)=S and θ(c)=T. □</text></s>
<s sid="449"><CoreSc1 advantage="None" conceptID="Met11" novelty="None" type="Met"/><text>The theorem remains true if H is a left-saturated subcategory of G+, and in the first condition the set HH-1 is replaced by H-1H, and the condition s(a)∈H0 is replaced by t(a)∈H0.</text></s>
<s sid="450"><CoreSc1 advantage="None" conceptID="Met12" novelty="None" type="Met"/><text>Similarly, one can replace the second condition by a symmetrical one, requiring t(u)=e instead of s(u)=e (in the proof of the surjectivity of θ one then first chooses uk, followed by uk-1 and so on).</text></s>
Remark 4.16
<s sid="451"><CoreSc1 advantage="None" conceptID="Obs59" novelty="None" type="Obs"/><text>If G is a group, then G+ is the free abelian monoid with basis A(G+) (Proposition 4.6).</text></s>
<s sid="452"><CoreSc1 advantage="None" conceptID="Res179" novelty="None" type="Res"/><text>As a saturated submonoid of this free abelian monoid, H is therefore a reduced commutative Krull monoid [27, Theorem 2.4.8].</text></s>
<s sid="453"><CoreSc1 advantage="None" conceptID="Res180" novelty="None" type="Res"/><text>Since η=idG and HH-1=η(H)η(H)-1 the first condition is trivially satisfied, and because of G0={1}, the second condition is also trivially satisfied.</text></s>
<s sid="454"><CoreSc1 advantage="None" conceptID="Res181" novelty="None" type="Res"/><text>Conversely, let H be a normalizing Krull monoid.</text></s>
<s sid="455"><CoreSc1 advantage="None" conceptID="Res182" novelty="None" type="Res"/><text>Then Hred={aH×|a∈H} is a reduced commutative Krull monoid, isomorphic to the monoid of its non-zero principal ideals [25, Corollary 4.14].</text></s>
<s sid="456"><CoreSc1 advantage="None" conceptID="Res183" novelty="None" type="Res"/><text>The latter is a submonoid of the divisorial fractional ideals of H, which form the free abelian monoid of integral elements in the free abelian group of divisorial ideals of H.</text></s>
<s sid="457"><CoreSc1 advantage="None" conceptID="Obj60" novelty="None" type="Obj"/><text>In this way we recover the well-known transfer homomorphism for Krull monoids as given for example in [27, Proposition 3.4.8] for commutative Krull monoids, and in [25, Theorem 6.5] for normalizing Krull monoids.</text></s>
<s sid="458"><CoreSc1 advantage="None" conceptID="Obj61" novelty="None" type="Obj"/><text>We continue the discussion of normalizing Krull monoids in Remarks 5.17.2 and 5.24.1, where the divisorial two-sided ideal theory appears as a special case of the divisorial one-sided ideal theory.</text></s>
<s sid="459"><CoreSc1 advantage="None" conceptID="Obj62" novelty="None" type="Obj"/><text>Divisorial ideal theory in semigroups</text></s>
<s sid="460"><CoreSc1 advantage="None" conceptID="Obj63" novelty="None" type="Obj"/><text>In this section we develop a divisorial one-sided ideal theory in semigroups.</text></s>
<s sid="461"><CoreSc1 advantage="None" conceptID="Obj64" novelty="None" type="Obj"/><text>This follows again original ideas of Asano and Murata and generalizes the corresponding theory in rings and the theory of divisorial two-sided ideals in cancellative semigroups (see [2,34,3,4,6,5,17] for classical treatments, and [42,32,33,25,36] for more modern treatments in this area).</text></s>
<s sid="462"><CoreSc1 advantage="None" conceptID="Obj65" novelty="None" type="Obj"/><text>In particular, the one-sided ideal theory of classical maximal orders over Dedekind domains is a special case of the theory presented here.</text></s>
<s sid="463"><CoreSc1 advantage="None" conceptID="Obj66" novelty="None" type="Obj"/><text>The divisorial fractional one-sided ideals with left- and right-orders maximal in a fixed equivalence class of orders form a groupoid as studied in the previous section (this was in fact the motivation for Brandt to introduce the notion of a groupoid, see [9,10]).</text></s>
<s sid="464"><CoreSc1 advantage="None" conceptID="Obj67" novelty="None" type="Obj"/><text>We connect the factorization theory of elements of a maximal order H with the one for the cancellative small category of integral principal ideals with left- and right-order conjugate to H, and apply results from the previous section to the factorization of elements in H•.</text></s>
<s sid="465"><CoreSc1 advantage="None" conceptID="Obj68" novelty="None" type="Obj"/><text>The main result in this section is Theorem 5.23.</text></s>
<s sid="466"><CoreSc1 advantage="None" conceptID="Obj69" novelty="None" type="Obj"/><text>After having derived it we discuss in detail the case of rings, and of classical maximal orders (Section 5.1 and Section 5.2).</text></s>
<s sid="467"><CoreSc1 advantage="None" conceptID="Obs60" novelty="None" type="Obs"/><text>A semigroup Q is called a quotient semigroup if every cancellative element is invertible in Q, in short Q•=Q×.</text></s>
<s sid="468"><CoreSc1 advantage="None" conceptID="Obs61" novelty="None" type="Obs"/><text>A subsemigroup H⊂Q is a right order in Q if H(H∩Q•)-1=Q, and H is a left order in Q if (H∩Q•)-1H=Q.</text></s>
<s sid="469"><CoreSc1 advantage="None" conceptID="Obs62" novelty="None" type="Obs"/><text>H is an order in Q if it is a left and a right order.</text></s>
<s sid="470"><CoreSc1 advantage="None" conceptID="Res184" novelty="None" type="Res"/><text>We summarize the connection between a subsemigroup H⊂Q being an order, and Q being a semigroup of (left and right) fractions of H.</text></s>
Lemma 5.1
<s sid="471"><CoreSc1 advantage="None" conceptID="Res185" novelty="None" type="Res"/><text>Let Q be a quotient semigroup, and H⊂Q a subsemigroup.1.</text></s>
<s sid="472"><CoreSc1 advantage="None" conceptID="Obs63" novelty="None" type="Obs"/><text>If H is an order in Q, then H•=H∩Q• and Q=q(H).</text></s>
2.
<s sid="473"><CoreSc1 advantage="None" conceptID="Obs64" novelty="None" type="Obs"/><text>If q(H)=Q, then H•=H∩Q• and H is an order in Q.</text></s>
3.
<s sid="474"><CoreSc1 advantage="None" conceptID="Obs65" novelty="None" type="Obs"/><text>If H is an order in Q, H′ is a subsemigroup of Q and there exist a,b∈Q• with aHb⊂H′, then H′ is an order in Q.</text></s>
Proof
<s sid="475"><CoreSc1 advantage="None" conceptID="Res186" novelty="None" type="Res"/><text>1. It suffices to show H•=H∩Q•, and the inclusion H∩Q•⊂H• is clear.</text></s>
<s sid="476"><CoreSc1 advantage="None" conceptID="Res187" novelty="None" type="Res"/><text>Let a∈H•, and q,q′∈Q with aq=aq′.</text></s>
<s sid="477"><CoreSc1 advantage="None" conceptID="Res188" novelty="None" type="Res"/><text>Since H is a right order in Q, there exist c,d∈H and s∈H∩Q• with q=cs-1 and q′=ds-1, where we can choose a common denominator because H∩Q• satisfies the right Ore condition in H.</text></s>
<s sid="478"><CoreSc1 advantage="None" conceptID="Res189" novelty="None" type="Res"/><text>Then ac=ad, and, because a∈H•, also c=d, showing q=q′.</text></s>
<s sid="479"><CoreSc1 advantage="None" conceptID="Res190" novelty="None" type="Res"/><text>Since H is a left order it follows in the same way that a is right-cancellative in Q•, and hence a∈H∩Q•.</text></s>
<s sid="480"><CoreSc1 advantage="None" conceptID="Res191" novelty="None" type="Res"/><text>2. It again suffices to show H•=H∩Q•, and this follows in the same way as in 1.</text></s>
<s sid="481"><CoreSc1 advantage="None" conceptID="Res192" novelty="None" type="Res"/><text>3. It suffices to show that every q∈Q has representations of the form q=cs-1=t-1d with c,d∈H′ and s,t∈H′∩Q•.</text></s>
<s sid="482"><CoreSc1 advantage="None" conceptID="Res193" novelty="None" type="Res"/><text>Since H is an order in Q, there exist c′,d′∈H and s′,t′∈H∩Q• with a-1qa=c′s′-1 and bqb-1=t′-1d′.</text></s>
<s sid="483"><CoreSc1 advantage="None" conceptID="Res194" novelty="None" type="Res"/><text>Setting c=ac′b, d=ad′b, s=as′b and t=at′b, the claim follows. □</text></s>
<s sid="484"><CoreSc1 advantage="None" conceptID="Con2" novelty="None" type="Con"/><text>For the remainder of this section, let Q be a quotient semigroup.</text></s>
<s sid="485"><CoreSc1 advantage="None" conceptID="Con3" novelty="None" type="Con"/><text>If H and H′ are orders in Q, then H is (Asano-)equivalent to H′, written H∼H′, if there exist a,b,c,d∈Q• with aHb⊂H′ and cH′d⊂H.</text></s>
<s sid="486"><CoreSc1 advantage="None" conceptID="Con4" novelty="None" type="Con"/><text>This is an equivalence relation on the set of orders in Q.</text></s>
<s sid="487"><CoreSc1 advantage="None" conceptID="Con5" novelty="None" type="Con"/><text>An order H is maximal if it is maximal within its equivalence class with respect to set inclusion.</text></s>
<s sid="488"><CoreSc1 advantage="None" conceptID="Con6" novelty="None" type="Con"/><text>A feature of the non-commutative theory is that often there is no unique maximal order in a given equivalence class, and in fact in the most important cases we study there are usually infinitely many, but only finitely many conjugacy classes of them.</text></s>
<s sid="489"><CoreSc1 advantage="None" conceptID="Con7" novelty="None" type="Con"/><text>In studying the divisorial one-sided ideal theory of a maximal order H, one has to study the ideal theory of all maximal orders in its equivalence class at the same time.</text></s>
<s sid="490"><CoreSc1 advantage="None" conceptID="Res195" novelty="None" type="Res"/><text>Let H,H′⊂Q be subsemigroups (not necessarily orders), and let X,Y⊂Q.</text></s>
<s sid="491"><CoreSc1 advantage="None" conceptID="Res196" novelty="None" type="Res"/><text>As in the previous sections XY={xy|x∈X,y∈Y}.</text></s>
<s sid="492"><CoreSc1 advantage="None" conceptID="Res197" novelty="None" type="Res"/><text>X is a left H-module if HX⊂X, and a right H′-module if XH′⊂X.</text></s>
<s sid="493"><CoreSc1 advantage="None" conceptID="Res198" novelty="None" type="Res"/><text>It is an (H,H′)-module if it is a left H- and a right H′-module, i.e., HXH′⊂X.</text></s>
We define(Y:rX)={q∈Q|Xq⊂Y}and(Y:lX)={q∈Q|qX⊂Y}.
<s sid="494"><CoreSc1 advantage="None" conceptID="Res199" novelty="None" type="Res"/><text>Every left H-module is an (H,{1})-module, and similarly every right H′-module is a ({1},H′)-module.</text></s>
<s sid="495"><CoreSc1 advantage="None" conceptID="Res200" novelty="None" type="Res"/><text>We set Ol(X)=(X:lX) and Or(X)=(X:rX).</text></s>
Lemma 5.2
<s sid="496"><CoreSc1 advantage="None" conceptID="Res201" novelty="None" type="Res"/><text>Let H, H′ be subsemigroups of Q and let X be an (H,H′)-module.1.</text></s>
<s sid="497"><CoreSc1 advantage="None" conceptID="Res202" novelty="None" type="Res"/><text>(H:rX) and (H′:lX) are (H′,H)-modules.</text></s>
2.
X⊂(H:l(H:rX)) and X⊂(H′:r(H′:lX)).
3.
<s sid="498"><CoreSc1 advantage="None" conceptID="Obs66" novelty="None" type="Obs"/><text>Ol(X) and Or(X) are subsemigroups of Q.</text></s>
4.
(Ol(X):rX)=(Or(X):lX)={q∈Q|XqX⊂X}.
5.
<s sid="499"><CoreSc1 advantage="None" conceptID="Obs67" novelty="None" type="Obs"/><text>X⊂Ol(X) if and only if X⊂Or(X) if and only if X2⊂X.</text></s>
Proof
<s sid="500"><CoreSc1 advantage="None" conceptID="Res203" novelty="None" type="Res"/><text>1. XH′(H:rX)H⊂X(H:rX)H⊂HH=H and similarly for (H′:lX).</text></s>
<s sid="501"><CoreSc1 advantage="None" conceptID="Res204" novelty="None" type="Res"/><text>2. X(H:rX)⊂H by definition of (H:rX) and thus X⊂(H:l(H:rX)).</text></s>
<s sid="502"><CoreSc1 advantage="None" conceptID="Res205" novelty="None" type="Res"/><text>The other identity is proven analogously.</text></s>
<s sid="503"><CoreSc1 advantage="None" conceptID="Res206" novelty="None" type="Res"/><text>3. Clearly 1∈Ol(X) and Ol(X)Ol(X)X⊂Ol(X)X⊂X implies Ol(X)Ol(X)⊂Ol(X).</text></s>
<s sid="504"><CoreSc1 advantage="None" conceptID="Res207" novelty="None" type="Res"/><text>The claim for Or(X) is shown similarly.</text></s>
4. We show (Ol(X):rX)={q∈Q|XqX⊂X}.
Let q∈Q.
<s sid="505"><CoreSc1 advantage="None" conceptID="Res208" novelty="None" type="Res"/><text>Then XqX⊂X is equivalent to Xq⊂Ol(X), which in turn is equivalent to q∈(Ol(X):rX).</text></s>
<s sid="506"><CoreSc1 advantage="None" conceptID="Res209" novelty="None" type="Res"/><text>5. Immediate from the definitions of Ol(X) and Or(X). □</text></s>
Definition 5.3
<s sid="507"><CoreSc1 advantage="None" conceptID="Res210" novelty="None" type="Res"/><text>For X⊂Q as in Lemma 5.2, we defineX-1=(Ol(X):rX)=(Or(X):lX)={q∈Q|XqX⊂X}andXv=(X-1)-1.</text></s>
Definition 5.4
<s sid="508"><CoreSc1 advantage="None" conceptID="Res211" novelty="None" type="Res"/><text>Let H and H′ be orders in Q.1.</text></s>
<s sid="509"><CoreSc1 advantage="None" conceptID="Res212" novelty="None" type="Res"/><text>A fractional left H-ideal is a left H-module I such that I∩Q•≠∅ and (H:rI)∩Q•≠∅.</text></s>
2.
<s sid="510"><CoreSc1 advantage="None" conceptID="Res213" novelty="None" type="Res"/><text>A fractional right H′-ideal is a right H′-module I such that I∩Q•≠∅ and (H′:lI)∩Q•≠∅.</text></s>
3.
<s sid="511"><CoreSc1 advantage="None" conceptID="Res214" novelty="None" type="Res"/><text>If I is a fractional left H-ideal and a fractional right H′-ideal, then I is a fractional (H,H′)-ideal.</text></s>
4.
<s sid="512"><CoreSc1 advantage="None" conceptID="Res215" novelty="None" type="Res"/><text>A fractional H-ideal is a fractional (H,H)-ideal.</text></s>
5.
<s sid="513"><CoreSc1 advantage="None" conceptID="Res216" novelty="None" type="Res"/><text>I is a left H-ideal if it is a fractional left H-ideal and I⊂H.</text></s>
<s sid="514"><CoreSc1 advantage="None" conceptID="Res217" novelty="None" type="Res"/><text>A right H′-ideal is defined analogously.</text></s>
6.
<s sid="515"><CoreSc1 advantage="None" conceptID="Res218" novelty="None" type="Res"/><text>If I is a left H-ideal and a right H′-ideal, then I is an (H,H′)-ideal.</text></s>
7.
<s sid="516"><CoreSc1 advantage="None" conceptID="Res219" novelty="None" type="Res"/><text>An H-ideal is an (H,H)-ideal.</text></s>
8.
<s sid="517"><CoreSc1 advantage="None" conceptID="Res220" novelty="None" type="Res"/><text>A fractional left H-ideal I is integral if I⊂Ol(I) (equivalently, I⊂Or(I)).</text></s>
<s sid="518"><CoreSc1 advantage="None" conceptID="Res221" novelty="None" type="Res"/><text>The same definition is made for fractional right H′-ideals.</text></s>
<s sid="519"><CoreSc1 advantage="None" conceptID="Res222" novelty="None" type="Res"/><text>If H is a maximal order, then the notions of a left H-ideal and that of an integral fractional left H-ideal coincide (this will follow from Lemma 5.6.1 and Lemma 5.6.2).</text></s>
<s sid="520"><CoreSc1 advantage="None" conceptID="Con8" novelty="None" type="Con"/><text>We will sometimes call a fractional left (right) H-ideal one-sided to emphasize that it need not be a fractional right (left) H-ideal, or two-sided to emphasize that it is indeed a fractional H-ideal.</text></s>
<s sid="521"><CoreSc1 advantage="None" conceptID="Obs68" novelty="None" type="Obs"/><text>We recall some properties of fractional left H-ideals and first observe the following.</text></s>
Lemma 5.5
<s sid="522"><CoreSc1 advantage="None" conceptID="Obs69" novelty="None" type="Obs"/><text>If H is an order in Q and I is a fractional left H-ideal, then Ol(I) and Or(I) are orders.</text></s>
<s sid="523"><CoreSc1 advantage="None" conceptID="Res223" novelty="None" type="Res"/><text>I is a fractional (Ol(I),Or(I))-ideal.</text></s>
Proof
<s sid="524"><CoreSc1 advantage="None" conceptID="Res224" novelty="None" type="Res"/><text>Let a∈I∩Q•, and let b∈(H:rI)∩Q•.</text></s>
<s sid="525"><CoreSc1 advantage="None" conceptID="Res225" novelty="None" type="Res"/><text>By definition, H⊂Ol(I) and since H is an order and Ol(I) a semigroup, it is also an order.</text></s>
<s sid="526"><CoreSc1 advantage="None" conceptID="Res226" novelty="None" type="Res"/><text>Ol(I)I⊂I and b∈(Ol(I):rI) imply that I is a fractional left Ol(I)-ideal.</text></s>
<s sid="527"><CoreSc1 advantage="None" conceptID="Res227" novelty="None" type="Res"/><text>Since b∈(Ol(I):rI)=(Or(I):lI), it holds that bOl(I)a⊂bI⊂Or(I), and since Or(I) is a semigroup and Ol(I) an order, Or(I) is also an order.</text></s>
<s sid="528"><CoreSc1 advantage="None" conceptID="Res228" novelty="None" type="Res"/><text>Therefore I is also a fractional right Or(I)-ideal. □</text></s>
<s sid="529"><CoreSc1 advantage="None" conceptID="Res229" novelty="None" type="Res"/><text>The previous lemma implies that it is no restriction to require I to be a fractional (H,H′)-ideal over it, say, being a fractional left H-ideal (set H′=Or(I)).</text></s>
Lemma 5.6
<s sid="530"><CoreSc1 advantage="None" conceptID="Res230" novelty="None" type="Res"/><text>Let H and H′ be orders in Q, and let I be a fractional (H,H′)-ideal.1.</text></s>
<s sid="531"><CoreSc1 advantage="None" conceptID="Res231" novelty="None" type="Res"/><text>The orders H, H′, Ol(I) and Or(I) are all equivalent.</text></s>
2.
<s sid="532"><CoreSc1 advantage="None" conceptID="Obs70" novelty="None" type="Obs"/><text>If H is maximal, then Ol(I)=H, and similarly, if H′ is maximal, then Or(I)=H′.</text></s>
3.
<s sid="533"><CoreSc1 advantage="None" conceptID="Obs71" novelty="None" type="Obs"/><text>(H:rI) is a fractional right H-ideal, and (H′:lI) is a fractional left H′-ideal.</text></s>
4.
<s sid="534"><CoreSc1 advantage="None" conceptID="Obs72" novelty="None" type="Obs"/><text>If J is a fractional left H-ideal, then I∩J and I∪J are fractional left H-ideals.</text></s>
5.
<s sid="535"><CoreSc1 advantage="None" conceptID="Obs73" novelty="None" type="Obs"/><text>If (Im)m∈M is a non-empty family of left H-ideals for some index set M, then ⋃m∈MIm is a left H-ideal.</text></s>
6.
<s sid="536"><CoreSc1 advantage="None" conceptID="Res232" novelty="None" type="Res"/><text>If H″ is an order, and K is a fractional (H′,H″)-ideal, then IK is a fractional (H,H″)-ideal.</text></s>
Proof
<s sid="537"><CoreSc1 advantage="None" conceptID="Res233" novelty="None" type="Res"/><text>1. By definition of the right and left order, H⊂Ol(I) and H′⊂Or(I).</text></s>
<s sid="538"><CoreSc1 advantage="None" conceptID="Res234" novelty="None" type="Res"/><text>Let a∈I∩Q•, b∈(H:rI)∩Q• and c∈(H′:lI)∩Q•.</text></s>
<s sid="539"><CoreSc1 advantage="None" conceptID="Res235" novelty="None" type="Res"/><text>Then Ol(I)ab⊂Ib⊂H and caOr(I)⊂H′, so H∼Ol(I) and H′∼Or(I).</text></s>
<s sid="540"><CoreSc1 advantage="None" conceptID="Res236" novelty="None" type="Res"/><text>Finally, cHa⊂cI⊂H′ and aH′b⊂H imply H∼H′.</text></s>
<s sid="541"><CoreSc1 advantage="None" conceptID="Res237" novelty="None" type="Res"/><text>2. By 1, Ol(I)∼H and by definition of the left order H⊂Ol(I).</text></s>
<s sid="542"><CoreSc1 advantage="None" conceptID="Res238" novelty="None" type="Res"/><text>Maximality of H implies H=Ol(I).</text></s>
<s sid="543"><CoreSc1 advantage="None" conceptID="Res239" novelty="None" type="Res"/><text>Analogously, H′=Or(I) if H′ is maximal.</text></s>
<s sid="544"><CoreSc1 advantage="None" conceptID="Res240" novelty="None" type="Res"/><text>3. (H:rI) is an (H′,H)-module, and (H:rI)∩Q•≠∅ because I is a fractional left H-ideal.</text></s>
<s sid="545"><CoreSc1 advantage="None" conceptID="Res241" novelty="None" type="Res"/><text>Since I⊂(H:l(H:rI)), also (H:l(H:rI))∩Q•≠∅, and thus (H:rI) is a fractional right H-ideal.</text></s>
<s sid="546"><CoreSc1 advantage="None" conceptID="Res242" novelty="None" type="Res"/><text>Similarly one shows that (H′:lI) is a fractional left H′-ideal.</text></s>
<s sid="547"><CoreSc1 advantage="None" conceptID="Res243" novelty="None" type="Res"/><text>4. Clearly H(I∩J)⊂I∩J and if c∈(H:rI)∩Q•, then (I∩J)c⊂Ic⊂H.</text></s>
<s sid="548"><CoreSc1 advantage="None" conceptID="Res244" novelty="None" type="Res"/><text>It remains to show I∩J∩Q•≠∅.</text></s>
Let a∈I∩Q• and b∈J∩Q•.
<s sid="549"><CoreSc1 advantage="None" conceptID="Met13" novelty="None" type="Met"/><text>Then a=a′s-1 and b=b′s-1 with a′,b′,s∈H∩Q• (we can choose a common denominator using the right Ore condition).</text></s>
<s sid="550"><CoreSc1 advantage="None" conceptID="Res245" novelty="None" type="Res"/><text>By the left Ore condition there exist a″∈H∩Q• and b″∈H with a″a′=b″b′.</text></s>
Then a″a′s-1=b″b′s-1∈I∩J∩Q•.
<s sid="551"><CoreSc1 advantage="None" conceptID="Res246" novelty="None" type="Res"/><text>For the union, again H(I∪J)⊂I∪J, and there exists a∈(I∪J)∩Q•.</text></s>
<s sid="552"><CoreSc1 advantage="None" conceptID="Res247" novelty="None" type="Res"/><text>It remains to show (H:r(I∪J))∩Q•≠∅.</text></s>
<s sid="553"><CoreSc1 advantage="None" conceptID="Res248" novelty="None" type="Res"/><text>But (H:r(I∪J))=(H:rI)∩(H:rJ), and we are done by applying our previous statement about the intersection to the fractional right H-ideals (H:rI) and (H:rJ).</text></s>
5. Set I=⋃m∈MIm.
<s sid="554"><CoreSc1 advantage="None" conceptID="Res249" novelty="None" type="Res"/><text>Then HI⊂I and I∩Q•≠∅ are clear, and Im⊂H for all m∈M implies 1∈(H:rI).</text></s>
6. Certainly HIKH″⊂IK.
<s sid="555"><CoreSc1 advantage="None" conceptID="Res250" novelty="None" type="Res"/><text>If a∈I∩Q• and b∈K∩Q•, then ab∈IK∩Q•.</text></s>
Let c∈(H:rI)∩Q• and d∈(H′:rK)∩Q•.
Then IKdc⊂IH′c⊂Ic⊂H, i.e., dc∈(H:rIK)∩Q•.
<s sid="556"><CoreSc1 advantage="None" conceptID="Res251" novelty="None" type="Res"/><text>If c′∈(H′:lI)∩Q• and d′∈(H″:lK)∩Q•, then d′c′IK⊂d′H′K⊂d′K⊂H″, i.e., d′c′∈(H″:lIK)∩Q•. □</text></s>
Lemma 5.7
<s sid="557"><CoreSc1 advantage="None" conceptID="Res252" novelty="None" type="Res"/><text>Let H and H′ be orders in Q.1.</text></s>
<s sid="558"><CoreSc1 advantage="None" conceptID="Res253" novelty="None" type="Res"/><text>If H∼H′, then there exist a,b∈H′• with aH′b⊂H.</text></s>
<s sid="559"><CoreSc1 advantage="None" conceptID="Res254" novelty="None" type="Res"/><text>If moreover H⊂H′, then we can even take a,b∈H•.</text></s>
2.
<s sid="560"><CoreSc1 advantage="None" conceptID="Res255" novelty="None" type="Res"/><text>If H∼H′ and H⊂H′, then there exists an order H″ and a,b∈H• such that H⊂H″⊂H′ and H″b⊂H and aH′⊂H″.</text></s>
3.
<s sid="561"><CoreSc1 advantage="None" conceptID="Res256" novelty="None" type="Res"/><text>The following statements are equivalent:(a)</text></s>
H∼H′.
(b)
<s sid="562"><CoreSc1 advantage="None" conceptID="Res257" novelty="None" type="Res"/><text>There exists a fractional (H,H′)-ideal.</text></s>
(c)
<s sid="563"><CoreSc1 advantage="None" conceptID="Res258" novelty="None" type="Res"/><text>There exists a fractional (H′,H)-ideal.</text></s>
Proof
<s sid="564"><CoreSc1 advantage="None" conceptID="Res259" novelty="None" type="Res"/><text>1. There exist x,y∈Q• with xH′y⊂H.</text></s>
<s sid="565"><CoreSc1 advantage="None" conceptID="Res260" novelty="None" type="Res"/><text>Since H′ is an order in Q, x=ac-1 and y=d-1b with a,b∈H′ and c,d∈H′∩Q•.</text></s>
<s sid="566"><CoreSc1 advantage="None" conceptID="Res261" novelty="None" type="Res"/><text>If H⊂H′ we even take a,b,c,d∈H.</text></s>
Then aH′b⊂ac-1H′d-1b⊂H.
<s sid="567"><CoreSc1 advantage="None" conceptID="Res262" novelty="None" type="Res"/><text>2. Using 1 choose a,b∈H• with aH′b⊂H.</text></s>
Let H″=H∪aH′∪HaH′.
<s sid="568"><CoreSc1 advantage="None" conceptID="Res263" novelty="None" type="Res"/><text>Then it is easily checked that H″H″⊂H″ and obviously H⊂H″, thus H″ is an order.</text></s>
<s sid="569"><CoreSc1 advantage="None" conceptID="Res264" novelty="None" type="Res"/><text>Moreover, H″⊂H′, H″b⊂H and aH′⊂H″, as claimed.</text></s>
<s sid="570"><CoreSc1 advantage="None" conceptID="Res265" novelty="None" type="Res"/><text>3. (a) ⇒ (b): By 1 there exist a,b∈H• with aHb⊂H′ and c,d∈H′• with cH′d⊂H.</text></s>
Define I=HbcH′.
<s sid="571"><CoreSc1 advantage="None" conceptID="Res266" novelty="None" type="Res"/><text>Clearly I is an (H,H′)-module with bc∈I∩Q•.</text></s>
<s sid="572"><CoreSc1 advantage="None" conceptID="Res267" novelty="None" type="Res"/><text>Since aI=aHbcH′⊂H′cH′⊂H′ and Id=HbcH′d⊂HbH⊂H, I is a fractional (H,H′)-ideal.</text></s>
<s sid="573"><CoreSc1 advantage="None" conceptID="Res268" novelty="None" type="Res"/><text>(b) ⇒ (a): By Lemma 5.6.1.</text></s>
<s sid="574"><CoreSc1 advantage="None" conceptID="Res269" novelty="None" type="Res"/><text>(a) ⇔ (c) follows by symmetry, swapping the roles of H and H′. □</text></s>
Lemma 5.8
<s sid="575"><CoreSc1 advantage="None" conceptID="Res270" novelty="None" type="Res"/><text>Let H be an order in Q.</text></s>
<s sid="576"><CoreSc1 advantage="None" conceptID="Res271" novelty="None" type="Res"/><text>The following statements are equivalent.(a)</text></s>
<s sid="577"><CoreSc1 advantage="None" conceptID="Res272" novelty="None" type="Res"/><text>H is a maximal order.</text></s>
(b)
<s sid="578"><CoreSc1 advantage="None" conceptID="Res273" novelty="None" type="Res"/><text>If I is a fractional left H-ideal, then Ol(I)=H and if J is a fractional right H-ideal, then Or(I)=H.</text></s>
(c)
<s sid="579"><CoreSc1 advantage="None" conceptID="Res274" novelty="None" type="Res"/><text>If I is a fractional H-ideal, then Or(I)=Ol(I)=H.</text></s>
(d)
<s sid="580"><CoreSc1 advantage="None" conceptID="Res275" novelty="None" type="Res"/><text>If I is an H-ideal, then Or(I)=Ol(I)=H.</text></s>
Proof
<s sid="581"><CoreSc1 advantage="None" conceptID="Res276" novelty="None" type="Res"/><text>(a) ⇒ (b): By Lemma 5.6.2, Ol(I)=H and Or(J)=H.</text></s>
<s sid="582"><CoreSc1 advantage="None" conceptID="Res277" novelty="None" type="Res"/><text>(b) ⇒ (c) ⇒ (d): Trivial.</text></s>
<s sid="583"><CoreSc1 advantage="None" conceptID="Res278" novelty="None" type="Res"/><text>(d) ⇒ (a): Assume H′ is an order equivalent to H and H⊂H′.</text></s>
<s sid="584"><CoreSc1 advantage="None" conceptID="Res279" novelty="None" type="Res"/><text>Applying Lemma 5.7.2 we find an equivalent order H″ with H⊂H″⊂H′ and a,b∈Q• with aH′⊂H″ and H″b⊂H.</text></s>
Let I={x∈Q|H″x⊂H}.
<s sid="585"><CoreSc1 advantage="None" conceptID="Res280" novelty="None" type="Res"/><text>Then I is an H-ideal, and H″⊂Ol(I), implying H″=H by (d).</text></s>
Set J={x∈Q|xH′⊂H}.
<s sid="586"><CoreSc1 advantage="None" conceptID="Res281" novelty="None" type="Res"/><text>Then J is again an H-ideal (we use a∈J since H″=H), and H′⊂Or(J) implies H′=H. □</text></s>
Lemma 5.9
<s sid="587"><CoreSc1 advantage="None" conceptID="Res282" novelty="None" type="Res"/><text>Let H be a maximal order in Q, let I and J be fractional left H-ideals, and let K be a fractional left Or(I)-ideal.1.</text></s>
<s sid="588"><CoreSc1 advantage="None" conceptID="Res283" novelty="None" type="Res"/><text>Ol(I)=H, I-1 is a fractional right H-ideal with Or(I-1)=H and Iv is a fractional left H-ideal with Ol(Iv)=H and I⊂Iv.</text></s>
Moreover, Ol(I)v=Hv=H.
2.
<s sid="589"><CoreSc1 advantage="None" conceptID="Res284" novelty="None" type="Res"/><text>If a∈Q•, then Ha is a fractional left H-ideal with Or(Ha)=a-1Ha, (Ha)-1=a-1H and (Ha)v=Ha.</text></s>
<s sid="590"><CoreSc1 advantage="None" conceptID="Res285" novelty="None" type="Res"/><text>Ha is integral (equivalently, a left H-ideal), if and only if a∈H•.</text></s>
3.
<s sid="591"><CoreSc1 advantage="None" conceptID="Res286" novelty="None" type="Res"/><text>If I⊂J then J-1⊂I-1 and Iv⊂Jv.</text></s>
4.
I⊂Iv=(Iv)v, Iv-1=(I-1)v=I-1 and Ol(Iv)=Ol(I)=Ol(I)v=H.
5.
(Iv∩Jv)v=Iv∩Jv.
6.
(I∪J)v=(Iv∪J)v=(I∪Jv)v=(Iv∪Jv)v.
7.
<s sid="592"><CoreSc1 advantage="None" conceptID="Res287" novelty="None" type="Res"/><text>If Or(I) and Or(K) are also maximal, then (IK)v=(IvK)v=(IKv)v=(IvKv)v.</text></s>
Proof
<s sid="593"><CoreSc1 advantage="None" conceptID="Res288" novelty="None" type="Res"/><text>1. By Lemma 5.6.2, Ol(I)=H, and thus Lemma 5.6.3 implies that I-1=(H:rI) is a right H-ideal.</text></s>
<s sid="594"><CoreSc1 advantage="None" conceptID="Res289" novelty="None" type="Res"/><text>By the symmetric statement of what we just showed for fractional right H-ideals, therefore Or(I-1)=H and Iv is a fractional left H-ideal.</text></s>
<s sid="595"><CoreSc1 advantage="None" conceptID="Res290" novelty="None" type="Res"/><text>Applying the first part of the statement to Iv yields Ol(Iv)=H.</text></s>
<s sid="596"><CoreSc1 advantage="None" conceptID="Res291" novelty="None" type="Res"/><text>Now I⊂Iv follows from Lemma 5.2.2, and Hv=H from H-1=(H:rH)=H.</text></s>
<s sid="597"><CoreSc1 advantage="None" conceptID="Res292" novelty="None" type="Res"/><text>2. Since a∈Ha∩Q• and a-1∈(H:rHa), Ha is a fractional left H-ideal.</text></s>
Certainly a-1Ha⊂Or(Ha).
<s sid="598"><CoreSc1 advantage="None" conceptID="Res293" novelty="None" type="Res"/><text>Conversely, if x∈Or(Ha), then ax∈Ha and thus x∈a-1Ha, so that altogether Or(Ha)=a-1Ha.</text></s>
<s sid="599"><CoreSc1 advantage="None" conceptID="Res294" novelty="None" type="Res"/><text>Moreover, (Ha)a-1H⊂H and if Hax⊂H for x∈Q•, then ax∈H and hence x∈a-1H, implying (Ha)-1=a-1H.</text></s>
Finally, (Ha)v=Ha because (Ha)v=((Ha)-1)-1=Ha.
<s sid="600"><CoreSc1 advantage="None" conceptID="Res295" novelty="None" type="Res"/><text>Ha is a left H-ideal if and only if it is integral due to maximality of H, and Ha⊂H if and only if a∈H∩Q•=H•.</text></s>
<s sid="601"><CoreSc1 advantage="None" conceptID="Res296" novelty="None" type="Res"/><text>3. If x∈Q with Jx⊂H, then Ix⊂Jx⊂H, and hence J-1⊂I-1.</text></s>
<s sid="602"><CoreSc1 advantage="None" conceptID="Res297" novelty="None" type="Res"/><text>By 1, J-1 and I-1 are fractional right H-ideals with Or(I-1)=Or(J-1)=H, and we apply the symmetric statement for right fractional H-ideals to obtain Iv⊂Jv.</text></s>
<s sid="603"><CoreSc1 advantage="None" conceptID="Res298" novelty="None" type="Res"/><text>4. By 1, I-1 is a fractional right H-ideal with Or(I-1)=H, and Iv is a fractional left H-ideal with Ol(Iv)=H.</text></s>
<s sid="604"><CoreSc1 advantage="None" conceptID="Res299" novelty="None" type="Res"/><text>Moreover, also by 1, I⊂Iv and I-1⊂(I-1)v=[(I-1)-1]-1=Iv-1.</text></s>
<s sid="605"><CoreSc1 advantage="None" conceptID="Res300" novelty="None" type="Res"/><text>It follows from 3, that Iv⊂(Iv)v and I-1=Iv-1.</text></s>
Therefore (Iv)v=(Iv-1)-1⊂(I-1)-1=Iv, whence Iv=(Iv)v.
5. Iv∩Jv⊂(Iv∩Jv)v⊂(Iv)v∩(Jv)v=Iv∩Jv.
<s sid="606"><CoreSc1 advantage="None" conceptID="Res301" novelty="None" type="Res"/><text>6. I∪J⊂Iv∪J⊂Iv∪Jv⊂(I∪J)v and by taking divisorial closures, and 4, the claim follows.</text></s>
<s sid="607"><CoreSc1 advantage="None" conceptID="Res302" novelty="None" type="Res"/><text>7. We use Or(Iv)=Or(I) and Ol(K)=Ol(Kv) (from 1).</text></s>
<s sid="608"><CoreSc1 advantage="None" conceptID="Res303" novelty="None" type="Res"/><text>We have IK⊂IvK⊂IvKv, and similarly IK⊂IKv⊂IvKv (by 1).</text></s>
<s sid="609"><CoreSc1 advantage="None" conceptID="Res304" novelty="None" type="Res"/><text>By 3, this implies (IK)v⊂(IKv)v⊂(IvKv)v and (IK)v⊂(IvK)v⊂(IvKv)v.</text></s>
<s sid="610"><CoreSc1 advantage="None" conceptID="Res305" novelty="None" type="Res"/><text>To prove the claim it suffices to show (IvKv)v⊂(IK)v, which will follow from 3 and 4 if we show IvKv⊂(IK)v.</text></s>
<s sid="611"><CoreSc1 advantage="None" conceptID="Res306" novelty="None" type="Res"/><text>Since IK(IK)-1⊂Ol(I), we have K(IK)-1⊂(Ol(I):rI)=I-1=Iv-1, where the last equality is due to 4.</text></s>
<s sid="612"><CoreSc1 advantage="None" conceptID="Res307" novelty="None" type="Res"/><text>Multiplying by Iv from the right gives K(IK)-1Iv⊂Iv-1Iv.</text></s>
By definition, Iv-1Iv⊂Or(Iv).
Since Or(Iv)=Or(I)=Ol(K), therefore K(IK)-1Iv⊂Ol(K).
<s sid="613"><CoreSc1 advantage="None" conceptID="Res308" novelty="None" type="Res"/><text>Now (IK)-1Iv⊂K-1=Kv-1 (using 4 again).</text></s>
<s sid="614"><CoreSc1 advantage="None" conceptID="Res309" novelty="None" type="Res"/><text>Multiplying by Kv from the right and using Or(Kv)=Or(K), we obtain (IK)-1IvKv⊂Or(K).</text></s>
<s sid="615"><CoreSc1 advantage="None" conceptID="Res310" novelty="None" type="Res"/><text>Since Ol((IK)-1)=Or(K), this implies IvKv⊂((IK)-1)-1=(IK)v. □</text></s>
Definition 5.10
<s sid="616"><CoreSc1 advantage="None" conceptID="Res311" novelty="None" type="Res"/><text>Let H be an order in Q.</text></s>
<s sid="617"><CoreSc1 advantage="None" conceptID="Res312" novelty="None" type="Res"/><text>A fractional left or right H-ideal I is called divisorial if I=Iv.</text></s>
<s sid="618"><CoreSc1 advantage="None" conceptID="Res313" novelty="None" type="Res"/><text>If I is a fractional left H-ideal for a maximal order H, then it is not necessarily true that Or(I) is again a maximal order.</text></s>
<s sid="619"><CoreSc1 advantage="None" conceptID="Res314" novelty="None" type="Res"/><text>The next proposition shows that for divisorial fractional left or right H-ideals with H maximal, already both, Ol(I) and Or(I), are maximal.</text></s>
<s sid="620"><CoreSc1 advantage="None" conceptID="Res315" novelty="None" type="Res"/><text>We can define an associative partial operation, the v-product, by I⋅vJ=(IJ)v when J is a divisorial fractional left Or(I)-ideal.</text></s>
<s sid="621"><CoreSc1 advantage="None" conceptID="Res316" novelty="None" type="Res"/><text>Moreover it shows that every divisorial fractional left or right ideal is v-invertible, i.e., invertible with respect to this operation.</text></s>
Proposition 5.11
<s sid="622"><CoreSc1 advantage="None" conceptID="Res317" novelty="None" type="Res"/><text>Let H be a maximal order in Q.</text></s>
<s sid="623"><CoreSc1 advantage="None" conceptID="Res318" novelty="None" type="Res"/><text>Let I be a fractional left H-ideal. Then:1.</text></s>
<s sid="624"><CoreSc1 advantage="None" conceptID="Res319" novelty="None" type="Res"/><text>Ol(I-1) is a maximal order.</text></s>
<s sid="625"><CoreSc1 advantage="None" conceptID="Res320" novelty="None" type="Res"/><text>In particular, Or(Iv) is a maximal order.</text></s>
2.
<s sid="626"><CoreSc1 advantage="None" conceptID="Res321" novelty="None" type="Res"/><text>(II-1)v=Ol(I) and if Or(I) is also maximal, then (I-1I)v=Or(I).</text></s>
3.
<s sid="627"><CoreSc1 advantage="None" conceptID="Res322" novelty="None" type="Res"/><text>If I is a divisorial fractional left H-ideal, J a divisorial fractional left Or(I)-ideal and K a divisorial fractional left Or(J)-ideal, then(I⋅vJ)⋅vK=I⋅v(J⋅vK).</text></s>
Proof
<s sid="628"><CoreSc1 advantage="None" conceptID="Res323" novelty="None" type="Res"/><text>1. Because H is maximal, Ol(I)=H.</text></s>
Trivially, Or(I)⊂Ol(I-1).
<s sid="629"><CoreSc1 advantage="None" conceptID="Res324" novelty="None" type="Res"/><text>Let H′⊃Ol(I-1) be an order with H′∼Ol(I-1).</text></s>
<s sid="630"><CoreSc1 advantage="None" conceptID="Res325" novelty="None" type="Res"/><text>Then J=IH′I-1 is an (H,H)-module and if a∈I∩Q• and b∈I-1∩Q•, then ab∈J and moreoverJ2=IH′I-1IH′I-1⊂IH′Ol(I-1)H′I-1=IH′I-1=J, showing that J is an integral left Ol(J)-ideal.</text></s>
We claim H=Ol(J).
<s sid="631"><CoreSc1 advantage="None" conceptID="Res326" novelty="None" type="Res"/><text>Since H=Ol(I)⊂Ol(J) and H is maximal, it suffices to show Ol(J)∼H.</text></s>
<s sid="632"><CoreSc1 advantage="None" conceptID="Res327" novelty="None" type="Res"/><text>To this end we first show bJa⊂H′:bJa=bIH′I-1a⊂I-1IH′I-1I⊂Or(I)H′Or(I)=H′.</text></s>
<s sid="633"><CoreSc1 advantage="None" conceptID="Res328" novelty="None" type="Res"/><text>Since H′∼H, there exist c,d∈Q• with cH′d⊂H.</text></s>
<s sid="634"><CoreSc1 advantage="None" conceptID="Res329" novelty="None" type="Res"/><text>Since ab∈J∩Q• therefore cb(Ol(J)ab)ad⊂cbJad⊂H, proving the claim.</text></s>
<s sid="635"><CoreSc1 advantage="None" conceptID="Res330" novelty="None" type="Res"/><text>Therefore, from the definition of J, H′I-1⊂(J:rI)⊂(Ol(J):rI)=(H:rI)=I-1 and thus H′⊂Ol(I-1), and, because we started out with the converse inclusion, also H′=Ol(I-1).</text></s>
<s sid="636"><CoreSc1 advantage="None" conceptID="Res331" novelty="None" type="Res"/><text>Now Or(Iv)=Ol(I-1) implies the &quot;in particular&quot; statement.</text></s>
<s sid="637"><CoreSc1 advantage="None" conceptID="Res332" novelty="None" type="Res"/><text>2. We have to show (II-1)v=Ol(I) and (I-1I)v=Or(I), and we check the first equality as the second one then follows analogously.</text></s>
<s sid="638"><CoreSc1 advantage="None" conceptID="Res333" novelty="None" type="Res"/><text>The inclusion II-1⊂Ol(I) implies (II-1)v⊂Ol(I)v=Ol(I).</text></s>
<s sid="639"><CoreSc1 advantage="None" conceptID="Res334" novelty="None" type="Res"/><text>It remains to prove Ol(I)⊂(II-1)v.</text></s>
<s sid="640"><CoreSc1 advantage="None" conceptID="Res335" novelty="None" type="Res"/><text>Due to maximality of Ol(I), it holds that Ol(II-1)=Ol(I), and therefore II-1(II-1)-1⊂Ol(I).</text></s>
Thus I-1(II-1)-1⊂I-1, and (II-1)-1⊂Or(I-1)=Ol(I).
<s sid="641"><CoreSc1 advantage="None" conceptID="Res336" novelty="None" type="Res"/><text>By Lemma 5.9.3, therefore Ol(I)⊂(II-1)v.</text></s>
<s sid="642"><CoreSc1 advantage="None" conceptID="Res337" novelty="None" type="Res"/><text>3. Using Lemma 5.9.7, which can be applied due to 1, ((IJ)vK)v=(IJK)v=(I(JK)v)v. □</text></s>
Corollary 5.12
<s sid="643"><CoreSc1 advantage="None" conceptID="Res338" novelty="None" type="Res"/><text>If H is a maximal order, then every order H′ with H′∼H is contained in a maximal order equivalent to H.</text></s>
Proof
<s sid="644"><CoreSc1 advantage="None" conceptID="Res339" novelty="None" type="Res"/><text>By Lemma 5.7.3, there exists a fractional (H,H′)-ideal I.</text></s>
<s sid="645"><CoreSc1 advantage="None" conceptID="Res340" novelty="None" type="Res"/><text>Then Iv is divisorial, Or(Iv)∼Ol(Iv)=H, H′⊂Or(Iv) and by Proposition 5.11.1 Or(Iv) is maximal. □</text></s>
Corollary 5.13
<s sid="646"><CoreSc1 advantage="None" conceptID="Res341" novelty="None" type="Res"/><text>Let α denote an equivalence class of maximal orders of Q.</text></s>
<s sid="647"><CoreSc1 advantage="None" conceptID="Res342" novelty="None" type="Res"/><text>LetFv(α)={I|I is a divisorial fractional left (or right) H-ideal with H∈α} andIv(α)={I|I is a divisorial left (or right) H-ideal with H∈α}.</text></s>
<s sid="648"><CoreSc1 advantage="None" conceptID="Res343" novelty="None" type="Res"/><text>Then (Fv(α),⋅v,⊂) is a lattice-ordered groupoid, with identity elements the maximal orders in α.</text></s>
<s sid="649"><CoreSc1 advantage="None" conceptID="Res344" novelty="None" type="Res"/><text>If I, J are in Fv(α) with Ol(I)=Ol(J) or Or(I)=Or(J), then I∧J=I∩J and I∨J=(I∪J)v.</text></s>
<s sid="650"><CoreSc1 advantage="None" conceptID="Res345" novelty="None" type="Res"/><text>Moreover, Iv(α) is the subcategory of integral elements.</text></s>
Proof
<s sid="651"><CoreSc1 advantage="None" conceptID="Res346" novelty="None" type="Res"/><text>For I∈Fv(α) we have Ol(I)⋅vI=I=I⋅vOr(I).</text></s>
<s sid="652"><CoreSc1 advantage="None" conceptID="Res347" novelty="None" type="Res"/><text>If J∈Fv(α), then the v-product I⋅vJ is defined whenever Or(I)=Ol(J), and then I⋅vJ is a divisorial fractional (Ol(I),Or(J))-ideal.</text></s>
<s sid="653"><CoreSc1 advantage="None" conceptID="Mod115" novelty="None" type="Mod"/><text>The v-product is associative when it is defined (Proposition 5.11.3).</text></s>
<s sid="654"><CoreSc1 advantage="None" conceptID="Mod116" novelty="None" type="Mod"/><text>Therefore Fv(α) with ⋅v as composition is a category where the set of identities is the set of maximal orders, α, and for I∈Fv(α) we have s(I)=Ol(I) and t(I)=Or(I).</text></s>
<s sid="655"><CoreSc1 advantage="None" conceptID="Mod117" novelty="None" type="Mod"/><text>This category is a groupoid due to Proposition 5.11.2.</text></s>
<s sid="656"><CoreSc1 advantage="None" conceptID="Mod118" novelty="None" type="Mod"/><text>On Fv(α) set inclusion defines a partial order, and obviously also the restrictions to {I∈Fv(α)|Ol(I)=H} and {I∈Fv(α)|Or(I)=H} for H∈α, given by set inclusion in these subsets, are partial orders.</text></s>
Let I,J∈Fv(α) with Ol(I)=Ol(J).
<s sid="657"><CoreSc1 advantage="None" conceptID="Res348" novelty="None" type="Res"/><text>Then I∩J∈Fv(α) and (I∪J)v∈Fv(α) (by Lemmas 5.6 and 5.9), and clearly they are the infimum respectively supremum of {I,J} in {I∈Fv(α)|Ol(I)=H}, making this set lattice-ordered.</text></s>
<s sid="658"><CoreSc1 advantage="None" conceptID="Res349" novelty="None" type="Res"/><text>Symmetric statements hold if Or(I)=Or(J).</text></s>
<s sid="659"><CoreSc1 advantage="None" conceptID="Res350" novelty="None" type="Res"/><text>If Ol(I)=Ol(J) and Or(I)=Or(J) both hold, then also Ol(I∩J)=Ol((I∪J)v)=Ol(I) and Or(I∩J)=Or((I∪J)v)=Or(I) both hold.</text></s>
<s sid="660"><CoreSc1 advantage="None" conceptID="Res351" novelty="None" type="Res"/><text>Therefore (Fv(α),⊂) is a lattice-ordered groupoid with the claimed meet and join.</text></s>
<s sid="661"><CoreSc1 advantage="None" conceptID="Res352" novelty="None" type="Res"/><text>It is immediate from the definitions that Iv(α) is the subcategory of integral elements of this lattice-ordered groupoid. □</text></s>
Definition &amp; Lemma 5.14
<s sid="662"><CoreSc1 advantage="None" conceptID="Res353" novelty="None" type="Res"/><text>An order H is bounded if it satisfies the following equivalent conditions:(a)</text></s>
<s sid="663"><CoreSc1 advantage="None" conceptID="Res354" novelty="None" type="Res"/><text>Every fractional left H-ideal and every fractional right H-ideal contains a fractional (two-sided) H-ideal.</text></s>
(b)
<s sid="664"><CoreSc1 advantage="None" conceptID="Res355" novelty="None" type="Res"/><text>Every left H-ideal and every right H-ideal contains a (two-sided) H-ideal.</text></s>
(c)
<s sid="665"><CoreSc1 advantage="None" conceptID="Res356" novelty="None" type="Res"/><text>For all a∈Q• there exist b,c∈Q• such that bH⊂Ha and Hc⊂aH.</text></s>
(d)
<s sid="666"><CoreSc1 advantage="None" conceptID="Res357" novelty="None" type="Res"/><text>For all a∈Q• there exist b,c∈Q• such that Ha⊂bH and aH⊂Hc.</text></s>
(e)
<s sid="667"><CoreSc1 advantage="None" conceptID="Res358" novelty="None" type="Res"/><text>For all a∈Q•, HaH is a fractional (two-sided) H-ideal.</text></s>
(f)
<s sid="668"><CoreSc1 advantage="None" conceptID="Res359" novelty="None" type="Res"/><text>For all a∈Q• there exists a fractional (two-sided) H-ideal I with a∈I.</text></s>
(g)
<s sid="669"><CoreSc1 advantage="None" conceptID="Res360" novelty="None" type="Res"/><text>If M⊂Q and a,b∈Q• with aMb⊂H, then there exist c,d∈Q• with cM⊂H and Md⊂H.</text></s>
Proof
(a) ⇒ (b): Trivial.
<s sid="670"><CoreSc1 advantage="None" conceptID="Res361" novelty="None" type="Res"/><text>(b) ⇒ (c): Let a∈Q•.</text></s>
<s sid="671"><CoreSc1 advantage="None" conceptID="Res362" novelty="None" type="Res"/><text>Then a=d-1c with c,d∈H∩Q•, and Ha=Hd-1c⊃Hc.</text></s>
<s sid="672"><CoreSc1 advantage="None" conceptID="Res363" novelty="None" type="Res"/><text>By (b), Hc contains an H-ideal J. If b∈J∩Q•, then bH⊂J⊂Ha.</text></s>
<s sid="673"><CoreSc1 advantage="None" conceptID="Res364" novelty="None" type="Res"/><text>The symmetric claim follows similarly.</text></s>
<s sid="674"><CoreSc1 advantage="None" conceptID="Res365" novelty="None" type="Res"/><text>(c) ⇒ (d): By (c) applied to a-1, there exist b,c∈Q• with b-1H⊂Ha-1 and Hc-1⊂a-1H.</text></s>
Then Ha⊂bH and aH⊂Hc.
<s sid="675"><CoreSc1 advantage="None" conceptID="Res366" novelty="None" type="Res"/><text>(d) ⇒ (e): HaH is an (H,H)-module and contains the element a∈Q•.</text></s>
<s sid="676"><CoreSc1 advantage="None" conceptID="Res367" novelty="None" type="Res"/><text>Let b,c∈Q• with Ha⊂bH and aH⊂Hc.</text></s>
<s sid="677"><CoreSc1 advantage="None" conceptID="Res368" novelty="None" type="Res"/><text>Then HaH⊂bH and HaH⊂Hc, hence b-1∈(H:lHaH) and c-1∈(H:rHaH).</text></s>
(e) ⇒ (f): Trivial.
<s sid="678"><CoreSc1 advantage="None" conceptID="Res369" novelty="None" type="Res"/><text>(f) ⇒ (g): aM⊂Hb-1⊂Hb-1H, and the latter being contained in a fractional H-ideal, there exists a′∈Q•∩(H:lHb-1H) and thus a′aM⊂H.</text></s>
<s sid="679"><CoreSc1 advantage="None" conceptID="Res370" novelty="None" type="Res"/><text>Similarly, Mb⊂a-1H⊂Ha-1H, and there exists a b′∈Q•∩(H:rHa-1H).</text></s>
Thus Mbb′⊂H.
<s sid="680"><CoreSc1 advantage="None" conceptID="Res371" novelty="None" type="Res"/><text>(g) ⇒ (a): Let I be a fractional left H-ideal and a∈I∩Q•.</text></s>
<s sid="681"><CoreSc1 advantage="None" conceptID="Res372" novelty="None" type="Res"/><text>Then (Ha-1)a⊂H and so there exists a b∈Q• such that b(Ha-1)⊂H, and thus bH⊂Ha.</text></s>
<s sid="682"><CoreSc1 advantage="None" conceptID="Res373" novelty="None" type="Res"/><text>Therefore HbH⊂Ha⊂I and HbH is a fractional H-ideal contained in I (as b∈HbH, a-1∈(H:rHbH) and, by (g) again, there exists a c∈Q• with c(Hb)⊂H, whence c∈(H:lHbH)).</text></s>
<s sid="683"><CoreSc1 advantage="None" conceptID="Obs74" novelty="None" type="Obs"/><text>The case where I is a fractional right H-ideal is similar. □</text></s>
Lemma 5.15
1.
<s sid="684"><CoreSc1 advantage="None" conceptID="Obs75" novelty="None" type="Obs"/><text>Let H and H′ be orders in Q.</text></s>
<s sid="685"><CoreSc1 advantage="None" conceptID="Obs76" novelty="None" type="Obs"/><text>If H is bounded and H∼H′, then H′ is also bounded.</text></s>
2.
<s sid="686"><CoreSc1 advantage="None" conceptID="Obs77" novelty="None" type="Obs"/><text>Let H and H′ be bounded equivalent maximal orders of Q.</text></s>
<s sid="687"><CoreSc1 advantage="None" conceptID="Res374" novelty="None" type="Res"/><text>Then there exists an (H,H′)-ideal I.</text></s>
Proof
<s sid="688"><CoreSc1 advantage="None" conceptID="Res375" novelty="None" type="Res"/><text>1. Because H∼H′ and H is bounded, there exist c,d∈Q• with cH⊂H′⊂dH (using (c) and (d) of the equivalent characterizations of boundedness).</text></s>
<s sid="689"><CoreSc1 advantage="None" conceptID="Res376" novelty="None" type="Res"/><text>We verify condition (c) for H′.</text></s>
Let a∈Q•.
<s sid="690"><CoreSc1 advantage="None" conceptID="Res377" novelty="None" type="Res"/><text>Then cHa⊂H′a, and there exists an x∈Q• with xH⊂Ha.</text></s>
<s sid="691"><CoreSc1 advantage="None" conceptID="Res378" novelty="None" type="Res"/><text>Then cxH⊂H′a and finally cxd-1H′⊂cxH⊂H′a.</text></s>
<s sid="692"><CoreSc1 advantage="None" conceptID="Res379" novelty="None" type="Res"/><text>Similarly, one finds z∈Q• with H′z⊂aH′.</text></s>
<s sid="693"><CoreSc1 advantage="None" conceptID="Res380" novelty="None" type="Res"/><text>2. We show: If H and H′ are bounded equivalent maximal orders, then H′H is a fractional (H′,H)-ideal.</text></s>
<s sid="694"><CoreSc1 advantage="None" conceptID="Res381" novelty="None" type="Res"/><text>Then (H′H)-1 is an (H,H′)-ideal (since Or(H′H)=H by maximality of H and H⊂H′H, Lemma 5.9.3 implies (H′H)-1⊂H; similarly, one shows (H′H)-1⊂H′).</text></s>
<s sid="695"><CoreSc1 advantage="None" conceptID="Res382" novelty="None" type="Res"/><text>Clearly H′H is an (H′,H)-module and 1∈H′H.</text></s>
<s sid="696"><CoreSc1 advantage="None" conceptID="Res383" novelty="None" type="Res"/><text>We need to show that there exist a,b∈Q• with H′Ha⊂H′ and bH′H⊂H.</text></s>
<s sid="697"><CoreSc1 advantage="None" conceptID="Res384" novelty="None" type="Res"/><text>Since H and H′ are bounded and equivalent there exist a,b∈Q• with Ha⊂H′ and bH′⊂H, and the claim follows. □</text></s>
Proposition 5.16
<s sid="698"><CoreSc1 advantage="None" conceptID="Res385" novelty="None" type="Res"/><text>Let α be an equivalence class of maximal orders in Q.</text></s>
<s sid="699"><CoreSc1 advantage="None" conceptID="Res386" novelty="None" type="Res"/><text>(Fv(α),⋅v,⊂) is an arithmetical groupoid if and only if all H∈α (equivalently, one H∈α) satisfy the following three conditions:(A1)</text></s>
<s sid="700"><CoreSc1 advantage="None" conceptID="Res387" novelty="None" type="Res"/><text>H satisfies the ACC on divisorial left H-ideals and the ACC on divisorial right H-ideals,</text></s>
(A2)
H is bounded,
(A3)
<s sid="701"><CoreSc1 advantage="None" conceptID="Res388" novelty="None" type="Res"/><text>the lattice of divisorial fractional left H-ideals is modular, and the lattice of divisorial right H-ideals is modular.</text></s>
Proof
<s sid="702"><CoreSc1 advantage="None" conceptID="Res389" novelty="None" type="Res"/><text>From Corollary 5.13 we already know that Fv(α) is a lattice-ordered groupoid.</text></s>
<s sid="703"><CoreSc1 advantage="None" conceptID="Res390" novelty="None" type="Res"/><text>As in the discussion after Definition 4.2 and from Lemma 5.15, we see that if one representative H∈α satisfies A1-A3, then the same is true for all H′∈α.</text></s>
<s sid="704"><CoreSc1 advantage="None" conceptID="Res391" novelty="None" type="Res"/><text>Assume first that A1-A3 hold.</text></s>
<s sid="705"><CoreSc1 advantage="None" conceptID="Res392" novelty="None" type="Res"/><text>Then P1 holds due to Lemma 5.2.5, property P2 is just A3 in the present setting.</text></s>
<s sid="706"><CoreSc1 advantage="None" conceptID="Res393" novelty="None" type="Res"/><text>P3 follows easily: If I⊂J are divisorial fractional left H-ideals, and K is a divisorial fractional right H-ideal, then KI⊂KJ and therefore K⋅vI=(KI)v⊂(KJ)v=K⋅vJ, and similarly for the symmetric statement.</text></s>
<s sid="707"><CoreSc1 advantage="None" conceptID="Res394" novelty="None" type="Res"/><text>P4 also holds: Let (Im)m∈M be a non-empty family of divisorial left H-ideals.</text></s>
<s sid="708"><CoreSc1 advantage="None" conceptID="Res395" novelty="None" type="Res"/><text>Then (⋃m∈MIm)v⊂H is also a divisorial left H-ideal, and if (Im)m∈M is a family of (H,H′)-ideals with H′∈α, then the divisorial closure of the union is again an (H,H′)-ideal.</text></s>
P6 is just A1.
<s sid="709"><CoreSc1 advantage="None" conceptID="Res396" novelty="None" type="Res"/><text>A2 implies P5: If H,H′∈α, then there exists an (H,H′)-ideal I by Lemma 5.15.2.</text></s>
<s sid="710"><CoreSc1 advantage="None" conceptID="Res397" novelty="None" type="Res"/><text>Then Iv is as required in P5.</text></s>
<s sid="711"><CoreSc1 advantage="None" conceptID="Res398" novelty="None" type="Res"/><text>Assume now that (Fv(α),⋅v,⊂) is an arithmetical groupoid, and H∈α.</text></s>
<s sid="712"><CoreSc1 advantage="None" conceptID="Res399" novelty="None" type="Res"/><text>Then P2 implies A3, and P6 implies A3.</text></s>
<s sid="713"><CoreSc1 advantage="None" conceptID="Res400" novelty="None" type="Res"/><text>From P5 we can derive A2: Let I be a fractional left H-ideal, and x∈I∩Q•.</text></s>
Then Hx∈Fv(α).
<s sid="714"><CoreSc1 advantage="None" conceptID="Res401" novelty="None" type="Res"/><text>By P5, there exists J∈Iv(α) with Ol(J)=Or(Hx) and Or(J)=H.</text></s>
<s sid="715"><CoreSc1 advantage="None" conceptID="Res402" novelty="None" type="Res"/><text>Thus HxJ is a fractional H-ideal, and HxJ⊂I.</text></s>
<s sid="716"><CoreSc1 advantage="None" conceptID="Res403" novelty="None" type="Res"/><text>We proceed similarly if I is a fractional right H-ideal. □</text></s>
Remark 5.17
1.
<s sid="717"><CoreSc1 advantage="None" conceptID="Res404" novelty="None" type="Res"/><text>From the discussion after Definition 4.2, we also see that we can equivalently formulate A3 as &quot;the lattice of divisorial fractional left (right) H-ideals is modular&quot;, as the property for the other side then holds automatically.</text></s>
2.
<s sid="718"><CoreSc1 advantage="None" conceptID="Res405" novelty="None" type="Res"/><text>Let H be a normalizing monoid.</text></s>
<s sid="719"><CoreSc1 advantage="None" conceptID="Res406" novelty="None" type="Res"/><text>By definition of a monoid, H satisfies the left and right Ore condition, hence it is an order in its quotient group.</text></s>
<s sid="720"><CoreSc1 advantage="None" conceptID="Res407" novelty="None" type="Res"/><text>Lemma 5.9.2 shows that every fractional left or right H-ideal is in fact already a two-sided H-ideal, and thus H is bounded.</text></s>
<s sid="721"><CoreSc1 advantage="None" conceptID="Res408" novelty="None" type="Res"/><text>Assume that H is a normalizing Krull monoid.</text></s>
<s sid="722"><CoreSc1 advantage="None" conceptID="Res409" novelty="None" type="Res"/><text>Then α={H}, and the lattice-ordered groupoid Fv(α) is in fact a group.</text></s>
<s sid="723"><CoreSc1 advantage="None" conceptID="Res410" novelty="None" type="Res"/><text>The lattice of divisorial fractional H-ideals is then modular, even distributive [51, Theorem 2.1.3(a)], and hence by the previous theorem an arithmetical groupoid.</text></s>
Definition 5.18
<s sid="724"><CoreSc1 advantage="None" conceptID="Con9" novelty="None" type="Con"/><text>We call a maximal order H satisfying A1-A3 an arithmetical maximal order.</text></s>
<s sid="725"><CoreSc1 advantage="None" conceptID="Con10" novelty="None" type="Con"/><text>If α is its equivalence class of arithmetical maximal orders, then we denote by Mv(α)⊂Iv(α) the (quiver of) maximal integral elements.</text></s>
<s sid="726"><CoreSc1 advantage="None" conceptID="Con11" novelty="None" type="Con"/><text>Let from here on H be an arithmetical maximal order in Q, and let α be its equivalence class of arithmetical maximal orders.</text></s>
<s sid="727"><CoreSc1 advantage="None" conceptID="Res411" novelty="None" type="Res"/><text>By Lemma 5.9.2, every principal left ideal Ha with a∈H• is a divisorial left H-ideal with inverse a-1H∈Fv(α).</text></s>
LetH(α)={H′a∈Iv(α)|H′∈α,a∈H′•}.
<s sid="728"><CoreSc1 advantage="None" conceptID="Res412" novelty="None" type="Res"/><text>The v-product coincides with the usual proper product on H(α).</text></s>
<s sid="729"><CoreSc1 advantage="None" conceptID="Res413" novelty="None" type="Res"/><text>Thus (H(α),⋅)⊂(Iv(α),⋅v) is a wide subcategory, with the product IJ=I⋅J=I⋅vJ for I,J∈H(α) defined whenever Or(I)=Ol(J), and then Ol(IJ)=Ol(I) and Or(IJ)=Or(J).</text></s>
<s sid="730"><CoreSc1 advantage="None" conceptID="Res414" novelty="None" type="Res"/><text>The inclusion (H(α),⋅)⊂(Iv(α),⋅v) is left- and right-saturated.</text></s>
<s sid="731"><CoreSc1 advantage="None" conceptID="Res415" novelty="None" type="Res"/><text>By HH(α) (or shorter, HH, since H determines α) we denote the subcategory of H(α) where the left and right orders of every element are not only equivalent but in fact conjugate to H.</text></s>
Explicitly,HH=HH(α)={d(Ha)d-1∈Iv(α)|a∈H•,d∈Q•}.
<s sid="732"><CoreSc1 advantage="None" conceptID="Res416" novelty="None" type="Res"/><text>If H′∈α, then HH=HH′ if and only if H′ and H are conjugate.</text></s>
<s sid="733"><CoreSc1 advantage="None" conceptID="Res417" novelty="None" type="Res"/><text>Again the inclusion (HH,⋅)⊂(H(α),⋅) is left- and right-saturated, and thus so is the inclusion (HH,⋅)⊂(Iv(α),⋅v).</text></s>
<s sid="734"><CoreSc1 advantage="None" conceptID="Res418" novelty="None" type="Res"/><text>The following simple lemma gives a correspondence between H and HH.</text></s>
Lemma 5.19
Let d∈Q•.1.
<s sid="735"><CoreSc1 advantage="None" conceptID="Res419" novelty="None" type="Res"/><text>If a,a1,a2∈H• with a=a1a2, then d-1(Ha)d=d-1(Ha2)d⋅d-1a2-1(Ha1)a2d∈HH with d-1(Ha2)d,d-1a2-1(Ha1)a2d∈HH.</text></s>
2.
<s sid="736"><CoreSc1 advantage="None" conceptID="Res420" novelty="None" type="Res"/><text>If a∈H• and d-1(Ha)d=I2⋅I1 with I1,I2∈HH, then there exist a1,a2∈H• with I2=d-1(Ha2)d, I1=d-1a2-1(Ha1)a2d and a=a1a2.</text></s>
3.
<s sid="737"><CoreSc1 advantage="None" conceptID="Res421" novelty="None" type="Res"/><text>If a1,a2,b1,b2∈H• with Ha2=Hb2 and a2-1(Ha1)a2=b2-1(Hb1)b2, then there exist ε1,ε2∈H× with b1=ε1a1ε2-1 and b2=ε2a2.</text></s>
<s sid="738"><CoreSc1 advantage="None" conceptID="Res422" novelty="None" type="Res"/><text>In particular, for a∈H• we have a∈A(H•) if and only if d-1(Ha)d∈A(HH).</text></s>
Proof
<s sid="739"><CoreSc1 advantage="None" conceptID="Res423" novelty="None" type="Res"/><text>1. The multiplication is defined because Or(d-1(Ha2)d)=d-1a2-1Ha2d=Ol(d-1a2-1(Ha1)a2d).</text></s>
<s sid="740"><CoreSc1 advantage="None" conceptID="Res424" novelty="None" type="Res"/><text>The remaining statements are then clear.</text></s>
<s sid="741"><CoreSc1 advantage="None" conceptID="Res425" novelty="None" type="Res"/><text>2. Since Ol(I2)=d-1Hd we have I2=d-1Hda2′ with a2′∈(d-1Hd)•, and hence, with a2=da2′d-1∈H•, I2=d-1(Ha2)d.</text></s>
<s sid="742"><CoreSc1 advantage="None" conceptID="Res426" novelty="None" type="Res"/><text>Then Ol(I1)=Or(I2)=d-1a2-1Ha2d, and therefore similarly I1=d-1a2-1(Ha1′)a2d with a1′∈H•.</text></s>
<s sid="743"><CoreSc1 advantage="None" conceptID="Res427" novelty="None" type="Res"/><text>Hence d-1(Ha)d=d-1(Ha1′a2)d, and thus a=εa1′a2 with ε∈H×.</text></s>
<s sid="744"><CoreSc1 advantage="None" conceptID="Res428" novelty="None" type="Res"/><text>Taking a1=εa1′ the claim follows.</text></s>
<s sid="745"><CoreSc1 advantage="None" conceptID="Res429" novelty="None" type="Res"/><text>3. Since Ha2=Hb2, there exists an ε2∈H× with b2=ε2a2.</text></s>
<s sid="746"><CoreSc1 advantage="None" conceptID="Res430" novelty="None" type="Res"/><text>Thena2-1(Ha1)a2=b2-1(Hb1)b2=a2-1ε2-1(Hb1)ε2a2=a2-1(Hb1ε2)a2, and thus there exists ε1∈H× with ε1a1=b1ε2, i.e., b1=ε1a1ε2-1. □</text></s>
<s sid="747"><CoreSc1 advantage="None" conceptID="Res431" novelty="None" type="Res"/><text>Observe that we may view a rigid factorization Ha2⁎a2-1(Ha1)a2∈Z⁎(HH) as a multiplicative way of writing the chain H⊃Ha2⊃Ha1a2.</text></s>
Proposition 5.20
Let a∈H•.
<s sid="748"><CoreSc1 advantage="None" conceptID="Res432" novelty="None" type="Res"/><text>For every d∈Q• there is a bijection ZH⁎(a)→ZHH⁎(d-1(Ha)d), given byu1⁎u2⁎⋯⁎uk↦d-1(Huk)d⁎(d-1uk-1(Huk-1)ukd)⁎⋯⁎(d-1uk-1⋅⋯⋅u2-1(Hu1)u2⋅⋯⋅ukd).</text></s>
<s sid="749"><CoreSc1 advantage="None" conceptID="Res433" novelty="None" type="Res"/><text>If θ¯:HH→B is a transfer homomorphism to a reduced cancellative small category B and having the additional property that θ¯(d-1(Ha)d)=θ¯(Ha) for all a∈H• and d∈Q•, then it induces a transfer homomorphism θ:H•→Bop given by θ(a)=θ¯(Ha).</text></s>
Proof
<s sid="750"><CoreSc1 advantage="None" conceptID="Res434" novelty="None" type="Res"/><text>The claimed bijection follows by iterating the previous lemma.</text></s>
<s sid="751"><CoreSc1 advantage="None" conceptID="Res435" novelty="None" type="Res"/><text>We need to verify that θ is a transfer homomorphism and first check that θ is a homomorphism: For a,b∈H•θ(ab)=θ¯(Hab)=θ¯(Hb⋅b-1(Ha)b)=θ¯(Hb)⋅θ¯(b-1(Ha)b)=θ¯(Hb)⋅θ¯(Ha)=θ(a)⋅opθ(b), and if a∈H× then Ha=H, whence θ(a)=θ¯(H)∈B0.</text></s>
<s sid="752"><CoreSc1 advantage="None" conceptID="Res436" novelty="None" type="Res"/><text>We verify T1: Let b∈B.</text></s>
<s sid="753"><CoreSc1 advantage="None" conceptID="Res437" novelty="None" type="Res"/><text>Then there exist d∈Q• and a∈H• with θ¯(d-1(Ha)d)=b, hence θ(a)=b.</text></s>
<s sid="754"><CoreSc1 advantage="None" conceptID="Res438" novelty="None" type="Res"/><text>If a∈H• with θ(a)∈B0, then θ¯(Ha)∈B0, hence Ha∈(HH)0, i.e., Ha=H and a∈H×.</text></s>
<s sid="755"><CoreSc1 advantage="None" conceptID="Res439" novelty="None" type="Res"/><text>It remains to check T2: Let a∈H• and b1,b2∈B with θ(a)=b1⋅opb2.</text></s>
<s sid="756"><CoreSc1 advantage="None" conceptID="Res440" novelty="None" type="Res"/><text>Then θ¯(Ha)=b2b1, hence there exist a1,a2∈H• with Ha=Ha2⋅a2-1(Ha1)a2 and θ¯(Ha2)=b2, θ¯(a2-1(Ha1)a2)=b1.</text></s>
<s sid="757"><CoreSc1 advantage="None" conceptID="Res441" novelty="None" type="Res"/><text>This implies a=εa1a2 with ε∈H×, and θ(εa1)=b1, θ(a2)=b2. □</text></s>
Remark 5.21
<s sid="758"><CoreSc1 advantage="None" conceptID="Res442" novelty="None" type="Res"/><text>The condition θ¯(d-1(Ha)d)=θ¯(Ha) implies in particular |θ¯(HH)0|=1.</text></s>
<s sid="759"><CoreSc1 advantage="None" conceptID="Res443" novelty="None" type="Res"/><text>Thus in fact B is necessarily a semigroup.</text></s>
<s sid="760"><CoreSc1 advantage="None" conceptID="Res444" novelty="None" type="Res"/><text>Let G be the universal vertex group of Fv(α), and let η:Fv(α)→G be the abstract norm, as defined in the previous section.</text></s>
Lemma 5.22
1.
<s sid="761"><CoreSc1 advantage="None" conceptID="Res445" novelty="None" type="Res"/><text>If I∈Fv(α) and d∈Q•, then η(d-1Id)=η(I).</text></s>
2.
q(η(HH))=q({η(Ha)|a∈H•})={η(Hq)|q∈Q•}.
Proof
<s sid="762"><CoreSc1 advantage="None" conceptID="Res446" novelty="None" type="Res"/><text>1. It suffices to verify the claim for maximal integral I∈Iv(α).</text></s>
<s sid="763"><CoreSc1 advantage="None" conceptID="Res447" novelty="None" type="Res"/><text>If P∈Iv(α) is the maximal divisorial two-sided Ol(I)-ideal contained in I, then d-1Pd is the maximal divisorial two-sided ideal contained in d-1Id, and since d-1Pd=(Ol(d-1Id)d-1Ol(I))⋅vP⋅v(Ol(I)dOl(d-1Id)) we have η(I)=(P)=(d-1Pd)=η(d-1Id)∈G.</text></s>
<s sid="764"><CoreSc1 advantage="None" conceptID="Res448" novelty="None" type="Res"/><text>2. The first equality is immediate from 1.</text></s>
<s sid="765"><CoreSc1 advantage="None" conceptID="Res449" novelty="None" type="Res"/><text>For the second equality, note that if q=ab-1 with a,b∈H•, then (using 1 multiple times and the fact that η is a homomorphism)η(Hq)=η(Hab-1)=η(Hb-1⋅b(Ha)b-1)=η(Hb-1)η(b(Ha)b-1)=η(bH)-1η(Ha)=η(b-1(bH)b)-1η(Ha)=η(Ha)η(Hb)-1.□</text></s>
<s sid="766"><CoreSc1 advantage="None" conceptID="Res450" novelty="None" type="Res"/><text>Applying Theorem 4.15 to the present situation, we obtain a transfer homomorphism HH→B(CM) if we impose some additional crucial conditions on H.</text></s>
Theorem 5.23
<s sid="767"><CoreSc1 advantage="None" conceptID="Con12" novelty="None" type="Con"/><text>Let Q be a quotient semigroup, H an arithmetical maximal order in Q, and α its equivalence class of arithmetical maximal orders.1.</text></s>
<s sid="768"><CoreSc1 advantage="None" conceptID="Res451" novelty="None" type="Res"/><text>For all a∈H•, LH•(a) is finite and non-empty.</text></s>
<s sid="769"><CoreSc1 advantage="None" conceptID="Res452" novelty="None" type="Res"/><text>If, for every maximal divisorial H-ideal P, the number of maximal divisorial left H-ideals I with P⊂I is finite, then ZH•⁎(a) is finite for all a∈H•.</text></s>
2.
<s sid="770"><CoreSc1 advantage="None" conceptID="Res453" novelty="None" type="Res"/><text>Let PH•={η(Hq)|q∈Q•}⊂G, C=G/PH•, and CM={[η(I)]∈C|I∈Iv(α) maximal integral}. Assume:(i)</text></s>
<s sid="771"><CoreSc1 advantage="None" conceptID="Res454" novelty="None" type="Res"/><text>A divisorial fractional left H-ideal I is principal if and only if η(I)∈PH•.</text></s>
(ii)
<s sid="772"><CoreSc1 advantage="None" conceptID="Res455" novelty="None" type="Res"/><text>For all H′∈α and all g∈CM there exists a maximal divisorial left H′-ideal with [η(I)]=g.</text></s>
<s sid="773"><CoreSc1 advantage="None" conceptID="Res456" novelty="None" type="Res"/><text>Then there exists a transfer homomorphism θ:H•→B(CM).</text></s>
Proof
<s sid="774"><CoreSc1 advantage="None" conceptID="Res457" novelty="None" type="Res"/><text>By Proposition 5.16, (Fv(α),⋅v,⊂) is an arithmetical groupoid, and Iv(α) is its subcategory of integral elements.</text></s>
<s sid="775"><CoreSc1 advantage="None" conceptID="Res458" novelty="None" type="Res"/><text>(HH,⋅) is a left- and right-saturated subcategory of (Iv,⋅v).</text></s>
<s sid="776"><CoreSc1 advantage="None" conceptID="Res459" novelty="None" type="Res"/><text>1. This follows immediately from Corollary 4.13 and Proposition 5.20.</text></s>
<s sid="777"><CoreSc1 advantage="None" conceptID="Res460" novelty="None" type="Res"/><text>2. Let I be a fractional left H′-ideal with H′=dHd-1.</text></s>
<s sid="778"><CoreSc1 advantage="None" conceptID="Res461" novelty="None" type="Res"/><text>Then I is principal if and only if the fractional left H-ideal d-1Id is, and this is the case if and only if η(I)=η(d-1Id)∈PH•=q(η(HH)) (where the last equality is due to the previous lemma).</text></s>
<s sid="779"><CoreSc1 advantage="None" conceptID="Res462" novelty="None" type="Res"/><text>Therefore the first condition of Theorem 4.15 is satisfied.</text></s>
<s sid="780"><CoreSc1 advantage="None" conceptID="Res463" novelty="None" type="Res"/><text>Condition (ii) of the present theorem is equivalent to the second condition of Theorem 4.15.</text></s>
<s sid="781"><CoreSc1 advantage="None" conceptID="Res464" novelty="None" type="Res"/><text>Thus there exists a transfer homomorphism θ¯:HH→B(CM) as in Theorem 4.15.</text></s>
<s sid="782"><CoreSc1 advantage="None" conceptID="Res465" novelty="None" type="Res"/><text>By Proposition 5.20, there exists a transfer homomorphism θ:H•→B(CM). □</text></s>
Remark 5.24
1.
<s sid="783"><CoreSc1 advantage="None" conceptID="Res466" novelty="None" type="Res"/><text>We continue our discussion from Remark 5.17.</text></s>
<s sid="784"><CoreSc1 advantage="None" conceptID="Res467" novelty="None" type="Res"/><text>Let H be a normalizing Krull monoid.</text></s>
<s sid="785"><CoreSc1 advantage="None" conceptID="Res468" novelty="None" type="Res"/><text>Then α={H}, Ha=HaH=aH for all a∈Q• and associativity is a congruence relation [25, Lemma 4.4.1], thus Hred={H×a|a∈H} with the induced operation is also a monoid.</text></s>
<s sid="786"><CoreSc1 advantage="None" conceptID="Con13" novelty="None" type="Con"/><text>Therefore H=HH={HaH|a∈H}≅Hred and G=Fv(α) is the free abelian group on the maximal divisorial (two-sided) H-ideals, while Iv(α) is the free abelian monoid on the same basis.</text></s>
<s sid="787"><CoreSc1 advantage="None" conceptID="Con14" novelty="None" type="Con"/><text>In the previous theorem we therefore have G=G, η=id, PH•={Hq|q∈Q•}, and hence C is the divisorial class group of H, and CM is the set of divisorial ideal classes that contain a maximal divisorial H-ideal.</text></s>
<s sid="788"><CoreSc1 advantage="None" conceptID="Con15" novelty="None" type="Con"/><text>The second condition of the theorem is trivially true by virtue of |G0|=1 and the definition of CM, and the first condition is trivially true because η=id.</text></s>
<s sid="789"><CoreSc1 advantage="None" conceptID="Res469" novelty="None" type="Res"/><text>We thus get a transfer homomorphism H→B(CM) (induced from the transfer homomorphism Hred≅HH→B(CM)), which is the same one as in [25, Theorem 6.5].</text></s>
2.
<s sid="790"><CoreSc1 advantage="None" conceptID="Res470" novelty="None" type="Res"/><text>If H is a maximal order satisfying only A1 and A3, then LH•(a) is finite and non-empty for all a∈H•.</text></s>
<s sid="791"><CoreSc1 advantage="None" conceptID="Res471" novelty="None" type="Res"/><text>In Section 4 one may drop P5 and P6, and still obtain Proposition 4.12.1 in the weaker form that, for each a∈G+, either ZG+⁎(a)=∅ or |LG+(a)|=1 (and of course without any statement about Φ, which can only be defined in the presence of P5).</text></s>
<s sid="792"><CoreSc1 advantage="None" conceptID="Res472" novelty="None" type="Res"/><text>This is possible because P6 is only used to show existence of a rigid factorization of a.</text></s>
<s sid="793"><CoreSc1 advantage="None" conceptID="Res473" novelty="None" type="Res"/><text>A sufficient condition for ZG+⁎(a)≠∅ is that G+(s(a),⋅) and G+(⋅,t(a)) satisfy the ACC.</text></s>
<s sid="794"><CoreSc1 advantage="None" conceptID="Res474" novelty="None" type="Res"/><text>If H satisfies A1, then G+(e,⋅) and G+(⋅,e) with e∈(HH)0 (corresponding to conjugate orders of H) satisfy the ACC, and as in Corollary 4.13 one shows that LHH(a) is finite and non-empty for all a∈HH.</text></s>
<s sid="795"><CoreSc1 advantage="None" conceptID="Res475" novelty="None" type="Res"/><text>Hence the same is true for H•.</text></s>
Rings
<s sid="796"><CoreSc1 advantage="None" conceptID="Con16" novelty="None" type="Con"/><text>Suppose that Q=(Q,+,⋅) is a quotient ring in the sense of [42, Chapter 3] (but recall that we in addition require it to be unital, as we do for all rings).</text></s>
<s sid="797"><CoreSc1 advantage="None" conceptID="Res476" novelty="None" type="Res"/><text>Then (Q,⋅) is a quotient semigroup.</text></s>
<s sid="798"><CoreSc1 advantage="None" conceptID="Res477" novelty="None" type="Res"/><text>In the remainder of this section we show that the ring-theoretic divisorial one-sided ideal theory for maximal orders in (Q,+,⋅) coincides with the semigroup-theoretic one.33</text></s>
<s sid="799"><CoreSc1 advantage="None" conceptID="Res478" novelty="None" type="Res"/><text>In [42, Chapter 5] the terminology &quot;reflexive&quot; is used in place of &quot;divisorial&quot;.</text></s>
<s sid="800"><CoreSc1 advantage="None" conceptID="Obs78" novelty="None" type="Obs"/><text>If R is a ring-theoretic order in Q, then a fractional left R-ideal I in the semigroup-theoretic sense is a fractional left R-ideal in the ring-theoretic sense if and only if I-I⊂I (see [42, §3.1.11] for the usual definition).</text></s>
<s sid="801"><CoreSc1 advantage="None" conceptID="Res479" novelty="None" type="Res"/><text>Let for the remainder of this subsection Q=(Q,+,⋅) be a quotient ring.</text></s>
Lemma 5.25
<s sid="802"><CoreSc1 advantage="None" conceptID="Res480" novelty="None" type="Res"/><text>Let H be an order in the multiplicative semigroup (Q,⋅) and I a fractional left H-ideal (in the semigroup-theoretic sense).</text></s>
Consider the following statements:(a)
I-I⊂I.
(b)
<s sid="803"><CoreSc1 advantage="None" conceptID="Res481" novelty="None" type="Res"/><text>Ol(I) is a subring of Q.</text></s>
(c)
<s sid="804"><CoreSc1 advantage="None" conceptID="Res482" novelty="None" type="Res"/><text>Or(I) is a subring of Q.</text></s>
<s sid="805"><CoreSc1 advantage="None" conceptID="Res483" novelty="None" type="Res"/><text>Then (a) ⇒ (b) and (a) ⇒ (c).</text></s>
<s sid="806"><CoreSc1 advantage="None" conceptID="Res484" novelty="None" type="Res"/><text>If H is a maximal order and I is divisorial, then (a) ⇔ (b) ⇔ (c).</text></s>
Proof
Assume that (a) holds.
<s sid="807"><CoreSc1 advantage="None" conceptID="Res485" novelty="None" type="Res"/><text>We show (b): Let a,b∈Ol(I).</text></s>
<s sid="808"><CoreSc1 advantage="None" conceptID="Res486" novelty="None" type="Res"/><text>Then aI⊂I and bI⊂I and hence (a-b)I⊂aI-bI⊂I-I⊂I, thus a-b∈Ol(I).</text></s>
<s sid="809"><CoreSc1 advantage="None" conceptID="Res487" novelty="None" type="Res"/><text>Assume now that H is maximal, I=Iv and (b) holds.</text></s>
We show (a).
Let a,b∈I=Iv=(I-1)-1.
<s sid="810"><CoreSc1 advantage="None" conceptID="Res488" novelty="None" type="Res"/><text>Then aI-1⊂Ol(I), and bI-1⊂Ol(I), whence (a-b)I-1⊂aI-1-bI-1⊂Ol(I)-Ol(I)=Ol(I) and thus a-b∈(I-1)-1=I. □</text></s>
Lemma 5.26
<s sid="811"><CoreSc1 advantage="None" conceptID="Con17" novelty="None" type="Con"/><text>A ring-theoretic order R in Q is maximal in the ring-theoretic sense if and only if it is maximal in the semigroup-theoretic sense.</text></s>
Proof
<s sid="812"><CoreSc1 advantage="None" conceptID="Con18" novelty="None" type="Con"/><text>We show that if R is maximal in the ring-theoretic sense, then it is maximal in the semigroup-theoretic sense, as the other direction is trivial.</text></s>
<s sid="813"><CoreSc1 advantage="None" conceptID="Res489" novelty="None" type="Res"/><text>Let I be a fractional left R-ideal in the semigroup-theoretic sense.</text></s>
<s sid="814"><CoreSc1 advantage="None" conceptID="Res490" novelty="None" type="Res"/><text>Then 〈RI〉 is a fractional left R-ideal in the ring-theoretic sense, and using R⊂Ol(I), it follows that Ol(I)⊂Ol(〈I〉R).</text></s>
<s sid="815"><CoreSc1 advantage="None" conceptID="Res491" novelty="None" type="Res"/><text>Maximality of R in the ring-theoretic sense implies R=Ol(〈I〉R), hence also R=Ol(I).</text></s>
<s sid="816"><CoreSc1 advantage="None" conceptID="Res492" novelty="None" type="Res"/><text>Similarly, if J is a fractional right R-ideal in the ring-theoretic sense then Or(J)=R.</text></s>
<s sid="817"><CoreSc1 advantage="None" conceptID="Res493" novelty="None" type="Res"/><text>Therefore Lemma 5.8 implies that R is maximal in the semigroup-theoretic sense. □</text></s>
<s sid="818"><CoreSc1 advantage="None" conceptID="Con19" novelty="None" type="Con"/><text>As before let α be an equivalence class of maximal orders of (Q,⋅) in the semigroup-theoretic sense.</text></s>
Lemma 5.27
<s sid="819"><CoreSc1 advantage="None" conceptID="Con20" novelty="None" type="Con"/><text>Let H∈α and assume that H is a subring of Q (i.e., an order in Q in the ring-theoretic sense).1.</text></s>
<s sid="820"><CoreSc1 advantage="None" conceptID="Con21" novelty="None" type="Con"/><text>Every H′∈α is a subring of Q (and therefore an order in Q in the ring-theoretic sense).</text></s>
2.
<s sid="821"><CoreSc1 advantage="None" conceptID="Con22" novelty="None" type="Con"/><text>If I is a divisorial fractional left H-ideal and J is a divisorial fractional left Or(I)-ideal, then{ab|a∈I,b∈J}v=(〈{ab|a∈I,b∈J}〉H)v, i.e., the semigroup-theoretic v-product coincides with the ring-theoretic one.</text></s>
3.
<s sid="822"><CoreSc1 advantage="None" conceptID="Con23" novelty="None" type="Con"/><text>If I and J are divisorial fractional left H-ideals, then (I∪J)v=(I+J)v.</text></s>
Proof
<s sid="823"><CoreSc1 advantage="None" conceptID="Con24" novelty="None" type="Con"/><text>1. By Lemma 5.7.3 there exists a fractional (H,H′)-ideal I.</text></s>
<s sid="824"><CoreSc1 advantage="None" conceptID="Res494" novelty="None" type="Res"/><text>By maximality of H and H′, also Ol(Iv)=H and Or(Iv)=H′ and the claim follows from Lemma 5.25 applied to Iv.</text></s>
<s sid="825"><CoreSc1 advantage="None" conceptID="Res495" novelty="None" type="Res"/><text>2. Write I⋅SJ={ab|a∈I,b∈J} for the semigroup-theoretic ideal product and I⋅RJ=〈{ab|a∈I,b∈J}〉H for the ring-theoretic one.</text></s>
<s sid="826"><CoreSc1 advantage="None" conceptID="Res496" novelty="None" type="Res"/><text>Then I⋅SJ⊂I⋅RJ, and both of these sets are fractional left H-ideals (in the semigroup-theoretic sense).</text></s>
Therefore (I⋅SJ)v⊂(I⋅RJ)v.
<s sid="827"><CoreSc1 advantage="None" conceptID="Res497" novelty="None" type="Res"/><text>For the converse inclusion, it suffices to show I⋅RJ⊂(I⋅SJ)v, but this is true because by Lemma 5.25 (I⋅SJ)v is additively closed.</text></s>
<s sid="828"><CoreSc1 advantage="None" conceptID="Res498" novelty="None" type="Res"/><text>3. Clearly I∪J⊂I+J and both sets are fractional left H-ideals (for I+J proceed as in the proof of Lemma 5.6.4; in particular observe (H:rI∪J)⊂(H:rI+J)).</text></s>
<s sid="829"><CoreSc1 advantage="None" conceptID="Con25" novelty="None" type="Con"/><text>As before it therefore suffices to show I+J⊂(I∪J)v.</text></s>
<s sid="830"><CoreSc1 advantage="None" conceptID="Con26" novelty="None" type="Con"/><text>This again holds due to Lemma 5.25. □</text></s>
<s sid="831"><CoreSc1 advantage="None" conceptID="Con27" novelty="None" type="Con"/><text>Altogether, if R is a maximal order in Q in the ring-theoretic sense, then it does not matter whether we form Fv(α) by using the ring-theoretic or the semigroup-theoretic notions.</text></s>
<s sid="832"><CoreSc1 advantage="None" conceptID="Res499" novelty="None" type="Res"/><text>We use the same notion of boundedness for ring-theoretic orders as in Definition &amp; Lemma 5.14; for semiprime Goldie rings this coincides with the notion in [42].</text></s>
Theorem 5.28
<s sid="833"><CoreSc1 advantage="None" conceptID="Con28" novelty="None" type="Con"/><text>Let R be a maximal order in a quotient ring Q, α its equivalence class of maximal orders in the semigroup-theoretic sense, and β its equivalence class of maximal orders in the ring-theoretic sense.</text></s>
<s sid="834"><CoreSc1 advantage="None" conceptID="Res500" novelty="None" type="Res"/><text>Then α=β and Fv(α)=Fv(β), where the latter is the ring-theoretic analogue of Fv(α).</text></s>
<s sid="835"><CoreSc1 advantage="None" conceptID="Res501" novelty="None" type="Res"/><text>If R is bounded, satisfies the ACC on divisorial left R-ideals and on divisorial right R-ideals, and the lattice of divisorial fractional left (right) R-modules is modular, then (R,⋅) is an arithmetical maximal order in (Q,⋅) in the semigroup-theoretic sense.</text></s>
<s sid="836"><CoreSc1 advantage="None" conceptID="Res502" novelty="None" type="Res"/><text>In particular, the conclusions of Theorem 5.23 hold for R.</text></s>
Proof
<s sid="837"><CoreSc1 advantage="None" conceptID="Res503" novelty="None" type="Res"/><text>By Lemma 5.27.1, α=β, and by Lemma 5.25, Fv(α)=Fv(β) as sets.</text></s>
<s sid="838"><CoreSc1 advantage="None" conceptID="Res504" novelty="None" type="Res"/><text>By Lemma 5.27, the v-product, meet and join coincide, and hence Fv(α)=Fv(β) as lattice-ordered groupoids.</text></s>
<s sid="839"><CoreSc1 advantage="None" conceptID="Res505" novelty="None" type="Res"/><text>The remaining claims follow from this. □</text></s>
<s sid="840"><CoreSc1 advantage="None" conceptID="Res506" novelty="None" type="Res"/><text>In [46, §5(d)], Rehm gives examples for bounded maximal orders E, that are prime and satisfy the ACC on divisorial two-sided E-ideals, but do not satisfy the ACC on divisorial left E-ideals or the ACC on divisorial right E-ideals.</text></s>
<s sid="841"><CoreSc1 advantage="None" conceptID="Res507" novelty="None" type="Res"/><text>In fact (unless one takes the special case where E itself is a quotient ring), the orders E are not even atomic.</text></s>
<s sid="842"><CoreSc1 advantage="None" conceptID="Res508" novelty="None" type="Res"/><text>However, these orders are not Goldie, as they are not of finite left or right uniform dimension, and do not satisfy the ACC on left or right annihilator ideals.</text></s>
<s sid="843"><CoreSc1 advantage="None" conceptID="Res509" novelty="None" type="Res"/><text>Before going to maximal orders in central simple algebras, we discuss principal ideal rings.</text></s>
Example 5.29
Principal ideal rings
<s sid="844"><CoreSc1 advantage="None" conceptID="Res510" novelty="None" type="Res"/><text>Let R be a bounded order in a quotient ring Q.</text></s>
<s sid="845"><CoreSc1 advantage="None" conceptID="Res511" novelty="None" type="Res"/><text>Assume that every left R-ideal and every right R-ideal is principal.</text></s>
<s sid="846"><CoreSc1 advantage="None" conceptID="Res512" novelty="None" type="Res"/><text>By the characterization in Lemma 5.8, R is then already a maximal order, and it satisfies A1-A3.</text></s>
<s sid="847"><CoreSc1 advantage="None" conceptID="Res513" novelty="None" type="Res"/><text>Thus HR=Iv(α), and facts about the rigid factorizations in Iv(α) trivially descend to facts about rigid factorizations of R•.</text></s>
<s sid="848"><CoreSc1 advantage="None" conceptID="Res514" novelty="None" type="Res"/><text>Examples we have in mind include bounded skew polynomial rings D[X,σ], where D is a division ring and σ:D→D is an automorphism, and the Hurwitz quaternions Z[1,i,j,1+i+j+ij2] with i2=-1, j2=-1 and ij=-ji.</text></s>
<s sid="849"><CoreSc1 advantage="None" conceptID="Res515" novelty="None" type="Res"/><text>Both of these examples are left- and right-euclidean domains, and hence principal ideal rings.</text></s>
<s sid="850"><CoreSc1 advantage="None" conceptID="Res516" novelty="None" type="Res"/><text>In this way we can for example rediscover Theorem 2 in [16, §5].</text></s>
<s sid="851"><CoreSc1 advantage="None" conceptID="Res517" novelty="None" type="Res"/><text>Let Q be a quaternion algebra over a field K with char(K)≠2, and a∈Q•∖K×.</text></s>
Then nr(a)=aa¯∈K× and tr(a)=a+a¯∈K.
<s sid="852"><CoreSc1 advantage="None" conceptID="Res518" novelty="None" type="Res"/><text>For the polynomial ring Q[X] in the central variable X, thereforef=X2-tr(a)X+nr(a)=(X-cac-1)(X-ca¯c-1)for all c∈Q•, and thus |ZQ[X]⁎(f)|=∞ if K is infinite.</text></s>
<s sid="853"><CoreSc1 advantage="None" conceptID="Res519" novelty="None" type="Res"/><text>(But these rigid factorizations are usually considered to be identical factorizations, and Q[X], being left- and right-euclidean, is even a UFD with suitable definitions, see for example [8, Chapter 3.2] and [14, Chapter 3].) In terms of ideal theory, every element X-cac-1 with c∈Q• generates a maximal left Q[X]-ideal lying above the maximal two-sided Q[X]-ideal Q[X]f.</text></s>
<s sid="854"><CoreSc1 advantage="None" conceptID="Obs79" novelty="None" type="Obs"/><text>If also d∈Q•, then Q[X](X-cac-1)=Q[X](X-dad-1) if and only if cac-1=dad-1, i.e., d-1c∈K(a).</text></s>
<s sid="855"><CoreSc1 advantage="None" conceptID="Res520" novelty="None" type="Res"/><text>Classical maximal orders over Dedekind domains in CSAs</text></s>
<s sid="856"><CoreSc1 advantage="None" conceptID="Res521" novelty="None" type="Res"/><text>Let O be a commutative domain with quotient field K.</text></s>
<s sid="857"><CoreSc1 advantage="None" conceptID="Res522" novelty="None" type="Res"/><text>By a central simple algebra A over K, we mean a K-algebra with dimK(A)&lt;∞, which is simple as a ring, and has center K.</text></s>
<s sid="858"><CoreSc1 advantage="None" conceptID="Res523" novelty="None" type="Res"/><text>Then A is artinian because it is a finite-dimensional K-algebra, and hence it is a quotient ring (in an artinian ring, every non-zero-divisor is invertible [42, §3.1.1], hence it is a quotient ring and an element is left-cancellative if and only if it is right-cancellative if and only if it is cancellative).</text></s>
<s sid="859"><CoreSc1 advantage="None" conceptID="Res524" novelty="None" type="Res"/><text>By Posnerʼs Theorem [42, §13.6.6], a ring R is a prime PI ring if and only if it is an order in a central simple algebra, and hence in particular, prime PI rings are bounded Goldie rings.</text></s>
<s sid="860"><CoreSc1 advantage="None" conceptID="Res525" novelty="None" type="Res"/><text>Furthermore, PI Krull rings are characterized as those maximal orders in central simple algebras whose center is a commutative Krull domain [35, Theorem 2.4].</text></s>
<s sid="861"><CoreSc1 advantage="None" conceptID="Res526" novelty="None" type="Res"/><text>We start with a simple corollary of Theorem 5.28.</text></s>
Corollary 5.30
<s sid="862"><CoreSc1 advantage="None" conceptID="Res527" novelty="None" type="Res"/><text>If R is a PI Krull ring, then LR•(a) is finite and non-empty for all a∈R•.</text></s>
Proof
<s sid="863"><CoreSc1 advantage="None" conceptID="Res528" novelty="None" type="Res"/><text>We only have to verify the conditions of Theorem 5.28.</text></s>
<s sid="864"><CoreSc1 advantage="None" conceptID="Res529" novelty="None" type="Res"/><text>By [35, Theorem 2.4] the various notions of Krull rings coincide for prime PI rings.</text></s>
<s sid="865"><CoreSc1 advantage="None" conceptID="Res530" novelty="None" type="Res"/><text>Thus R is a bounded Chamarie-Krull ring.</text></s>
<s sid="866"><CoreSc1 advantage="None" conceptID="Res531" novelty="None" type="Res"/><text>The ACC on divisorial left R-ideals and divisorial right R-ideals follows from [11] (or [31, Corollary 3.11]).</text></s>
<s sid="867"><CoreSc1 advantage="None" conceptID="Obs80" novelty="None" type="Obs"/><text>Moreover, for every divisorial prime R-ideal P, the set of regular elements modulo P, denoted C(P), is cancellative, satisfies the left and right Ore condition, and for the localization RC(P)=RC(P)⊂Q every left (right) RC(P)-ideal is principal [11, Proposition 2.5].</text></s>
<s sid="868"><CoreSc1 advantage="None" conceptID="Obs81" novelty="None" type="Obs"/><text>The lattice of divisorial fractional left (right) RC(P)-ideals is hence modular.</text></s>
<s sid="869"><CoreSc1 advantage="None" conceptID="Obs82" novelty="None" type="Obs"/><text>Using the ACC on divisorial left and right R-ideals, one checks as in the commutative case that IvRC(P)=(IRC(P))v for a fractional right R-ideal I.</text></s>
<s sid="870"><CoreSc1 advantage="None" conceptID="Res532" novelty="None" type="Res"/><text>Suppose now I, J, K are divisorial fractional right R-ideals, and K⊂I.</text></s>
<s sid="871"><CoreSc1 advantage="None" conceptID="Res533" novelty="None" type="Res"/><text>We have to check I∩(J+K)v=((I∩J)+K)v.</text></s>
<s sid="872"><CoreSc1 advantage="None" conceptID="Res534" novelty="None" type="Res"/><text>But (I∩(J+K)v)RC(P)=IRC(P)∩(JRC(P)+KRC(P))v and ((I∩J)+K)vRC(P)=((IRC(P)∩JRC(P))+KRC(P))v, and thus, by modularity in the localizations, they are equal for every divisorial prime R-ideal P.</text></s>
<s sid="873"><CoreSc1 advantage="None" conceptID="Res535" novelty="None" type="Res"/><text>The claim now follows from [11, Lemme 2.7], by which the global divisorial fractional right R-ideals can be recovered as intersections from the local ones. □</text></s>
<s sid="874"><CoreSc1 advantage="None" conceptID="Obj70" novelty="None" type="Obj"/><text>Using Remark 5.24.2, we get the above result even for more general classes of rings, namely for Dedekind prime rings and bounded Chamarie-Krull rings (cf. [11]).</text></s>
<s sid="875"><CoreSc1 advantage="None" conceptID="Goa6" novelty="None" type="Goa"/><text>But the aim of this subsection is to restrict to the situation where the base ring O is a Dedekind domain, as a preparation for the structural results on sets of lengths in the setting of holomorphy rings.</text></s>
<s sid="876"><CoreSc1 advantage="None" conceptID="Res536" novelty="None" type="Res"/><text>Suppose that O is a Dedekind domain.</text></s>
<s sid="877"><CoreSc1 advantage="None" conceptID="Res537" novelty="None" type="Res"/><text>A ring R is a classical O-order of A if O⊂R, R is finitely generated as O-module and KR=A.</text></s>
<s sid="878"><CoreSc1 advantage="None" conceptID="Con29" novelty="None" type="Con"/><text>R is a classical maximal O-order if it is maximal with respect to set inclusion within the set of all classical O-orders.</text></s>
<s sid="879"><CoreSc1 advantage="None" conceptID="Con30" novelty="None" type="Con"/><text>Such classical maximal O-orders as well as their ideal theory are well-studied, in particular Reinerʼs book [47] provides a thorough description of them.</text></s>
<s sid="880"><CoreSc1 advantage="None" conceptID="Con31" novelty="None" type="Con"/><text>If R is a classical O-order, then it is a ring-theoretic order in A in the sense we discussed, and it is a maximal order if and only if it is a classical maximal O-order (for this see [42, §5.3]).</text></s>
<s sid="881"><CoreSc1 advantage="None" conceptID="Con32" novelty="None" type="Con"/><text>The set of all classical maximal O-orders forms an equivalence class of (ring-theoretic) maximal orders, call it β for a moment.</text></s>
<s sid="882"><CoreSc1 advantage="None" conceptID="Obj71" novelty="None" type="Obj"/><text>If we write α for the same semigroup-theoretic equivalence class of maximal orders (i.e., α=β as sets, but we view the elements of β as rings and those of α just as semigroups), then Fv(α)=Fv(β) by Theorem 5.28.</text></s>
<s sid="883"><CoreSc1 advantage="None" conceptID="Obj72" novelty="None" type="Obj"/><text>Next, we recall that our notion of ideals coincides with that of [47] and [53] in the case of maximal orders, thereby seeing how the one-sided ideal theory of classical maximal O-orders is a special case of the semigroup-theoretic divisorial one-sided ideal theory developed in this section.</text></s>
<s sid="884"><CoreSc1 advantage="None" conceptID="Obj73" novelty="None" type="Obj"/><text>We also recognize the abstract norm homomorphism η of Section 4 as a generalization of the reduced norm of ideals (in the sense of [47, §24]).</text></s>
Lemma 5.31
<s sid="885"><CoreSc1 advantage="None" conceptID="Res538" novelty="None" type="Res"/><text>Let I⊂A and let T be a classical O-order in A.</text></s>
The following are equivalent:(a)
<s sid="886"><CoreSc1 advantage="None" conceptID="Res539" novelty="None" type="Res"/><text>I is a fractional left T-ideal in the ring-theoretic sense (i.e., as in [42, §3.1.11]).</text></s>
(b)
<s sid="887"><CoreSc1 advantage="None" conceptID="Res540" novelty="None" type="Res"/><text>I is a finitely generated O-module with KI=A and TI⊂I.44</text></s>
Here KI={λa|λ∈K,a∈I}={∑i=1nλiai|λi∈K,ai∈I}=K⊗OI.
<s sid="888"><CoreSc1 advantage="None" conceptID="Res541" novelty="None" type="Res"/><text>If T is maximal, then in addition the following statements are equivalent to the previous ones:(c)</text></s>
<s sid="889"><CoreSc1 advantage="None" conceptID="Res542" novelty="None" type="Res"/><text>I is a divisorial fractional left T-ideal in the semigroup-theoretic sense (Definitions 5.4 and 5.10).</text></s>
(d)
<s sid="890"><CoreSc1 advantage="None" conceptID="Res543" novelty="None" type="Res"/><text>I is a divisorial fractional left T-ideal in the ring-theoretic sense (i.e., a reflexive fractional left T-ideal as in [42, §5.1]).</text></s>
Proof
<s sid="891"><CoreSc1 advantage="None" conceptID="Res544" novelty="None" type="Res"/><text>(a) ⇒ (b): Recall that I is a fractional left T-ideal in the ring-theoretic sense if TI⊂I, I+I⊂I and there exist x,y∈A× with x∈I and Iy⊂T.</text></s>
<s sid="892"><CoreSc1 advantage="None" conceptID="Res545" novelty="None" type="Res"/><text>O is the center of T, and T is finitely generated over the noetherian ring O.</text></s>
<s sid="893"><CoreSc1 advantage="None" conceptID="Res546" novelty="None" type="Res"/><text>Since Iy⊂T, therefore also I is a finitely generated O-module.</text></s>
<s sid="894"><CoreSc1 advantage="None" conceptID="Res547" novelty="None" type="Res"/><text>Writing x-1=rc-1 with r∈T• and c∈O• we see that c=rx∈I∩O•.</text></s>
<s sid="895"><CoreSc1 advantage="None" conceptID="Res548" novelty="None" type="Res"/><text>If a∈A is arbitrary, then a=r′d-1 with r′∈T, d∈O• and therefore a=(r′c)(c-1d-1)∈KI.</text></s>
<s sid="896"><CoreSc1 advantage="None" conceptID="Res549" novelty="None" type="Res"/><text>(b) ⇒ (a): Certainly TI⊂I and I+I⊂I.</text></s>
<s sid="897"><CoreSc1 advantage="None" conceptID="Res550" novelty="None" type="Res"/><text>We have to find x,y∈A× with x∈I and Iy⊂T.</text></s>
<s sid="898"><CoreSc1 advantage="None" conceptID="Res551" novelty="None" type="Res"/><text>Since KI=A, there exist λ∈K× and x∈I∩A× with 1=λx (in fact even x∈K×).</text></s>
<s sid="899"><CoreSc1 advantage="None" conceptID="Res552" novelty="None" type="Res"/><text>If I=〈y1,…,yl〉O with y1,…,yl∈I, then due to KT=A there exists a common denominator y∈O• with yiy∈T, hence Iy⊂T.</text></s>
<s sid="900"><CoreSc1 advantage="None" conceptID="Res553" novelty="None" type="Res"/><text>Let now T be maximal.</text></s>
<s sid="901"><CoreSc1 advantage="None" conceptID="Res554" novelty="None" type="Res"/><text>(d) ⇒ (a) is trivial, and (a) ⇒ (d) follows because T is a Dedekind prime ring, and hence every fractional left T-ideal (in the ring-theoretic sense) is invertible (see [42, §5.2.14] or [47, §22, §23] for the more specific case where R is a maximal order in a CSA), and therefore divisorial.</text></s>
<s sid="902"><CoreSc1 advantage="None" conceptID="Res555" novelty="None" type="Res"/><text>(c) ⇔ (d) follows from Lemma 5.25. □</text></s>
<s sid="903"><CoreSc1 advantage="None" conceptID="Res556" novelty="None" type="Res"/><text>A subset I⊂A satisfying the second condition of the previous lemma and additionally Ol(I)=T is considered to be a left T-ideal in [47] and [53].</text></s>
<s sid="904"><CoreSc1 advantage="None" conceptID="Res557" novelty="None" type="Res"/><text>Thus, a left T-ideal in the sense of [47,53] is (in our terms) a fractional left T-ideal in the ring-theoretic sense with Ol(I)=T.</text></s>
<s sid="905"><CoreSc1 advantage="None" conceptID="Res558" novelty="None" type="Res"/><text>If T is maximal, then the extra condition Ol(I)=T is trivially satisfied, and the definitions are equivalent, but for a non-maximal order the definitions do not entirely agree (we will only need to work with ideals of maximal orders).</text></s>
<s sid="906"><CoreSc1 advantage="None" conceptID="Res559" novelty="None" type="Res"/><text>Since all I∈Fv(α) are invertible (i.e., II-1=Ol(I) and I-1I=Or(I) for the ring-theoretic products), the v-product coincides with the usual proper product of ideals: I⋅vJ=I⋅J whenever I,J∈Fv(α) with Or(I)=Ol(J).</text></s>
<s sid="907"><CoreSc1 advantage="None" conceptID="Res560" novelty="None" type="Res"/><text>Therefore, Fv(α) is the groupoid of all normal ideals of A in Reinerʼs terminology (O is fixed implicitly).</text></s>
<s sid="908"><CoreSc1 advantage="None" conceptID="Res561" novelty="None" type="Res"/><text>To be able to apply our abstract results we still have to check that A1 through A3 are true for α: A1 follows because every R∈α is noetherian, while A2 is true because every fractional left R-ideal with R∈α in fact even contains a non-zero element of the center (cf.</text></s>
[42, Prop.
<s sid="909"><CoreSc1 advantage="None" conceptID="Res562" novelty="None" type="Res"/><text>5.3.8(i) and (ii)] or see &quot;(b) ⇒ (a)&quot; of the last proof).</text></s>
<s sid="910"><CoreSc1 advantage="None" conceptID="Res563" novelty="None" type="Res"/><text>Since every fractional left (right) R-ideal is divisorial, A3 follows from the modularity of the lattice of left (right) R-modules.</text></s>
<s sid="911"><CoreSc1 advantage="None" conceptID="Res564" novelty="None" type="Res"/><text>Writing F×(O) for the non-zero fractional ideals of the commutative Dedekind domain O, and G for the universal vertex group of Fv(α), we have the following.</text></s>
Lemma 5.32
<s sid="912"><CoreSc1 advantage="None" conceptID="Res565" novelty="None" type="Res"/><text>If R,R′∈α and P∈G, then PR∩O=PR′∩O∈max(O) and there is a canonical bijection{P|P∈G maximal integral}→max(O), inducing an isomorphism of free abelian groups r:G→∼F×(O).</text></s>
<s sid="913"><CoreSc1 advantage="None" conceptID="Obs83" novelty="None" type="Obs"/><text>The inverse map is given by p↦(P) where P is the unique maximal (two-sided) R-ideal lying over p.</text></s>
<s sid="914"><CoreSc1 advantage="None" conceptID="Obs84" novelty="None" type="Obs"/><text>If R is unramified at p, then P=Rp.</text></s>
<s sid="915"><CoreSc1 advantage="None" conceptID="Res566" novelty="None" type="Res"/><text>If all residue fields of O are finite, and η:Fv(α)→G is the abstract norm homomorphism, then r∘η=nrA/K.</text></s>
Proof
<s sid="916"><CoreSc1 advantage="None" conceptID="Res567" novelty="None" type="Res"/><text>All but the last statement follow from [47, Theorem 22.4].</text></s>
<s sid="917"><CoreSc1 advantage="None" conceptID="Res568" novelty="None" type="Res"/><text>Since r∘η and nrA/K are both homomorphisms Fv(α)→F×(O), it suffices to verify equality for M a maximal integral left R′-ideal with R′∈α, where it holds due to [47, Theorem 24.13]. □</text></s>
Proof of Theorem 1.1
<s sid="918"><CoreSc1 advantage="None" conceptID="Res569" novelty="None" type="Res"/><text>Throughout this section, let K be a global field and O be a holomorphy ring in K.55</text></s>
<s sid="919"><CoreSc1 advantage="None" conceptID="Res570" novelty="None" type="Res"/><text>For us, O is a holomorphy ring if it is an intersection of all but finitely many of the valuation domains associated to valuations of K.</text></s>
<s sid="920"><CoreSc1 advantage="None" conceptID="Res571" novelty="None" type="Res"/><text>Furthermore, let A be a central simple algebra over K, and R a classical maximal O-order.</text></s>
<s sid="921"><CoreSc1 advantage="None" conceptID="Res572" novelty="None" type="Res"/><text>Setting PA={aO|a∈K×,av&gt;0 for all archimedean places v of K where A is ramified}, and denoting by CA(O)=F×(O)/PA the corresponding ray class group, we have the following.</text></s>
Lemma 6.1
<s sid="922"><CoreSc1 advantage="None" conceptID="Res573" novelty="None" type="Res"/><text>Let r be as in Lemma 5.32.</text></s>
<s sid="923"><CoreSc1 advantage="None" conceptID="Res574" novelty="None" type="Res"/><text>Then r induces an isomorphismG/PR•≅CA(O), where PR•={η(Rx)|x∈A×}⊂G.</text></s>
Proof
By Lemma 5.32, r∘η=nrA/K.
<s sid="924"><CoreSc1 advantage="None" conceptID="Res575" novelty="None" type="Res"/><text>The isomorphism follows because nr(Rx)=Onr(x) for all x∈A×, and nr(A×)={a∈K×|av&gt;0 for all archimedean places v of K where A is ramified} by the Hasse-Schilling-Mass theorem on norms [47, Theorem 33.15]. □</text></s>
Lemma 6.2
<s sid="925"><CoreSc1 advantage="None" conceptID="Res576" novelty="None" type="Res"/><text>For all classical maximal O-orders R′, and all g∈CA(O), there exist infinitely many maximal left R′-ideals I with [nr(I)]=g.</text></s>
Proof
Let g∈CA(O).
<s sid="926"><CoreSc1 advantage="None" conceptID="Res577" novelty="None" type="Res"/><text>Then there exist infinitely many distinct maximal ideals p of O with [p]=g: The number field case for O=OK, the ring of algebraic integers, can be found in [27, Corollary 2.11.16] or [43, Corollary 7 to Proposition 7.9].</text></s>
<s sid="927"><CoreSc1 advantage="None" conceptID="Res578" novelty="None" type="Res"/><text>The general case then follows because O is obtained from OK by localizing at finitely many maximal ideals, hence the induced epimorphism CA(OK)→CA(O) yields the statement.</text></s>
<s sid="928"><CoreSc1 advantage="None" conceptID="Res579" novelty="None" type="Res"/><text>For the function field case see [27, Proposition 8.9.7].</text></s>
<s sid="929"><CoreSc1 advantage="None" conceptID="Res580" novelty="None" type="Res"/><text>For each p∈max(O) with [p]=g and every maximal left R′-ideal M with p⊂M, we have [nr(M)]=[p]=g ([47, Theorem 24.13], or use Lemma 5.32). □</text></s>
<s sid="930"><CoreSc1 advantage="None" conceptID="Con33" novelty="None" type="Con"/><text>In the following equivalent characterizations of the first condition of Theorem 1.1, &quot;left&quot; may be replaced by &quot;right&quot; in each statement; this follows easily from the first statement.</text></s>
<s sid="931"><CoreSc1 advantage="None" conceptID="Obs85" novelty="None" type="Obs"/><text>We write LC(R) for the finite set of isomorphism classes of fractional left R-ideals, i.e., [I]=[J] in LC(R) if and only if J=Ix with x∈A×.</text></s>
<s sid="932"><CoreSc1 advantage="None" conceptID="Res581" novelty="None" type="Res"/><text>The reduced norm induces a surjective map of finite sets μR:LC(R)→CA(O), given by [I]↦[nr(I)].</text></s>
Lemma 6.3
The following are equivalent.(a)
<s sid="933"><CoreSc1 advantage="None" conceptID="Res582" novelty="None" type="Res"/><text>A fractional left R′-ideal with R′ conjugate to R is principal if and only if nr(I)∈PA.</text></s>
(b)
<s sid="934"><CoreSc1 advantage="None" conceptID="Obs86" novelty="None" type="Obs"/><text>A fractional left R-ideal is principal if and only if nr(I)∈PA.</text></s>
(c)
<s sid="935"><CoreSc1 advantage="None" conceptID="Obs87" novelty="None" type="Obs"/><text>Every fractional left R-ideal I with [nr(I)]=0 is principal.</text></s>
(d)
<s sid="936"><CoreSc1 advantage="None" conceptID="Res583" novelty="None" type="Res"/><text>For the map of finite sets μR:LC(R)→CA(O) it holds that |μR-1(0)|=1.</text></s>
(e)
<s sid="937"><CoreSc1 advantage="None" conceptID="Res584" novelty="None" type="Res"/><text>Every stably free left R-ideal is free.</text></s>
(f)
<s sid="938"><CoreSc1 advantage="None" conceptID="Res585" novelty="None" type="Res"/><text>Every finitely generated projective R-module that is stably free is free.</text></s>
Proof
<s sid="939"><CoreSc1 advantage="None" conceptID="Res586" novelty="None" type="Res"/><text>The equivalence of (a), (b), (c) and (d) is trivial.</text></s>
<s sid="940"><CoreSc1 advantage="None" conceptID="Res587" novelty="None" type="Res"/><text>The remaining equivalences follow from standard literature: (f) ⇒ (e) is true because R is hereditary noetherian.</text></s>
<s sid="941"><CoreSc1 advantage="None" conceptID="Res588" novelty="None" type="Res"/><text>(e) ⇒ (f): Let M≠0 be a stably free finitely generated projective R-module.</text></s>
<s sid="942"><CoreSc1 advantage="None" conceptID="Res589" novelty="None" type="Res"/><text>Then M≅Rn⊕I for some left R-ideal I and n∈N0 ([47, Theorem 27.8] or [42, §5.7.8]).</text></s>
<s sid="943"><CoreSc1 advantage="None" conceptID="Res590" novelty="None" type="Res"/><text>I is stably free and hence free by (e), but then so is M.</text></s>
<s sid="944"><CoreSc1 advantage="None" conceptID="Res591" novelty="None" type="Res"/><text>To see (d) ⇔ (e) it suffices to recall that CA(O) is isomorphic to the projective class group C(R) (see e.g.</text></s>
<s sid="945"><CoreSc1 advantage="None" conceptID="Res592" novelty="None" type="Res"/><text>[52, Corollary 9.5]) and that LC(R) is just the set of isomorphism classes of locally free R-modules of rank one, i.e., the map μR corresponds to LF1→C(R), [I]↦[I]-[R] in the notation of [52].</text></s>
<s sid="946"><CoreSc1 advantage="None" conceptID="Res593" novelty="None" type="Res"/><text>(See also [47, Theorem 35.14] or [22] for the number field case.) □</text></s>
Proof of Theorem 1.1
<s sid="947"><CoreSc1 advantage="None" conceptID="Res594" novelty="None" type="Res"/><text>By Theorem 5.28, R is an arithmetical maximal order in Q.</text></s>
<s sid="948"><CoreSc1 advantage="None" conceptID="Res595" novelty="None" type="Res"/><text>We verify conditions (i) and (ii) of Theorem 5.23.</text></s>
<s sid="949"><CoreSc1 advantage="None" conceptID="Res596" novelty="None" type="Res"/><text>Let I be a fractional left R-ideal.</text></s>
<s sid="950"><CoreSc1 advantage="None" conceptID="Res597" novelty="None" type="Res"/><text>By Lemma 6.1, η(I)∈PR• if and only if nr(I)∈PA.</text></s>
<s sid="951"><CoreSc1 advantage="None" conceptID="Res598" novelty="None" type="Res"/><text>By Lemma 6.3, and the fact that every stably free left R-ideal is free, this is the case if and only if I is principal, thus condition (i) holds.</text></s>
<s sid="952"><CoreSc1 advantage="None" conceptID="Res599" novelty="None" type="Res"/><text>Condition (ii) holds due to Lemma 6.2.</text></s>
<s sid="953"><CoreSc1 advantage="None" conceptID="Res600" novelty="None" type="Res"/><text>By Lemma 6.1, C≅CA(O), and by Lemma 6.2, therefore C=CM.</text></s>
<s sid="954"><CoreSc1 advantage="None" conceptID="Res601" novelty="None" type="Res"/><text>Hence there exists a transfer homomorphism θ:R•→B(CA(O)).</text></s>
<s sid="955"><CoreSc1 advantage="None" conceptID="Res602" novelty="None" type="Res"/><text>The remaining claims in the theorem follow from this by Proposition 3.8. □</text></s>
Remark 6.4
<s sid="956"><CoreSc1 advantage="None" conceptID="Con34" novelty="None" type="Con"/><text>If more generally O′ is an arbitrary Dedekind domain with quotient field the global field K, then there is a transfer homomorphism to either B(CA(O′)) or B(CA(O′)∖{0}), depending on whether or not O′ contains prime elements.</text></s>
<s sid="957"><CoreSc1 advantage="None" conceptID="Con35" novelty="None" type="Con"/><text>Only Lemma 6.2 has to be adapted: O′ is a localization of a holomorphy ring O, and hence there is an epimorphism CA(O)→CA(O′).</text></s>
<s sid="958"><CoreSc1 advantage="None" conceptID="Con36" novelty="None" type="Con"/><text>This implies that every class g∈CA(O′)∖{0} contains a maximal ideal (see [13] for details).</text></s>
<s sid="959"><CoreSc1 advantage="None" conceptID="Con37" novelty="None" type="Con"/><text>Therefore, for all classical maximal O′-orders R′ and all g∈CA(O′)∖{0}, there exists a maximal left R′-ideal I with [nr(I)]=g.</text></s>
<s sid="960"><CoreSc1 advantage="None" conceptID="Con38" novelty="None" type="Con"/><text>The trivial class however may or may not contain a maximal ideal.</text></s>
<s sid="961"><CoreSc1 advantage="None" conceptID="Con39" novelty="None" type="Con"/><text>In either case, the statements 1-3 of Theorem 1.1 hold true.</text></s>
<s sid="962"><CoreSc1 advantage="None" conceptID="Con40" novelty="None" type="Con"/><text>Thanks to Kainrath for pointing this out.</text></s>
Proof of Theorem 1.2
<s sid="963"><CoreSc1 advantage="None" conceptID="Con41" novelty="None" type="Con"/><text>Throughout this section, let OK be the ring of algebraic integers in a number field K, A a central simple algebra over K, and R a classical maximal OK-order in A having a stably free left R-ideal that is not free.</text></s>
<s sid="964"><CoreSc1 advantage="None" conceptID="Con42" novelty="None" type="Con"/><text>Furthermore, the discriminant of A is denoted byD=∏p∈max(OK)Ais ramified atpp◃OK.</text></s>
<s sid="965"><CoreSc1 advantage="None" conceptID="Con43" novelty="None" type="Con"/><text>The aim of this section is to prove Theorem 1.2.</text></s>
<s sid="966"><CoreSc1 advantage="None" conceptID="Con44" novelty="None" type="Con"/><text>The existence of a stably free left R-ideal that is not free implies that A is a totally definite quaternion algebra and that K is totally real.</text></s>
<s sid="967"><CoreSc1 advantage="None" conceptID="Con45" novelty="None" type="Con"/><text>(Note, that conversely, for all but finitely many isomorphism classes of such classical maximal OK-orders in totally definite quaternion algebras there exist stably free left R-ideals that are non-free.) We proceed in three subsections.</text></s>
Reduction
<s sid="968"><CoreSc1 advantage="None" conceptID="Res603" novelty="None" type="Res"/><text>We state two propositions and show how they imply Theorem 1.2.</text></s>
<s sid="969"><CoreSc1 advantage="None" conceptID="Res604" novelty="None" type="Res"/><text>The proofs of these two propositions will then be given in Section 7.3.</text></s>
Proposition 7.1
<s sid="970"><CoreSc1 advantage="None" conceptID="Res605" novelty="None" type="Res"/><text>There exists a totally positive prime element p∈OK, a non-empty subset E⊂{2,3,4} and for every l∈N0 an atom yl∈A(R•) such thatLR•(ylp)={3}∪(l+E).</text></s>
<s sid="971"><CoreSc1 advantage="None" conceptID="Res606" novelty="None" type="Res"/><text>(We emphasize that E does not depend on l.)</text></s>
Proposition 7.2
<s sid="972"><CoreSc1 advantage="None" conceptID="Res607" novelty="None" type="Res"/><text>If L∈L(R•) and n∈N, then n+L={n+l|l∈L}∈L(R•).</text></s>
<s sid="973"><CoreSc1 advantage="None" conceptID="Res608" novelty="None" type="Res"/><text>Proof of Theorem 1.2 (based on Proposition 7.1 and Proposition 7.2)</text></s>
<s sid="974"><CoreSc1 advantage="None" conceptID="Res609" novelty="None" type="Res"/><text>We first show that there is no transfer homomorphism R•→B(GP) for any subset GP of an abelian group.</text></s>
<s sid="975"><CoreSc1 advantage="None" conceptID="Res610" novelty="None" type="Res"/><text>Assume to the contrary that θ:R•→B(GP) is such a transfer homomorphism.</text></s>
Claim A
<s sid="976"><CoreSc1 advantage="None" conceptID="Res611" novelty="None" type="Res"/><text>If S∈B(GP) and U∈A(B(GP)), then maxLB(GP)(SU)⩽|S|+1.</text></s>
Proof
<s sid="977"><CoreSc1 advantage="None" conceptID="Res612" novelty="None" type="Res"/><text>Let S=g1⋅⋯⋅gl, with l=|S| and g1,…,gl∈GP, and suppose that SU=T1⋅⋯⋅Tk with k∈N and T1,…,Tk∈A(B(GP)).</text></s>
<s sid="978"><CoreSc1 advantage="None" conceptID="Res613" novelty="None" type="Res"/><text>Then for every i∈[1,k] either Ti|U, but then already Ti=U, or gj|Ti for some j∈[1,l].</text></s>
This shows k⩽|S|+1. □
<s sid="979"><CoreSc1 advantage="None" conceptID="Res614" novelty="None" type="Res"/><text>By Proposition 7.1, there exists a totally positive prime element p∈OK, and for every l∈N0 an atom yl∈A(R•) with maxLR•(ylp)⩾l+2.</text></s>
<s sid="980"><CoreSc1 advantage="None" conceptID="Obs88" novelty="None" type="Obs"/><text>But, if l⩾|θ(p)|, thenl+2⩽maxLR•(ylp)=maxLB(GP)(θ(yl)θ(p))⩽|θ(p)|+1⩽l+1, a contradiction.</text></s>
<s sid="981"><CoreSc1 advantage="None" conceptID="Obs89" novelty="None" type="Obs"/><text>In order to show Δ(R•)=N, we choose d∈N.</text></s>
<s sid="982"><CoreSc1 advantage="None" conceptID="Obs90" novelty="None" type="Obs"/><text>Let p and E be as in Proposition 7.1 and set ϵ=minE.</text></s>
<s sid="983"><CoreSc1 advantage="None" conceptID="Obs91" novelty="None" type="Obs"/><text>If l=d+3-ϵ and yl as in Proposition 7.1, then we find d=(l+ϵ)-3∈ΔR•(ylp).</text></s>
Let k∈N⩾3.
<s sid="984"><CoreSc1 advantage="None" conceptID="Res615" novelty="None" type="Res"/><text>By definition, we have Uk(R•)⊂N⩾2.</text></s>
<s sid="985"><CoreSc1 advantage="None" conceptID="Con46" novelty="None" type="Con"/><text>Thus it remains to show that for every k′⩾3 there exists an element a∈R• with {k,k′}⊂L(a).</text></s>
<s sid="986"><CoreSc1 advantage="None" conceptID="Con47" novelty="None" type="Con"/><text>Assume without restriction that k⩽k′ and let k=3+n with n∈N0.</text></s>
<s sid="987"><CoreSc1 advantage="None" conceptID="Con48" novelty="None" type="Con"/><text>Using Proposition 7.1, we find an element a′∈R• with {3=k-n,k′-n}∈L(a′), and hence by Proposition 7.2 there exists an element a∈R• with {k,k′}∈L(a). □</text></s>
Preliminaries
Algebraic number theory.
<s sid="988"><CoreSc1 advantage="None" conceptID="Con49" novelty="None" type="Con"/><text>Our notation mainly follows Narkiewicz [43].</text></s>
<s sid="989"><CoreSc1 advantage="None" conceptID="Con50" novelty="None" type="Con"/><text>Let L/K be an extension of number fields.</text></s>
<s sid="990"><CoreSc1 advantage="None" conceptID="Con51" novelty="None" type="Con"/><text>Then DL/K is the relative different, NL/K the relative field norm, dL/K=NL/K(DL/K) is the relative discriminant and dK=dK/Q the absolute discriminant (we tacitly identify ideals of Z with their positive generators for the absolute discriminant and norm).</text></s>
<s sid="991"><CoreSc1 advantage="None" conceptID="Con52" novelty="None" type="Con"/><text>If O⊂OK is an order, then fO is the conductor of O in OK and h(O)=|Pic(O)| is the class number of O.</text></s>
<s sid="992"><CoreSc1 advantage="None" conceptID="Con53" novelty="None" type="Con"/><text>Given a∈L with minimal polynomial f∈K[X] over K, δL/K(a)=f′(a) is the different of a.</text></s>
<s sid="993"><CoreSc1 advantage="None" conceptID="Con54" novelty="None" type="Con"/><text>Completion at a prime p∈max(OK) is denoted by a subscript p, e.g., OK,p, Kp, and so on.</text></s>
<s sid="994"><CoreSc1 advantage="None" conceptID="Con55" novelty="None" type="Con"/><text>If m◃OK is a squarefree ideal, thenCm+(OK)={a∈F×(OK)|(a,m)=OK}/{aOK|a∈K× is totally positive,a≡1modm} denotes the corresponding ray class group.</text></s>
<s sid="995"><CoreSc1 advantage="None" conceptID="Con56" novelty="None" type="Con"/><text>We will repeatedly make use of the fact that every class in Cm+(OK) contains infinitely many maximal ideals of OK [43, Corollary 7 to Proposition 7.9].</text></s>
Quaternion algebras.
<s sid="996"><CoreSc1 advantage="None" conceptID="Con57" novelty="None" type="Con"/><text>We follow [53,41], and [39,40] for computational aspects.</text></s>
<s sid="997"><CoreSc1 advantage="None" conceptID="Con58" novelty="None" type="Con"/><text>Denote by ⋅¯:A→∼Aop the anti-involution given by conjugation of elements.</text></s>
ThennrA/K(x)=nr(x)=xx¯=x¯xandtrA/K(x)=tr(x)=x+x¯for all x∈A.
<s sid="998"><CoreSc1 advantage="None" conceptID="Con59" novelty="None" type="Con"/><text>Every element x∈A satisfies an equation of the formx2-tr(x)x+nr(x)=0, and if x∈A∖K, then K(x)/K is a quadratic field extension.</text></s>
<s sid="999"><CoreSc1 advantage="None" conceptID="Res616" novelty="None" type="Res"/><text>From the equation above we see that NK(x)/K=nrA/K|K(x) and TrK(x)/K=trA/K|K(x).</text></s>
<s sid="1000"><CoreSc1 advantage="None" conceptID="Mod119" novelty="None" type="Mod"/><text>A classical OK-order T of A is called a classical Eichler (OK)-order if it is the intersection of two classical maximal OK-orders.66</text></s>
<s sid="1001"><CoreSc1 advantage="None" conceptID="Res617" novelty="None" type="Res"/><text>Though unconventional, we keep the qualifier &quot;classical&quot; for consistency with the earlier sections.</text></s>
<s sid="1002"><CoreSc1 advantage="None" conceptID="Res618" novelty="None" type="Res"/><text>The reduced discriminant of a classical OK-order T takes the form DN where N◃OK is the level of T.</text></s>
<s sid="1003"><CoreSc1 advantage="None" conceptID="Res619" novelty="None" type="Res"/><text>Furthermore, because A is totally definite, we have [T×:OK×]&lt;∞ for the unit group, and CA(OK)=C+(OK) is the narrow class group of OK.</text></s>
<s sid="1004"><CoreSc1 advantage="None" conceptID="Res620" novelty="None" type="Res"/><text>As in the previous section, LC(R) is the set of isomorphism classes of left R-ideals, and μR:LC(R)→C+(OK), [I]↦[nr(I)].</text></s>
Proposition 7.3
Let C∈N.
<s sid="1005"><CoreSc1 advantage="None" conceptID="Con60" novelty="None" type="Con"/><text>Let p∈max(OK) with p∤dKD, and such thath+Mw2(NK/Q(p)+1)-2wNK/Q(p)⩾C.</text></s>
<s sid="1006"><CoreSc1 advantage="None" conceptID="Con61" novelty="None" type="Con"/><text>Then, for every c∈LC(R) with μR(c)=[p], there exist at least C maximal left (right) R-ideals of reduced norm p and class c.</text></s>
<s sid="1007"><CoreSc1 advantage="None" conceptID="Con62" novelty="None" type="Con"/><text>Here h+=|C+(OK)| is the narrow class number, and w and M are constants depending on D (see [39,40]).</text></s>
Proof
<s sid="1008"><CoreSc1 advantage="None" conceptID="Res621" novelty="None" type="Res"/><text>Although not explicitly stated in this way, this is proved by Kirschmer and Voight in [39,40]: In the proof of [39, Proposition 7.7], a lower bound on the entries of a matrix T′ (in their notation) is derived, which immediately gives a lower bound on the entries of a matrix T(p) (in their notation).</text></s>
<s sid="1009"><CoreSc1 advantage="None" conceptID="Res622" novelty="None" type="Res"/><text>This is exactly what we need, as is clear from their definition of T(p). □</text></s>
Optimal embeddings.
<s sid="1010"><CoreSc1 advantage="None" conceptID="Res623" novelty="None" type="Res"/><text>Let L/K be a quadratic field extension, and T a classical Eichler OK-order in A of squarefree level N◃OK.</text></s>
<s sid="1011"><CoreSc1 advantage="None" conceptID="Res624" novelty="None" type="Res"/><text>If O is an order in L, every embedding ι:O→T gives rise to a unique embedding ι:L→A, and ι is an optimal embedding if ι(L)∩T=O.</text></s>
<s sid="1012"><CoreSc1 advantage="None" conceptID="Res625" novelty="None" type="Res"/><text>For a∈T×, O→T, x↦aι(x)a-1 is then another such embedding.</text></s>
<s sid="1013"><CoreSc1 advantage="None" conceptID="Res626" novelty="None" type="Res"/><text>The number of optimal embeddings up to conjugation by units is bounded above by a constant (depending only on D and N) times h(O) (see [53, Corollaire III.5.12]).</text></s>
<s sid="1014"><CoreSc1 advantage="None" conceptID="Res627" novelty="None" type="Res"/><text>Since [T×:OK×] is finite, the total number of optimal embeddings of O into T is still bounded by a constant times h(O).</text></s>
Quadratic forms.
<s sid="1015"><CoreSc1 advantage="None" conceptID="Res628" novelty="None" type="Res"/><text>We use a theorem about representation numbers of totally positive definite quadratic forms over totally real fields.</text></s>
<s sid="1016"><CoreSc1 advantage="None" conceptID="Res629" novelty="None" type="Res"/><text>Let V be an n-dimensional K-vector space.</text></s>
<s sid="1017"><CoreSc1 advantage="None" conceptID="Res630" novelty="None" type="Res"/><text>An OK-lattice L of rank n is a finitely generated OK-submodule of V that generates V (over K).</text></s>
<s sid="1018"><CoreSc1 advantage="None" conceptID="Res631" novelty="None" type="Res"/><text>Together with a quadratic form q:V→K with q(L)⊂OK, (L,q) it is a quadratic lattice.</text></s>
For a∈OK we setr(L,a)=|{x∈L|q(x)=a}|.
<s sid="1019"><CoreSc1 advantage="None" conceptID="Res632" novelty="None" type="Res"/><text>An element a∈OK is locally represented everywhere by (L,q) if it is represented by the completion Lv=L⊗OKOK,v for all places v of K.</text></s>
<s sid="1020"><CoreSc1 advantage="None" conceptID="Res633" novelty="None" type="Res"/><text>The following result is a special case of Theorem 5.1 in [50].</text></s>
Proposition 7.4
<s sid="1021"><CoreSc1 advantage="None" conceptID="Res634" novelty="None" type="Res"/><text>Let (L,q) be a quadratic OK-lattice of rank four and suppose that q is totally positive definite.</text></s>
<s sid="1022"><CoreSc1 advantage="None" conceptID="Res635" novelty="None" type="Res"/><text>Then, for every η&gt;0 and s∈N0, there exists a constant Cη,s&gt;0, such that for all a∈OK that are locally represented everywhere by L, with |NK/Q(a)| sufficiently large and ps∤aOK if Lp is anisotropic, the asymptotic formular(L,a)=r(genL,a)+O(|NK/Q(a)|1118+ε) holds withr(genL,a)⩾Cη,s⋅NK/Q(a(〈q(L)〉OK)-1)1-η.</text></s>
<s sid="1023"><CoreSc1 advantage="None" conceptID="Res636" novelty="None" type="Res"/><text>In particular, r(L,a) is of order of magnitude |NK/Q(a)|1-η.</text></s>
<s sid="1024"><CoreSc1 advantage="None" conceptID="Res637" novelty="None" type="Res"/><text>If T is any classical OK-order and I any left T-ideal (in particular if I=T), then the restriction of the reduced norm to I makes (I,nr|I) into a quadratic OK-lattice of rank four and this is the situation that we will apply this result to.</text></s>
Ideal theory in R.
<s sid="1025"><CoreSc1 advantage="None" conceptID="Res638" novelty="None" type="Res"/><text>Let α be the set of all classical maximal OK-orders in A (i.e., the equivalence class of the maximal order R).</text></s>
<s sid="1026"><CoreSc1 advantage="None" conceptID="Res639" novelty="None" type="Res"/><text>Conjugation extends to ideals: For I∈Fv(α) define I¯={x¯|x∈I}.</text></s>
<s sid="1027"><CoreSc1 advantage="None" conceptID="Res640" novelty="None" type="Res"/><text>Then I¯ is a fractional (Or(I),Ol(I))-ideal, I⋅I¯=Ol(I)nr(I), and I¯⋅I=Or(I)nr(I), and hence I-1=I¯⋅(Ol(I)nr(I))-1=(nr(I)Or(I))-1⋅I¯.</text></s>
<s sid="1028"><CoreSc1 advantage="None" conceptID="Con63" novelty="None" type="Con"/><text>Fv(α) takes a particularly simple form: If p|D then there exists a maximal two-sided R-ideal P with P2=p, nr(P)=p and if I is a left or right R-ideal with nr(I)=pk, then I=Pk.</text></s>
<s sid="1029"><CoreSc1 advantage="None" conceptID="Con64" novelty="None" type="Con"/><text>If p∤D, then P=pR is the maximal two-sided R-ideal lying above p, and Rp/Pp≅M2(OK,p/pp)≅M2(FNK/Q(p)).</text></s>
<s sid="1030"><CoreSc1 advantage="None" conceptID="Con65" novelty="None" type="Con"/><text>In particular there are NK/Q(p)+1 maximal left R-ideals (respectively maximal right R-ideals) with reduced norm p.</text></s>
<s sid="1031"><CoreSc1 advantage="None" conceptID="Con66" novelty="None" type="Con"/><text>If M, N are two distinct maximal left R-ideals with nr(M)=nr(N)=p, then M∩N=P (since the composition length of M2(FNK/Q(p)) is two).</text></s>
<s sid="1032"><CoreSc1 advantage="None" conceptID="Con67" novelty="None" type="Con"/><text>This implies that if M⋅M′=N⋅N′ with maximal integral M′,N′∈Fv(α), then M⋅M′=N⋅N′=P, and thus necessarily M′=M¯, N′=N¯.</text></s>
<s sid="1033"><CoreSc1 advantage="None" conceptID="Con68" novelty="None" type="Con"/><text>We therefore explicitly know all relations between maximal integral elements of Fv(α): From Proposition 4.12 we know that all relations are generated from those between pairs of products of two elements and it also characterizes the only relation between maximal integral elements of coprime reduced norm.</text></s>
<s sid="1034"><CoreSc1 advantage="None" conceptID="Con69" novelty="None" type="Con"/><text>With the discussion above we now also know the relations between two maximal integral elements of the same reduced norm: Either there are none, or the product is P.</text></s>
<s sid="1035"><CoreSc1 advantage="None" conceptID="Con70" novelty="None" type="Con"/><text>A left R-ideal I is primitive if it is not contained in an ideal of the form Ra with a◃OK.</text></s>
<s sid="1036"><CoreSc1 advantage="None" conceptID="Con71" novelty="None" type="Con"/><text>If nr(I)=pk with p∈max(OK) and I is primitive, then it has a unique rigid factorization in Iv(α).</text></s>
<s sid="1037"><CoreSc1 advantage="None" conceptID="Res641" novelty="None" type="Res"/><text>Proofs of Proposition 7.1 and Proposition 7.2</text></s>
<s sid="1038"><CoreSc1 advantage="None" conceptID="Res642" novelty="None" type="Res"/><text>We start with some lemmas.</text></s>
Lemma 7.5
<s sid="1039"><CoreSc1 advantage="None" conceptID="Res643" novelty="None" type="Res"/><text>Let T be a classical OK-order in A.</text></s>
<s sid="1040"><CoreSc1 advantage="None" conceptID="Res644" novelty="None" type="Res"/><text>For all but finitely many associativity classes of totally positive prime elements q∈OK we have: If x∈T with nr(x)=q and x2=εq for some ε∈T×, then ε=-1.</text></s>
Proof
<s sid="1041"><CoreSc1 advantage="None" conceptID="Res645" novelty="None" type="Res"/><text>x satisfies the polynomial equation x2-tr(x)x+nr(x)=0.</text></s>
<s sid="1042"><CoreSc1 advantage="None" conceptID="Res646" novelty="None" type="Res"/><text>Substituting x2=εq and nr(x)=q yields(2)tr(x)x=(1+ε)q.</text></s>
<s sid="1043"><CoreSc1 advantage="None" conceptID="Res647" novelty="None" type="Res"/><text>It will thus suffice to show that for all but finitely many OKq, we have tr(x)=0.</text></s>
<s sid="1044"><CoreSc1 advantage="None" conceptID="Res648" novelty="None" type="Res"/><text>Assume that q∈OK is a totally positive prime element, x∈T with x2=εq and tr(x)≠0.</text></s>
Then K(x)=K(ε) by (2).
Let L=K(ε).
<s sid="1045"><CoreSc1 advantage="None" conceptID="Res649" novelty="None" type="Res"/><text>Since ε∈L∩T×⊂OL×,OLq=OLεq=(OLx)2, and therefore q ramifies in OL, implying OKq|dL/K.</text></s>
<s sid="1046"><CoreSc1 advantage="None" conceptID="Res650" novelty="None" type="Res"/><text>Hence, for fixed L there are only finitely many possibilities for OKq, and moreover there are only finitely many possibilities for L=K(ε) because [T×:OK×] is finite since A is totally definite.77</text></s>
<s sid="1047"><CoreSc1 advantage="None" conceptID="Res651" novelty="None" type="Res"/><text>It should be pointed out that an even stronger statement is true.</text></s>
<s sid="1048"><CoreSc1 advantage="None" conceptID="Res652" novelty="None" type="Res"/><text>For any fixed totally real field K, there are only finitely many totally imaginary quadratic extensions that have larger unit group (i.e., weak unit defect), while all other totally imaginary quadratic extensions L/K have OL×=OK× (i.e., strong unit defect).</text></s>
<s sid="1049"><CoreSc1 advantage="None" conceptID="Res653" novelty="None" type="Res"/><text>This follows from [OL×:μ(L)OK×]∈{1,2} [54, Theorem 4.12]: For ε∈OL× we have ε2=ηζ with ζ∈μ(L) and η∈OK×.</text></s>
<s sid="1050"><CoreSc1 advantage="None" conceptID="Con72" novelty="None" type="Con"/><text>But ord(ζ)|[L:Q]=2[K:Q] and if γ∈(OK×)2, then ηγζ yields the same extension.</text></s>
<s sid="1051"><CoreSc1 advantage="None" conceptID="Con73" novelty="None" type="Con"/><text>Since [OK×:(OK×)2]&lt;∞ there are therefore only finitely many such extensions.</text></s>
<s sid="1052"><CoreSc1 advantage="None" conceptID="Con74" novelty="None" type="Con"/><text>This argument is due to Remak in [48, §3].</text></s>
<s sid="1053"><CoreSc1 advantage="None" conceptID="Con75" novelty="None" type="Con"/><text>Thus there are, up to associativity, only finitely many such q. □</text></s>
Lemma 7.6
<s sid="1054"><CoreSc1 advantage="None" conceptID="Res654" novelty="None" type="Res"/><text>Let T be a classical OK-order in A.</text></s>
<s sid="1055"><CoreSc1 advantage="None" conceptID="Res655" novelty="None" type="Res"/><text>For every M∈N there exists a C∈N such that for all totally positive prime elements q∈OK with q∈nrAp/Kp(Tp) for all p∈max(OK) and NK/Q(q)⩾C|{a∈T|nr(a)=q and a2≠-q}|⩾M.</text></s>
Proof
<s sid="1056"><CoreSc1 advantage="None" conceptID="Res656" novelty="None" type="Res"/><text>Let q be a totally positive prime element of OK.</text></s>
<s sid="1057"><CoreSc1 advantage="None" conceptID="Res657" novelty="None" type="Res"/><text>We derive an upper bound with order of magnitude NK/Q(q)log(NK/Q(q))2[K:Q]-1 on the number of elements a∈T with a2=-q (based on counting optimal embeddings).</text></s>
<s sid="1058"><CoreSc1 advantage="None" conceptID="Res658" novelty="None" type="Res"/><text>Comparing this to the lower bound of order of magnitude NK/Q(q)1-η for the number of elements a∈T with nr(a)=q obtained from Proposition 7.4 will give the result.</text></s>
<s sid="1059"><CoreSc1 advantage="None" conceptID="Res659" novelty="None" type="Res"/><text>If a∈T with nr(a)=q and a2=-q, then OK[a]⊂T is isomorphic to the order OK[-q] in the relative quadratic extension K(-q).</text></s>
<s sid="1060"><CoreSc1 advantage="None" conceptID="Res660" novelty="None" type="Res"/><text>We determine an upper bound the number of embeddings of OK[-q] into T.</text></s>
<s sid="1061"><CoreSc1 advantage="None" conceptID="Con76" novelty="None" type="Con"/><text>For this we may without loss of generality assume that T is a classical Eichler order of squarefree level, for otherwise we may replace it by a classical Eichler order of squarefree level in which it is contained (e.g., a classical maximal order), and bound the number of embeddings there.</text></s>
Let L=K(-q).
<s sid="1062"><CoreSc1 advantage="None" conceptID="Con77" novelty="None" type="Con"/><text>Since f=X2+q is the minimal polynomial of -q over K, we get for the different δL/K(-q)=f′(-q)=2-q.</text></s>
<s sid="1063"><CoreSc1 advantage="None" conceptID="Con78" novelty="None" type="Con"/><text>Therefore, we find for the conductor of OK[-q] in OL,fOK[-q]=δL/K(-q)DL/K-1|2OL (cf.</text></s>
<s sid="1064"><CoreSc1 advantage="None" conceptID="Res661" novelty="None" type="Res"/><text>[43, Proposition 4.12 and Theorem 4.8]).</text></s>
<s sid="1065"><CoreSc1 advantage="None" conceptID="Res662" novelty="None" type="Res"/><text>Since 2OL⊂OK[-q]⊂OL and |OL/2OL|=2[L:Q], there are at most 22[L:Q] orders in OL that contain OK[-q].</text></s>
<s sid="1066"><CoreSc1 advantage="None" conceptID="Res663" novelty="None" type="Res"/><text>For any such order O with OK[-q]⊂O⊂OL, we haveh(O)=h(OL)|(OL/fO)×||(O/fO)×|⩽h(OL)2[L:Q] (cf.</text></s>
[44, §I.12.9 and §I.12.11]).
<s sid="1067"><CoreSc1 advantage="None" conceptID="Res664" novelty="None" type="Res"/><text>The number of optimal embeddings of O into T is bounded by a constant times h(O), and hence the total number of embeddings of OK[-q] into T is bounded by a constant times h(OL), where the constant does not depend on q.</text></s>
<s sid="1068"><CoreSc1 advantage="None" conceptID="Res665" novelty="None" type="Res"/><text>Combining the upper boundh(OL)≪|dL|log(|dL|)[L:Q]-1 (cf.</text></s>
<s sid="1069"><CoreSc1 advantage="None" conceptID="Res666" novelty="None" type="Res"/><text>[43, Theorem 4.4]), withdL=NL/Q(DL/Q)=NL/Q(DK/Q)NL/Q(DL/K)⩽dK22[L:Q]|NL/Q(-q)|=dK22[L:Q]NK/Q(q) (here DL/K|2-qOL was used), we obtainh(OL)≪NK/Q(q)log(NK/Q(q))[L:Q]-1, and thus an upper bound of the same order for |{a∈T|nr(a)=q and a2=-q}|.</text></s>
<s sid="1070"><CoreSc1 advantage="None" conceptID="Res667" novelty="None" type="Res"/><text>By Proposition 7.4, for every η&gt;0 and sufficiently large (in norm) q with q being locally represented everywhere by the norm form, |{a∈T|nr(a)=q}| grows with order of magnitude NK/Q(q)1-η, and the claim follows, by choosing η small enough, say η&lt;14. □</text></s>
Remark 7.7
<s sid="1071"><CoreSc1 advantage="None" conceptID="Res668" novelty="None" type="Res"/><text>For any classical OK-order T of A there are infinitely many pairwise non-associated totally positive primes q∈OK that are locally represented everywhere by nrA/K on T.</text></s>
<s sid="1072"><CoreSc1 advantage="None" conceptID="Res669" novelty="None" type="Res"/><text>This can easily be seen as follows: Let DN◃OK be the discriminant of T.</text></s>
<s sid="1073"><CoreSc1 advantage="None" conceptID="Con79" novelty="None" type="Con"/><text>If p∈max(OK) with p∤DN, then Tp≅M2(OK,p) and thus nrAp/Kp(Tp)=OK,p.</text></s>
<s sid="1074"><CoreSc1 advantage="None" conceptID="Con80" novelty="None" type="Con"/><text>If p|DN, since center(Tp)=OK,p, certainly still every square of OK,p is represented by nrAp/Kp on Tp (in fact, if p|D but p∤N then Tp is isomorphic to the unique classical maximal OK,p-order in the unique quaternion division algebra over Kp, for which nr(Tp)=OK,p also holds).</text></s>
<s sid="1075"><CoreSc1 advantage="None" conceptID="Con81" novelty="None" type="Con"/><text>By Henselʼs Lemma therefore every totally positive prime element q∈OK with q≡1mod4DN is locally represented everywhere by nrA/K on T.</text></s>
<s sid="1076"><CoreSc1 advantage="None" conceptID="Con82" novelty="None" type="Con"/><text>But there are infinitely many pairwise non-associated such primes, because every class of the ray class group C4DN+(OK) contains infinitely many pairwise distinct maximal ideals, and primes q of the required form correspond exactly to the trivial class in C4DN+(OK).</text></s>
Lemma 7.8
<s sid="1077"><CoreSc1 advantage="None" conceptID="Con83" novelty="None" type="Con"/><text>Let q be a totally positive prime element of OK.</text></s>
<s sid="1078"><CoreSc1 advantage="None" conceptID="Res670" novelty="None" type="Res"/><text>Let I be a non-principal right R-ideal with nr(I)=qmOK for some m∈N, and J be a left S=Ol(I)-ideal with nr(J)=qnOK for some n∈N such that: I≅J (as left S-ideals) and I (respectively J) is not contained in any principal left S-ideal except S itself, and not contained in any principal right Or(I)-ideal (respectively right Or(J)-ideal) except Or(I) (respectively Or(J)) itself.</text></s>
<s sid="1079"><CoreSc1 advantage="None" conceptID="Con84" novelty="None" type="Con"/><text>Assume further that a∈S with nr(a)=q and a2S≠qS.1.</text></s>
<s sid="1080"><CoreSc1 advantage="None" conceptID="Con85" novelty="None" type="Con"/><text>For all l∈N, (alJ¯a-l)alI is a principal right R-ideal and an atom of HR•.</text></s>
<s sid="1081"><CoreSc1 advantage="None" conceptID="Con86" novelty="None" type="Con"/><text>In particular, alqm∈A(R•) for all l∈N.</text></s>
2.
<s sid="1082"><CoreSc1 advantage="None" conceptID="Con87" novelty="None" type="Con"/><text>J¯I∈A(HR•) if it is primitive.</text></s>
<s sid="1083"><CoreSc1 advantage="None" conceptID="Con88" novelty="None" type="Con"/><text>In particular if m=n=1 and I≠J, then J¯I∈A(HR•).</text></s>
Proof
<s sid="1084"><CoreSc1 advantage="None" conceptID="Con89" novelty="None" type="Con"/><text>Since I is not contained in any principal right R-ideal, it is in particular not contained in qR, hence primitive.</text></s>
Similarly, J is primitive.
<s sid="1085"><CoreSc1 advantage="None" conceptID="Con90" novelty="None" type="Con"/><text>Let M1⁎⋯⁎Mm∈ZIv(α)⁎(I) and N1⁎⋯⁎Nn∈ZIv(α)⁎(J), with M1,…,Mm,N1,…,Nn∈Mv(α), be the unique rigid factorizations of I and J.</text></s>
<s sid="1086"><CoreSc1 advantage="None" conceptID="Con91" novelty="None" type="Con"/><text>1. Since I≅J as left S-ideals, (alJ¯a-l)alI=alJ¯I is principal.</text></s>
<s sid="1087"><CoreSc1 advantage="None" conceptID="Con92" novelty="None" type="Con"/><text>A rigid factorization of it is given by(alNn¯a-l)⁎⋯⁎(alN1¯a-l)⁎(alSa-l)a⁎(al-1Sa-(l-1))a⁎⋯⁎(aSa-1)a⁎M1⁎⋯⁎Mm with Mi,alNj¯a-l,(al-kSa-(l-k))a∈Mv(α) for i∈[1,m], j∈[1,n] and k∈[0,l-1].</text></s>
<s sid="1088"><CoreSc1 advantage="None" conceptID="Con93" novelty="None" type="Con"/><text>By the restrictions imposed on I, J and a, this is the only rigid factorization of alJ¯I.</text></s>
<s sid="1089"><CoreSc1 advantage="None" conceptID="Con94" novelty="None" type="Con"/><text>Since any non-empty proper subproduct starting from the left (or the right) is non-principal, it is an atom in HR•.</text></s>
<s sid="1090"><CoreSc1 advantage="None" conceptID="Con95" novelty="None" type="Con"/><text>The &quot;in particular&quot; statement follows by setting J=I, as then alJ¯I=alqmR∈A(HR•) and because of Proposition 5.20, therefore alqm∈A(R•).</text></s>
<s sid="1091"><CoreSc1 advantage="None" conceptID="Con96" novelty="None" type="Con"/><text>2. By primitivity,Nn¯⁎⋯⁎N1¯⁎M1⁎⋯⁎Mm∈ZIv(α)⁎(J¯I) is the unique rigid factorization of J¯I, and since as before no non-empty proper subproduct from the left (or the right) is principal, it is an atom in HR•.</text></s>
<s sid="1092"><CoreSc1 advantage="None" conceptID="Con97" novelty="None" type="Con"/><text>For the &quot;in particular&quot; statement, note that if m=n=1 (i.e., I and J are both maximal left S-ideals), then J¯I=qR if and only if I=J, and otherwise J¯I is necessarily primitive. □</text></s>
Lemma 7.9
<s sid="1093"><CoreSc1 advantage="None" conceptID="Con98" novelty="None" type="Con"/><text>Let I be a left R-ideal, S=Or(I), and a∈R∩S.</text></s>
<s sid="1094"><CoreSc1 advantage="None" conceptID="Con99" novelty="None" type="Con"/><text>Then∏i=1l(al-i+1Ra-(l-i+1))a⋅I=alI=(alIa-l)al=(alIa-l)⋅∏i=1l(al-i+1Sa-(l-i+1))a with the left-most and the right-most expressions being proper products of(al-i+1Ra-(l-i+1))a,I,(al-i+1Sa-(l-i+1))a,alIa-l∈Iv(α).</text></s>
<s sid="1095"><CoreSc1 advantage="None" conceptID="Con100" novelty="None" type="Con"/><text>(The products have to be read in ascending order with &quot;i=1&quot; to the very left.)</text></s>
Proof
<s sid="1096"><CoreSc1 advantage="None" conceptID="Con101" novelty="None" type="Con"/><text>The formulas are clear, and so is that the products are proper ones.</text></s>
<s sid="1097"><CoreSc1 advantage="None" conceptID="Con102" novelty="None" type="Con"/><text>The key point is that these one-sided ideals are indeed integral.</text></s>
<s sid="1098"><CoreSc1 advantage="None" conceptID="Con103" novelty="None" type="Con"/><text>But this is so because a∈S, hence a∈akSa-k for all k∈N0, implying that (akSa-k)a∈Iv(α), and similarly a∈R, thus (akRa-k)a∈Iv(α). □</text></s>
Lemma 7.10
<s sid="1099"><CoreSc1 advantage="None" conceptID="Con104" novelty="None" type="Con"/><text>Let M be a maximal left R-ideal, and N a maximal left Or(M)-ideal.</text></s>
If M⋅N=N′⋅M′, then M¯⋅N′=N⋅M′¯.
Proof
<s sid="1100"><CoreSc1 advantage="None" conceptID="Con105" novelty="None" type="Con"/><text>Since Or(M¯)=Ol(M)=Ol(N′) and Or(N)=Or(M′)=Ol(M′¯) the product is proper.</text></s>
<s sid="1101"><CoreSc1 advantage="None" conceptID="Con106" novelty="None" type="Con"/><text>We haveM¯⋅N′⋅M′=M¯⋅M⋅N=nr(M)Ol(N)⋅N=N⋅Or(N)nr(M)=N⋅M′¯⋅M′, and thus M¯⋅N′=N⋅M′¯. □</text></s>
Proof of Proposition 7.1
<s sid="1102"><CoreSc1 advantage="None" conceptID="Con107" novelty="None" type="Con"/><text>Let p∈OK be a totally positive prime element with pOK∤dKDN and with nr(p) satisfying the bound of Proposition 7.3 for the classical maximal order R (with C=1).</text></s>
<s sid="1103"><CoreSc1 advantage="None" conceptID="Con108" novelty="None" type="Con"/><text>Then there exists a maximal right R-ideal U with nr(U)=pOK that is non-free (i.e., non-principal) but is stably free (i.e., [nr(U)]=0 in C+(OK)).</text></s>
<s sid="1104"><CoreSc1 advantage="None" conceptID="Con109" novelty="None" type="Con"/><text>Let U=U0,…,Ur be the maximal left Ol(U)-ideals of reduced norm pOK (of which there are r+1=NK/Q(p)+1).</text></s>
<s sid="1105"><CoreSc1 advantage="None" conceptID="Con110" novelty="None" type="Con"/><text>By Lemma 7.6, there exists a totally positive prime element q∈OK, qOK∤pdKDN, and an elementa∈Ol(U)∩⋂j=0rOr(Uj)with nr(a)=q and a2≠-q, and in fact, by Lemma 7.5, we may make this choice such that a2≠εq for any ε∈R×.</text></s>
<s sid="1106"><CoreSc1 advantage="None" conceptID="Con111" novelty="None" type="Con"/><text>In addition, we may take NK/Q(q) to be sufficiently large to satisfy the bound of Proposition 7.3 for Ol(U) (with C=2).</text></s>
<s sid="1107"><CoreSc1 advantage="None" conceptID="Con112" novelty="None" type="Con"/><text>Then there exist distinct left Ol(U)-ideals I and J such that I≅J≅U and nr(I)=nr(J)=qOK.</text></s>
<s sid="1108"><CoreSc1 advantage="None" conceptID="Con113" novelty="None" type="Con"/><text>Set S=Or(I), and observe that S≅R, because U≅I.</text></s>
<s sid="1109"><CoreSc1 advantage="None" conceptID="Con114" novelty="None" type="Con"/><text>By Lemma 7.8, (alJ¯a-l)alI∈A(HS•) for all l∈N0, say (alJ¯a-l)alI=ylS with yl∈A(S•).</text></s>
<s sid="1110"><CoreSc1 advantage="None" conceptID="Con115" novelty="None" type="Con"/><text>We consider the principal right S-ideal Xl=(alJ¯a-l)alIp⊂S, say Xl=xlS with xl∈S•.</text></s>
<s sid="1111"><CoreSc1 advantage="None" conceptID="Con116" novelty="None" type="Con"/><text>We will first determine all possible rigid factorizations of Xl in Iv(α).</text></s>
<s sid="1112"><CoreSc1 advantage="None" conceptID="Con117" novelty="None" type="Con"/><text>As in Lemma 7.8, the right S-ideal (alJ¯a-l)alI has reduced norm ql+2OK, is primitive, and thus possesses a unique rigid factorization,(alJ¯a-l)⁎(alOl(I)a-l)a⁎(al-1Ol(I)a-(l-1))a⁎⋯⁎(aOl(I)a-1)a⁎I∈ZIv(α)⁎((alJ¯a-l)alI), with the l+2 factors alJ¯a-l, (al-kOl(I)a-(l-k))a for k∈[0,l-1] and I all in Mv(α).</text></s>
<s sid="1113"><CoreSc1 advantage="None" conceptID="Con118" novelty="None" type="Con"/><text>For an element with a unique rigid factorization we make the convention of identifying the element and its factorization when this is notationally convenient.</text></s>
<s sid="1114"><CoreSc1 advantage="None" conceptID="Con119" novelty="None" type="Con"/><text>For principal ideals we omit the order and only write the generator if it is clear from the neighboring elements in the factorization what the order must be.</text></s>
<s sid="1115"><CoreSc1 advantage="None" conceptID="Con120" novelty="None" type="Con"/><text>For example, we can write the previous rigid factorization as alJ¯a-l⁎al⁎I.</text></s>
<s sid="1116"><CoreSc1 advantage="None" conceptID="Con121" novelty="None" type="Con"/><text>Xl has (r+1)(l+42) rigid factorizations: They arise from the different rigid factorizations Ui⁎Ui¯∈ZIv(α)⁎(Ol(U)p) for i∈[0,r] and the possible transpositions of Ui and Ui¯.</text></s>
<s sid="1117"><CoreSc1 advantage="None" conceptID="Con122" novelty="None" type="Con"/><text>We denote the rigid factorization of Xl that arises from alJa-l⁎al⁎Ui⁎Ui¯⁎I by transposing the one-sided ideals of norm p to the positions m∈[-1,l+1] and n∈[m,l+1] in the factorization by Fi,m,n: Here, the left-most position in the rigid factorization is denoted by -1, the right-most by l+1.</text></s>
<s sid="1118"><CoreSc1 advantage="None" conceptID="Con123" novelty="None" type="Con"/><text>So, by &quot;the rigid factorization obtained by transposing Ui to the position -1 and Ui¯ to l+1&quot; we mean the unique rigid factorization of Xl that has a factor of norm pOK as the first factor and as the last factor, and that can be transformed into alJ¯a-l⁎al⁎Ui⁎Ui¯⁎I by transposition of maximal integral elements with coprime norm.</text></s>
<s sid="1119"><CoreSc1 advantage="None" conceptID="Con124" novelty="None" type="Con"/><text>For i∈[0,r] let Vi∈Mv(α) and Mi∈Mv(α) be defined by Ui¯I=MiVi¯ under transposition, and let Wi∈Mv(α) and Ni∈Mv(α) be defined by WiNi¯=J¯Ui under transposition.</text></s>
<s sid="1120"><CoreSc1 advantage="None" conceptID="Con125" novelty="None" type="Con"/><text>({Vi|i∈[0,r]} is then the set of all r+1 left S=Or(I)-ideals of reduced norm p.</text></s>
<s sid="1121"><CoreSc1 advantage="None" conceptID="Con126" novelty="None" type="Con"/><text>Similarly {Wi|i∈[0,r]} is then the set of all r+1 left Or(J)-ideals of reduced norm p, and since Or(I)≅Or(J) the sets are actually conjugate under conjugation by an element of A×.) By Lemma 7.10 we then also have UiMi=IVi and Wi¯J¯=Ni¯Ui¯ under transposition.</text></s>
<s sid="1122"><CoreSc1 advantage="None" conceptID="Con127" novelty="None" type="Con"/><text>Using Lemma 7.9 to see that a transposes &quot;nicely&quot; with Ui and Ui¯, we can explicitly describe all Fi,m,n as follows:Case 1.</text></s>
If m=n=-1:Fi,m,n=alWia-l⁎alWi¯a-l⁎alJ¯a-l⁎al⁎I.
Case 2.
If m=-1 and 0⩽n⩽l:Fi,m,n=alWia-l⁎alN¯ia-l⁎an⁎al-nUi¯a-(l-n)⁎al-n⁎I.
Case 3.
If 0⩽m⩽n⩽l:Fi,m,n=alJ¯a-l⁎am⁎al-mUia-(l-m)⁎an-m⁎al-nUi¯a-(l-n)⁎al-n⁎I.
Case 4.
If m=-1 and n=l+1:Fi,m,n=alWia-l⁎alNi¯a-l⁎al⁎Mi⁎Vi¯.
Case 5.
If 0⩽m⩽l and n=l+1:Fi,m,n=alJ¯a-l⁎am⁎al-mUia-(l-m)⁎al-m⁎Mi⁎Vi¯.
Case 6.
If m=n=l+1:Fi,m,n=alJ¯a-l⁎al⁎I⁎Vi⁎Vi¯.
<s sid="1123"><CoreSc1 advantage="None" conceptID="Con128" novelty="None" type="Con"/><text>For each of these rigid factorizations of the ideal Xl in Iv(α) we can form minimal subproducts of principal one-sided ideals (starting from the left or the right) to obtain a representation of Xl as a product in HS• (and hence a representation of xl as a product of elements of S•).</text></s>
<s sid="1124"><CoreSc1 advantage="None" conceptID="Con129" novelty="None" type="Con"/><text>But only when each of these minimal principal subproducts is an atom of HS• this gives rise to an actual rigid factorization of xl into atoms.</text></s>
<s sid="1125"><CoreSc1 advantage="None" conceptID="Con130" novelty="None" type="Con"/><text>We discuss the individual cases one-by-one:Case 1.</text></s>
<s sid="1126"><CoreSc1 advantage="None" conceptID="Con131" novelty="None" type="Con"/><text>If m=n=-1: If Wi is non-principal, then this does not give rise to a rigid factorization into atoms, as the first principal factor is al(WiWi¯)a-l=al(pOr(J))a-l, and this is not an atom (since there is at least one element in {Wi|i∈[0,r]} that is principal by Proposition 7.3).</text></s>
<s sid="1127"><CoreSc1 advantage="None" conceptID="Con132" novelty="None" type="Con"/><text>If on the other hand Wi is principal, then this gives rise to a rigid factorization of Xl in HS• of length 3, with atomic factors alWia-l, alWi¯a-l and (alJ¯a-l)alI, which in turn gives rise to a rigid factorization of length 3 of xl∈S.</text></s>
Case 2.
<s sid="1128"><CoreSc1 advantage="None" conceptID="Con133" novelty="None" type="Con"/><text>If m=-1 and 0⩽n⩽l:Case 2a.</text></s>
<s sid="1129"><CoreSc1 advantage="None" conceptID="Con134" novelty="None" type="Con"/><text>If Ui≅I: Then the last principal factor is necessarily (al-nUi¯a-(l-n))al-nI.</text></s>
<s sid="1130"><CoreSc1 advantage="None" conceptID="Con135" novelty="None" type="Con"/><text>If n&lt;l, then transposing Ui¯ to the right shows that this is not an atom in HS•.</text></s>
<s sid="1131"><CoreSc1 advantage="None" conceptID="Con136" novelty="None" type="Con"/><text>If n=l then Ui¯I=MiVi¯ is an atom if and only if Vi is non-principal.</text></s>
<s sid="1132"><CoreSc1 advantage="None" conceptID="Con137" novelty="None" type="Con"/><text>Since also Ui≅J, the factor WiNi¯=J¯Ui is principal, and, because J¯ and Ui¯ are non-principal, this is either an atom (if Wi is non-principal), or a product of two atoms (if Wi is principal).</text></s>
<s sid="1133"><CoreSc1 advantage="None" conceptID="Con138" novelty="None" type="Con"/><text>So if Vi is non-principal we get a rigid factorization of length either l+2 or l+3, and if Vi is principal we get no rigid factorization into atoms.</text></s>
Case 2b.
<s sid="1134"><CoreSc1 advantage="None" conceptID="Obs92" novelty="None" type="Obs"/><text>If Ui≇I: Then either there are no non-trivial principal factors (if Wi is non-principal), or the first factor is Wi and the remaining product does not factor into non-trivial principal factors.</text></s>
<s sid="1135"><CoreSc1 advantage="None" conceptID="Res671" novelty="None" type="Res"/><text>But then this second factor is not an atom, because after transposition of Ui¯ to the very left of the second factor (i.e., position 0), we have a principal factor Wi¯.</text></s>
<s sid="1136"><CoreSc1 advantage="None" conceptID="Con139" novelty="None" type="Con"/><text>So in any case, this does not give rise to a rigid factorization into atoms.</text></s>
Case 3.
<s sid="1137"><CoreSc1 advantage="None" conceptID="Con140" novelty="None" type="Con"/><text>If 0⩽m⩽n⩽l: If I≇Ui, then there are no non-trivial principal factors, and hence no rigid factorization into atoms is obtained.</text></s>
<s sid="1138"><CoreSc1 advantage="None" conceptID="Con141" novelty="None" type="Con"/><text>If I≅Ui, then the first principal factor is (alJ¯a-l)am(al-mUia-(l-m)), and the last one is (al-nUi¯a-(l-n))al-nI.</text></s>
<s sid="1139"><CoreSc1 advantage="None" conceptID="Con142" novelty="None" type="Con"/><text>If m&gt;0 (or n&lt;l), then by transposing Ui to the left in the first factor (or Ui¯ to the right in the second factor) once, we see that this does not give rise to a rigid factorization into atoms.</text></s>
<s sid="1140"><CoreSc1 advantage="None" conceptID="Con143" novelty="None" type="Con"/><text>Consider now m=0 and n=l.</text></s>
<s sid="1141"><CoreSc1 advantage="None" conceptID="Con144" novelty="None" type="Con"/><text>If Vi is principal, then J¯Ui=ViKi¯ implies that the first factor alJ¯Uia-l is no atom, and hence again we get no rigid factorization into atoms.</text></s>
<s sid="1142"><CoreSc1 advantage="None" conceptID="Con145" novelty="None" type="Con"/><text>Analogously we get no rigid factorization into atoms if Wi is principal.</text></s>
<s sid="1143"><CoreSc1 advantage="None" conceptID="Con146" novelty="None" type="Con"/><text>If on the other hand Vi and Wi are both non-principal then J¯Ui is an atom, and so is Ui¯I.</text></s>
<s sid="1144"><CoreSc1 advantage="None" conceptID="Con147" novelty="None" type="Con"/><text>Thus we obtain a rigid factorization of Xl (and hence of xl) of length l+2.</text></s>
<s sid="1145"><CoreSc1 advantage="None" conceptID="Con148" novelty="None" type="Con"/><text>(It is then in fact the same one as the one obtained from Case 2 in the same situation.)</text></s>
Case 4.
<s sid="1146"><CoreSc1 advantage="None" conceptID="Con149" novelty="None" type="Con"/><text>If m=-1 and n=l+1:Case 4a.</text></s>
<s sid="1147"><CoreSc1 advantage="None" conceptID="Con150" novelty="None" type="Con"/><text>If Ui≅I: Then WiNi¯ and MiVi¯ are both principal.</text></s>
<s sid="1148"><CoreSc1 advantage="None" conceptID="Con151" novelty="None" type="Con"/><text>If Wi is non-principal, then WiNi¯=J¯Ui is an atom since J is non-principal.</text></s>
<s sid="1149"><CoreSc1 advantage="None" conceptID="Con152" novelty="None" type="Con"/><text>If Wi is principal, then WiNi¯ is a product of two atoms.</text></s>
<s sid="1150"><CoreSc1 advantage="None" conceptID="Con153" novelty="None" type="Con"/><text>Similarly, MiVi¯ is either an atom or a product of two atoms.</text></s>
<s sid="1151"><CoreSc1 advantage="None" conceptID="Con154" novelty="None" type="Con"/><text>So in this case we get a rigid factorization of length l+2, l+3 or l+4.</text></s>
<s sid="1152"><CoreSc1 advantage="None" conceptID="Res672" novelty="None" type="Res"/><text>(In the case that Vi is non-principal, it is the same one as in Case 2.</text></s>
<s sid="1153"><CoreSc1 advantage="None" conceptID="Res673" novelty="None" type="Res"/><text>In the case that Vi and Wi are both non-principal it is the same as in Case 3 in the same situation.)</text></s>
Case 4b.
<s sid="1154"><CoreSc1 advantage="None" conceptID="Res674" novelty="None" type="Res"/><text>If Ui≇I: Then WiNi¯ and MiVi¯ are both non-principal.</text></s>
<s sid="1155"><CoreSc1 advantage="None" conceptID="Res675" novelty="None" type="Res"/><text>If Wi is principal, but Vi¯ is not, then the second principal factor is necessarily (alNi¯a-l)alMiVi¯, and this cannot be split as a non-trivial product of principal factors.</text></s>
<s sid="1156"><CoreSc1 advantage="None" conceptID="Con155" novelty="None" type="Con"/><text>But transposing Vi¯ to the very left in this factor gives a principal factor Wi¯, hence (alNi¯a-l)alMiVi¯ is not an atom.</text></s>
<s sid="1157"><CoreSc1 advantage="None" conceptID="Con156" novelty="None" type="Con"/><text>Arguing analogously, if Vi¯ is principal but Wi is not, no rigid factorization into atoms is obtained.</text></s>
<s sid="1158"><CoreSc1 advantage="None" conceptID="Con157" novelty="None" type="Con"/><text>Finally, if Wi and Vi are both principal, we get a rigid factorization into 3 atoms.</text></s>
Case 5.
<s sid="1159"><CoreSc1 advantage="None" conceptID="Con158" novelty="None" type="Con"/><text>If 0⩽m⩽l and n=l+1: This is analogous to Case 2.</text></s>
Case 6.
<s sid="1160"><CoreSc1 advantage="None" conceptID="Con159" novelty="None" type="Con"/><text>If m=n=l+1: This is analogous to Case 1.</text></s>
<s sid="1161"><CoreSc1 advantage="None" conceptID="Con160" novelty="None" type="Con"/><text>Since there is at least one i∈[0,r] for which Wi is principal, we get at least one rigid factorization of xl of length 3 from Case 1.</text></s>
<s sid="1162"><CoreSc1 advantage="None" conceptID="Con161" novelty="None" type="Con"/><text>For i=0, Ui≅I, so Case 4 gives at least one factorization with length in [l+2,l+4].</text></s>
<s sid="1163"><CoreSc1 advantage="None" conceptID="Con162" novelty="None" type="Con"/><text>Note that which of the lengths in [l+2,l+4] occur in Case 2, Case 3, and Case 4 depends only on the principality of certain one-sided ideals, and not on l.</text></s>
<s sid="1164"><CoreSc1 advantage="None" conceptID="Con163" novelty="None" type="Con"/><text>Thus we have shown that there exists a set ∅≠E⊂{2,3,4} such that, for any choice of l∈N0,LS•(xl)={3}∪(l+E), and xl has the claimed form xl=ylp with yl∈A(S•) and p a totally positive prime element of OK.</text></s>
<s sid="1165"><CoreSc1 advantage="None" conceptID="Con164" novelty="None" type="Con"/><text>Since S≅R, the same is true for R. □</text></s>
Remark 7.11
1.
<s sid="1166"><CoreSc1 advantage="None" conceptID="Con165" novelty="None" type="Con"/><text>In the proof, the classical OK-orderT=Ol(U)∩⋂j=0rOr(Uj) is maximal at every prime r∈max(OK) with r≠pOK (thus Tr≅M2(OK,r) if r∤pD and Tr is isomorphic to the unique classical maximal OK,r-order in the unique quaternion division algebra over Kr if r|D).</text></s>
<s sid="1167"><CoreSc1 advantage="None" conceptID="Con166" novelty="None" type="Con"/><text>At p=pOK, it is not hard too see by local calculations thatTp≅{(abp2ca+pd)|a,b,c,d∈OK,p}.</text></s>
<s sid="1168"><CoreSc1 advantage="None" conceptID="Con167" novelty="None" type="Con"/><text>But Tp is not a classical Eichler order, and so neither is T.</text></s>
2.
<s sid="1169"><CoreSc1 advantage="None" conceptID="Con168" novelty="None" type="Con"/><text>If r∈max(OK) we can find infinitely many pairwise non-associated totally positive prime elements q∈OK such that r splits in K(-q), and infinitely many pairwise non-associated totally positive prime elements q∈OK such that r is inert in K(-q): We may restrict ourselves to q with NK/Q(q) odd, and qOK≠r.</text></s>
Let r′=r1+vr(4).
<s sid="1170"><CoreSc1 advantage="None" conceptID="Con169" novelty="None" type="Con"/><text>If -q≡1modr′, then -q is a square in OK/r′ and hence r splits in K(-q).</text></s>
<s sid="1171"><CoreSc1 advantage="None" conceptID="Con170" novelty="None" type="Con"/><text>If -q≡amodr′, with a a non-square in OK/r′, then r is inert in K(-q).</text></s>
<s sid="1172"><CoreSc1 advantage="None" conceptID="Con171" novelty="None" type="Con"/><text>It therefore suffices to show that in every class of (OK/r′)× there are infinitely many pairwise non-associated totally positive prime elements of OK.</text></s>
<s sid="1173"><CoreSc1 advantage="None" conceptID="Con172" novelty="None" type="Con"/><text>Since we have the exact sequence1→OK×,+/{x∈OK×,+|x≡r′1}→(OK/r′)×→Cr′+(OK)→C+(OK)→1 (cf.</text></s>
<s sid="1174"><CoreSc1 advantage="None" conceptID="Con173" novelty="None" type="Con"/><text>[43, Lemma 3.2], [44, Exercises VI.1.12, VI.1.13]), it suffices that every class in the kernel of Cr′+(OK)→C+(OK) contains infinitely many pairwise non-associated prime elements.</text></s>
<s sid="1175"><CoreSc1 advantage="None" conceptID="Con174" novelty="None" type="Con"/><text>But this is so, because in fact every class of Cr′+(OK) contains infinitely many pairwise distinct maximal ideals (cf.</text></s>
<s sid="1176"><CoreSc1 advantage="None" conceptID="Con175" novelty="None" type="Con"/><text>[43, Corollary 7 to Proposition 7.9]).</text></s>
3.
<s sid="1177"><CoreSc1 advantage="None" conceptID="Con176" novelty="None" type="Con"/><text>Using the previous observation to find a suitable element a in the proof, we can replace Lemma 7.6 by a simpler one if D≠OK: Choosing the totally positive prime element q∈OK such that a prime divisor r|D splits in K(-q), the field K(-q) does not embed into A at all (see e.g.</text></s>
<s sid="1178"><CoreSc1 advantage="None" conceptID="Con177" novelty="None" type="Con"/><text>[53, Theoreme III.3.8] or [41, Theorem 7.3.3]).</text></s>
<s sid="1179"><CoreSc1 advantage="None" conceptID="Con178" novelty="None" type="Con"/><text>If D=OK, we may make use of the fact that the particular classical order T in the proof is contained in a classical Eichler order of squarefree level p.</text></s>
<s sid="1180"><CoreSc1 advantage="None" conceptID="Con179" novelty="None" type="Con"/><text>Taking q such that p is inert in K(-q), the formulas for counting optimal embeddings [53, Corollaire III.5.12] show that no order of K(-q) embeds into T.</text></s>
<s sid="1181"><CoreSc1 advantage="None" conceptID="Con180" novelty="None" type="Con"/><text>For this approach we only need the qualitative statement of Proposition 7.4, but not the order of magnitude.</text></s>
Proof of Proposition 7.2
<s sid="1182"><CoreSc1 advantage="None" conceptID="Con181" novelty="None" type="Con"/><text>It suffices to prove the claim for n=1.</text></s>
<s sid="1183"><CoreSc1 advantage="None" conceptID="Con182" novelty="None" type="Con"/><text>Let a in R•, and let{I1(1)⁎⋯⁎Ik(1),…,I1(l)⁎⋯⁎Ik(l)}=ZIv(α)⁎(Ra)⊂F(Mv(α)) be the set of all rigid factorizations of Ra in Iv(α).</text></s>
<s sid="1184"><CoreSc1 advantage="None" conceptID="Con183" novelty="None" type="Con"/><text>Using Proposition 7.4, we can choose a totally positive prime element q∈OK with q∤nr(a) and such that there exists an x∈A× with nr(x)=q andx∈T=⋂i=1l⋂j=1kOl(Ij(i))∩Or(Ij(i)).</text></s>
We claim L(xa)=1+L(a).
<s sid="1185"><CoreSc1 advantage="None" conceptID="Con184" novelty="None" type="Con"/><text>The rigid factorizations of Rxa in Iv(α) are given by all possible transpositions of x to any position inI1(i)⁎⋯⁎Im(i)⁎x, for all i∈[1,l].</text></s>
<s sid="1186"><CoreSc1 advantage="None" conceptID="Con185" novelty="None" type="Con"/><text>But, since x∈T, it follows from Lemma 7.9 that any such rigid factorization is of the formI1(i)⁎⋯⁎Im(i)⁎x⁎x-1Im+1(i)x⁎⋯⁎x-1Ik(i)x for m∈[0,k].</text></s>
<s sid="1187"><CoreSc1 advantage="None" conceptID="Res676" novelty="None" type="Res"/><text>We see that for the principal subproducts this does not change anything except insert one additional factor (corresponding to x) at some position.</text></s>
<s sid="1188"><CoreSc1 advantage="None" conceptID="Res677" novelty="None" type="Res"/><text>Thus, for each i∈[1,l], I1(i)⁎⋯⁎Im(i)⁎x⁎x-1Im+1(i)x⁎⋯⁎x-1Ik(i)x gives rise to a rigid factorization of ax in R• of length l+1 if and only if I1(i)⁎⋯⁎Ik(i) gives rise to a rigid factorization of a of length l. □</text></s>
</BODY>
<OTHER>
Acknowledgments
I thank Alfred Geroldinger for suggesting the topic, and him and Franz Halter-Koch for reading preliminary versions of this manuscript and providing many valuable comments.

</OTHER>
</PAPER>