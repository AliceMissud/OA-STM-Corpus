<?xml version="1.0" ?><PAPER><mode2 hasDoc="yes" name="S0378383913001567.tmf1" version="elsevier"/>
<TITLE>An integral contravariant formulation of the fully non-linear Boussinesq equations
</TITLE>
<ABSTRACT>

Abstract
<s sid="1"><CoreSc1 advantage="None" conceptID="Obj1" novelty="None" type="Obj"/><text>In this paper we propose an integral form of the fully non-linear Boussinesq equations in contravariant formulation, in which Christoffel symbols are avoided, in order to simulate wave transformation phenomena, wave breaking and nearshore currents in computational domains representing the complex morphology of real coastal regions.</text></s>
<s sid="2"><CoreSc1 advantage="None" conceptID="Obj2" novelty="None" type="Obj"/><text>Following the approach proposed by Chen (2006), the motion equations retain the term related to the approximation to the second order of the vertical vorticity.</text></s>
<s sid="3"><CoreSc1 advantage="None" conceptID="Obj3" novelty="None" type="Obj"/><text>A new Upwind Weighted Essentially Non-Oscillatory scheme for the solution of the fully non-linear Boussinesq equations on generalised curvilinear coordinate systems is proposed.</text></s>
<s sid="4"><CoreSc1 advantage="None" conceptID="Obj4" novelty="None" type="Obj"/><text>The equations are rearranged in order to solve them by a high resolution hybrid finite volume-finite difference scheme.</text></s>
<s sid="5"><CoreSc1 advantage="None" conceptID="Mod1" novelty="None" type="Mod"/><text>The conservative part of the above-mentioned equations, consisting of the convective terms and the terms related to the free surface elevation, is discretised by a high-order shock-capturing finite volume scheme in which an exact Riemann solver is involved; dispersive terms and the term related to the approximation to the second order of the vertical vorticity are discretised by a cell-centred finite difference scheme.</text></s>
<s sid="6"><CoreSc1 advantage="None" conceptID="Mod2" novelty="None" type="Mod"/><text>The shock-capturing method makes it possible to intrinsically model the wave breaking, therefore no additional terms are needed to take into account the breaking related energy dissipation in the surf zone.</text></s>
<s sid="7"><CoreSc1 advantage="None" conceptID="Obj5" novelty="None" type="Obj"/><text>The model is verified against several benchmark tests, and the results are compared with experimental, theoretical and alternative numerical solutions.</text></s>
Highlights
•
<s sid="8"><CoreSc1 advantage="None" conceptID="Obj6" novelty="None" type="Obj"/><text>We propose a contravariant formulation of the fully non-linear Boussinesq equations.</text></s>
•
<s sid="9"><CoreSc1 advantage="None" conceptID="Obj7" novelty="None" type="Obj"/><text>The presented contravariant formulation is free of Christoffel symbols.</text></s>
•
<s sid="10"><CoreSc1 advantage="None" conceptID="Obj8" novelty="None" type="Obj"/><text>The equations retain the approximation to the second order of the vertical vorticity.</text></s>
•
<s sid="11"><CoreSc1 advantage="None" conceptID="Obj9" novelty="None" type="Obj"/><text>We present a new Upwind Weighted Essentially Non-Oscillatory scheme.</text></s>
•
<s sid="12"><CoreSc1 advantage="None" conceptID="Obj10" novelty="None" type="Obj"/><text>The shock-capturing scheme allows an explicit simulation of the wave breaking.</text></s>
</ABSTRACT>
<BODY>

Introduction
<s sid="13"><CoreSc1 advantage="None" conceptID="Obj11" novelty="None" type="Obj"/><text>The modelling of surface wave transformation phenomena in coastal regions and breaking waves are of fundamental importance for the simulation of the surf zone hydrodynamics.</text></s>
<s sid="14"><CoreSc1 advantage="None" conceptID="Bac1" novelty="None" type="Bac"/><text>The two-dimensional Boussinesq equations make it possible to represent most of the above-mentioned phenomena.</text></s>
<s sid="15"><CoreSc1 advantage="None" conceptID="Bac2" novelty="None" type="Bac"/><text>These equations arise from the depth integration of the Euler equations once the depth dependence of the variables is known.</text></s>
<s sid="16"><CoreSc1 advantage="None" conceptID="Met1" novelty="None" type="Met"/><text>The standard Boussinesq equations are based on the assumption of linear distribution over the depth of the vertical component of the velocity and encompass frequency dispersion by taking into account the effects of the vertical acceleration on the pressure vertical distribution.</text></s>
<s sid="17"><CoreSc1 advantage="None" conceptID="Res1" novelty="None" type="Res"/><text>The most common forms of the standard Boussinesq equations include the lowest order of both frequency dispersion and non-linearities and are able to adequately represent wave phenomena only in a range of values of the water depth, h0, to deep water wave length, L0, ratio up to 0.2.</text></s>
<s sid="18"><CoreSc1 advantage="None" conceptID="Res2" novelty="None" type="Res"/><text>Madsen and Sørensen (1992) proposed an extended form of the Boussinesq equations, expressed in function of the depth averaged velocity, which allowed the representation of wave phenomena even in regions where the h0/L0 ratio is close to 0.5.</text></s>
<s sid="19"><CoreSc1 advantage="None" conceptID="Obj12" novelty="None" type="Obj"/><text>By introducing an additional third order term, which can be thought as a slight modification of the Padé approximant of the full dispersive relation, in the depth integrated momentum equation, Madsen and Sørensen (1992) improved the dispersion properties of the Standard Boussinesq equations.</text></s>
<s sid="20"><CoreSc1 advantage="None" conceptID="Obj13" novelty="None" type="Obj"/><text>Nwogu (1993) derived an alternative form of the extended Boussinesq equations in which the dependent variable was the velocity at an arbitrary distance from the still water level.</text></s>
<s sid="21"><CoreSc1 advantage="None" conceptID="Obj14" novelty="None" type="Obj"/><text>Nwogu (1993) improved the linear dispersion properties of the standard Boussinesq equations retaining terms up to O(ε) and O(μ2) in variable depth power expansion, where ε=a0/h0 and μ=h0/L0 are non-dimensional parameters related to the order of magnitude of non-linearities and frequency dispersion and a0 is the deep water wave amplitude.</text></s>
<s sid="22"><CoreSc1 advantage="None" conceptID="Obj15" novelty="None" type="Obj"/><text>Nwogu (1993) included an additional frequency dispersion term in the continuity equation and improved, compared to the Standard Boussinesq equations, the representation of the dispersion phenomena in intermediate and deep water.</text></s>
<s sid="23"><CoreSc1 advantage="None" conceptID="Met2" novelty="None" type="Met"/><text>Wei et al. (1995) followed the Nwogu (1993) approach using the velocity at a certain depth as a dependent variable.</text></s>
<s sid="24"><CoreSc1 advantage="None" conceptID="Met3" novelty="None" type="Met"/><text>They derived a fully non-linear extension of the Boussinesq equations by retaining terms up to O(μ2) and O(εμ2) in variable depth power expansion and consequently improved the accuracy of the model just seaward of the surf zone where the wave height to water depth ratio is essentially equal to 1.</text></s>
<s sid="25"><CoreSc1 advantage="None" conceptID="Met4" novelty="None" type="Met"/><text>Chen et al. (1999) used a model based on the fully non-linear extended Boussinesq equations proposed by Wei et al. (1995) in order to simulate wave phenomena and breaking-induced nearshore circulation.</text></s>
<s sid="26"><CoreSc1 advantage="None" conceptID="Met5" novelty="None" type="Met"/><text>They modelled the wave breaking and energy dissipation in the surf zone by introducing an eddy viscosity term into the governing momentum equation.</text></s>
<s sid="27"><CoreSc1 advantage="None" conceptID="Met6" novelty="None" type="Met"/><text>Velocity and free surface elevation fields obtained by numerical integration of the above-mentioned Boussinesq equations were averaged in time and gave the possibility to predict longshore and rip currents and to simulate the coupled interaction of surface waves and currents.</text></s>
<s sid="28"><CoreSc1 advantage="None" conceptID="Met7" novelty="None" type="Met"/><text>Chen et al. (2003) improved the above-mentioned model by introducing an additional term in the momentum equation in order to ensure the property of vertical vorticity conservation and to improve the simulation of surface waves and longshore currents.</text></s>
<s sid="29"><CoreSc1 advantage="None" conceptID="Met8" novelty="None" type="Met"/><text>Chen et al. (2003) started from the three-dimensional Euler equations in which the convective terms were explicitated directly in terms of vector product between velocity and vorticity.</text></s>
<s sid="30"><CoreSc1 advantage="None" conceptID="Met9" novelty="None" type="Met"/><text>The introduction in the above-mentioned Euler equations of the vertical distribution of the velocity and pressure, obtained by retaining terms up to O(εμ2) and O(μ2) in depth power expansion, and of the vertical component of the vorticity gave a new form of the Boussinesq type momentum equation for the partially rotational motion.</text></s>
<s sid="31"><CoreSc1 advantage="None" conceptID="Res3" novelty="None" type="Res"/><text>The vertical vorticity conservation is correct to the second order consistently with the order of approximation for the wave motion.</text></s>
<s sid="32"><CoreSc1 advantage="None" conceptID="Bac3" novelty="None" type="Bac"/><text>Erduran et al. (2005) proposed a method for the solution of the extended Boussinesq equations, in the form proposed by Madsen and Sørensen (1992), based on a hybrid scheme consisting of finite volume and finite difference procedures.</text></s>
<s sid="33"><CoreSc1 advantage="None" conceptID="Bac4" novelty="None" type="Bac"/><text>The governing equations were rearranged to obtain a conservative part that can be treated by a finite volume method.</text></s>
<s sid="34"><CoreSc1 advantage="None" conceptID="Bac5" novelty="None" type="Bac"/><text>The remaining terms in the depth averaged momentum equation were considered as source and sink terms and discretised by a finite difference method.</text></s>
<s sid="35"><CoreSc1 advantage="None" conceptID="Bac6" novelty="None" type="Bac"/><text>The presence of the dispersive terms in the Boussinesq equations balances the amplitude dispersion phenomenon and makes the wave fronts stable.</text></s>
<s sid="36"><CoreSc1 advantage="None" conceptID="Bac7" novelty="None" type="Bac"/><text>For this reason the Boussinesq equations are not able to automatically and intrinsecally represent shallow water wave breaking.</text></s>
<s sid="37"><CoreSc1 advantage="None" conceptID="Bac8" novelty="None" type="Bac"/><text>Many authors introduce breaking dissipation schemes in the Boussinesq equations which have to be applied in the surf zone.</text></s>
<s sid="38"><CoreSc1 advantage="None" conceptID="Bac9" novelty="None" type="Bac"/><text>Zelt (1991), Karambas and Koutitas (1992) and Kennedy et al. (2000) provide a wave breaking model in the form of an eddy viscosity term added to the momentum equation.</text></s>
<s sid="39"><CoreSc1 advantage="None" conceptID="Bac10" novelty="None" type="Bac"/><text>This term takes into account the energy dissipation due to the wave breaking induced turbulence.</text></s>
<s sid="40"><CoreSc1 advantage="None" conceptID="Mod3" novelty="None" type="Mod"/><text>Different methods are based on the surface roller concept introduced by Svendsen (1984): the underlying idea is that the surface roller can be considered as a volume of water carried by the wave.</text></s>
<s sid="41"><CoreSc1 advantage="None" conceptID="Mod4" novelty="None" type="Mod"/><text>In the wave breaking model proposed by Schäffer et al. (1993) and Madsen et al. (1997), the roller propagates with the wave celerity and the velocity below the roller is obtained from the irrotational theory.</text></s>
<s sid="42"><CoreSc1 advantage="None" conceptID="Res4" novelty="None" type="Res"/><text>This leads to additional terms in the momentum equation and consequently in an increase of momentum flux which simulates wave breaking.</text></s>
<s sid="43"><CoreSc1 advantage="None" conceptID="Met10" novelty="None" type="Met"/><text>By the consideration that in the surf zones, the wave breaking induced energy dissipation is substantially related to the breaking generated vorticity, Svendsen et al. (1996), Veeramony and Svendsen (2000) and Musumeci et al. (2005) solved the vorticity transport equation in order to simulate the vorticity vertical distribution.</text></s>
<s sid="44"><CoreSc1 advantage="None" conceptID="Met11" novelty="None" type="Met"/><text>In the above-mentioned models the dissipation term due to the wave breaking is related to the presence of the vorticity.</text></s>
<s sid="45"><CoreSc1 advantage="None" conceptID="Met12" novelty="None" type="Met"/><text>As the weak solutions of the integral form of the motion equations (numerically solved by a shock-capturing scheme) are able to directly simulate wave breaking, the explicit introduction in the equations of terms representing the breaking wave dissipation is not necessary.</text></s>
<s sid="46"><CoreSc1 advantage="None" conceptID="Met13" novelty="None" type="Met"/><text>Shock-capturing schemes permit an explicit simulation of the wave breaking phenomenon, thus these schemes do not require any empirical calibration.</text></s>
<s sid="47"><CoreSc1 advantage="None" conceptID="Met14" novelty="None" type="Met"/><text>Hybrid methods have been recently used by many authors in order to take advantage of the shock capturing methods in simulating breaking waves.</text></s>
<s sid="48"><CoreSc1 advantage="None" conceptID="Met15" novelty="None" type="Met"/><text>Tonelli and Petti (2009) extended the hybrid scheme proposed by Erduran et al. (2005) to the two-dimensional Madsen and Sørensen (1992) equations seaward of the surf zone and implemented a shock-capturing method for the solution of the non-linear shallow water equations in the surf zone: the Riemann problem was solved by an approximated HLL solver and a MUSCL-TVD technique was used for fourth order reconstructions.</text></s>
<s sid="49"><CoreSc1 advantage="None" conceptID="Met16" novelty="None" type="Met"/><text>Roeber et al. (2010) solved Nwogu's (1993) one-dimensional equations by a hybrid scheme including a shock capturing method based on a Godunov-type procedure; they introduced an eddy viscosity term into the governing equation in order to control the instabilities produced by the sharp gradients of transport quantities.</text></s>
<s sid="50"><CoreSc1 advantage="None" conceptID="Met17" novelty="None" type="Met"/><text>Shi et al. (2012) modified the fully non-linear Boussinesq equations proposed by Chen (2006) by introducing a moving reference level, presented for the first time by Kennedy et al. (2001), in order to optimise the non-linear behaviour of the resulting model equations.</text></s>
<s sid="51"><CoreSc1 advantage="None" conceptID="Met18" novelty="None" type="Met"/><text>The governing equations were written in conservative form with an approximated Riemann solver and a MUSCL technique being used.</text></s>
<s sid="52"><CoreSc1 advantage="None" conceptID="Met19" novelty="None" type="Met"/><text>Shi et al. (2012) followed the Tonelli and Petti (2009) approach in modelling wave breaking: the Boussinesq equations switched into the non-linear shallow water equations where the Froude number exceeds a certain threshold.</text></s>
<s sid="53"><CoreSc1 advantage="None" conceptID="Met20" novelty="None" type="Met"/><text>In this paper a new integral form of the fully non-linear Boussinesq equations in contravariant formulation is proposed in order to simulate wave evolution, wave breaking and breaking-induced nearshore currents in computational domains representing the complex morphology of real coastal regions.</text></s>
<s sid="54"><CoreSc1 advantage="None" conceptID="Met21" novelty="None" type="Met"/><text>Following the approach proposed by Chen (2006), motion equations retain the term related to the second order vertical vorticity.</text></s>
<s sid="55"><CoreSc1 advantage="None" conceptID="Met22" novelty="None" type="Met"/><text>Breaking wave propagation in the surf zone is simulated with a high-order shock-capturing scheme: an exact Riemann solver and a WENO reconstruction technique are used.</text></s>
<s sid="56"><CoreSc1 advantage="None" conceptID="Met23" novelty="None" type="Met"/><text>The computation of flows over domains representing the complex morphology of real cases can be carried out using two different strategies.</text></s>
<s sid="57"><CoreSc1 advantage="None" conceptID="Met24" novelty="None" type="Met"/><text>The first of these strategies is based on the use of unstructured grids (Hu and Shu (1999), Petti and Bosa (2007), Mandal and Rao (2011), Sørensen et al. (2004), Arminjon and St-Cyr (2003), Gallerano and Napoli (1999), Gallerano et al. (2005), Titarev and Drikakis (2011), Cioffi et al. (2005)).</text></s>
<s sid="58"><CoreSc1 advantage="None" conceptID="Bac11" novelty="None" type="Bac"/><text>The second of these strategies is based on the use of computational cells that result from the intersection of curvilinear boundary conforming coordinate lines.</text></s>
<s sid="59"><CoreSc1 advantage="None" conceptID="Bac12" novelty="None" type="Bac"/><text>By adopting the latter strategy the motion equations can be expressed in contravariant formulation (Luo and Bewley (2004), Gallerano and Cannata (2011a), Rossmanith et al. (2004), Wesseling et al. (1999), Zijlema et al. (1995), Segal et al. (1992)).</text></s>
<s sid="60"><CoreSc1 advantage="None" conceptID="Bac13" novelty="None" type="Bac"/><text>In numerical solutions of motion equations in contravariant formulation, a contradiction related to the presence of Christoffel symbols appears.</text></s>
<s sid="61"><CoreSc1 advantage="None" conceptID="Bac14" novelty="None" type="Bac"/><text>It is well known that non-conservative forms of the convective terms present in the conservation laws do not permit numerical methods for the solution of the above-mentioned laws to converge to weak solutions.</text></s>
<s sid="62"><CoreSc1 advantage="None" conceptID="Bac15" novelty="None" type="Bac"/><text>Consequently the integration of the conservation laws in the solutions of which shocks are present, requires convective terms to be expressed in conservative form.</text></s>
<s sid="63"><CoreSc1 advantage="None" conceptID="Bac16" novelty="None" type="Bac"/><text>The contravariant formulation of motion equations involves covariant derivatives that give rise to Christoffel symbols.</text></s>
<s sid="64"><CoreSc1 advantage="None" conceptID="Bac17" novelty="None" type="Bac"/><text>These terms are extra source terms.</text></s>
<s sid="65"><CoreSc1 advantage="None" conceptID="Bac18" novelty="None" type="Bac"/><text>They come in with the variability of base vectors and do not permit the definition of convective terms in a conservative form.</text></s>
<s sid="66"><CoreSc1 advantage="None" conceptID="Bac19" novelty="None" type="Bac"/><text>Furthermore, computational errors can be produced by numerical discretisation of the Christoffel symbols on highly distorted grids and the numerical accuracy can be reduced.</text></s>
<s sid="67"><CoreSc1 advantage="None" conceptID="Bac20" novelty="None" type="Bac"/><text>Consequently the contravariant fully non-linear Boussinesq equations, numerically integrated on generalised boundary conforming curvilinear grids, must be free of Christoffel symbols.</text></s>
<s sid="68"><CoreSc1 advantage="None" conceptID="Obj16" novelty="None" type="Obj"/><text>In this work a new Upwind Weighted Essentially Non-Oscillatory scheme is proposed for the solution of the fully non-linear Boussinesq equations.</text></s>
<s sid="69"><CoreSc1 advantage="None" conceptID="Obj17" novelty="None" type="Obj"/><text>A new integral form for this set of equations expressed directly in contravariant formulation is presented.</text></s>
<s sid="70"><CoreSc1 advantage="None" conceptID="Met25" novelty="None" type="Met"/><text>In order to avoid Christoffel symbols, the contravariant form of the motion equations is integrated on an arbitrary surface and is resolved in the direction identified by a constant parallel vector field.</text></s>
<s sid="71"><CoreSc1 advantage="None" conceptID="Met26" novelty="None" type="Met"/><text>In this way we present an integral form of the contravariant fully non-linear Boussinesq equations in which Christoffel symbols are avoided.</text></s>
<s sid="72"><CoreSc1 advantage="None" conceptID="Met27" novelty="None" type="Met"/><text>The equations are solved by a hybrid finite volume-finite difference scheme.</text></s>
<s sid="73"><CoreSc1 advantage="None" conceptID="Mod5" novelty="None" type="Mod"/><text>Convective terms and terms related to the free surface elevation gradient are discretised by a high order finite volume upwind WENO scheme; dispersive terms and the term related to the second order vertical vorticity are discretised by a finite-difference scheme.</text></s>
<s sid="74"><CoreSc1 advantage="None" conceptID="Met28" novelty="None" type="Met"/><text>The upwind WENO scheme needs a flux calculation at the cell interfaces.</text></s>
<s sid="75"><CoreSc1 advantage="None" conceptID="Met29" novelty="None" type="Met"/><text>These fluxes are calculated by means of the solution of a Riemann problem.</text></s>
<s sid="76"><CoreSc1 advantage="None" conceptID="Met30" novelty="None" type="Met"/><text>An Exact Riemann Solver is used in this work.</text></s>
<s sid="77"><CoreSc1 advantage="None" conceptID="Res5" novelty="None" type="Res"/><text>No additional dissipative term to improve the modelling of breaking related energy decay and breaking induced nearshore circulation is used in this paper.</text></s>
<s sid="78"><CoreSc1 advantage="None" conceptID="Res6" novelty="None" type="Res"/><text>The paper is organised as follows: the conservative form of the Cartesian fully non-linear Boussinesq equations is presented in Section 2; the integral form of the contravariant fully non-linear Boussinesq equations is presented in Section 3; Section 4 shows the numerical scheme used to solve the equations; in Section 5 accuracy tests and applications to problems of wave breaking and nearshore currents are presented and conclusions are made in Section 6.</text></s>
<s sid="79"><CoreSc1 advantage="None" conceptID="Res7" novelty="None" type="Res"/><text>Conservative form of the Cartesian fully non-linear Boussinesq equations</text></s>
<s sid="80"><CoreSc1 advantage="None" conceptID="Mod6" novelty="None" type="Mod"/><text>Let H=h+η be the total local water depth, where h is the local still water depth and η is the local surface displacement.</text></s>
<s sid="81"><CoreSc1 advantage="None" conceptID="Mod7" novelty="None" type="Mod"/><text>Using a Taylor expansion of the velocity about an arbitrary distance from the still water surface, σ, and assuming zero horizontal vorticity, as proposed by Nwogu (1993), Wei et al. (1995), Chen et al. (2003) and Chen (2006), the vertical distribution of the horizontal velocity can be written as:(1)u→=u→α+u→2zwhere u→α is the horizontal velocity at an arbitrary distance from the still water level, z=σ and u→2z=σ-z∇∇⋅hu→α+σ2/2-z2/2∇∇⋅u→α consists of the second order terms in depth power expansion of the velocity vector in which ∇ is the two-dimensional differential operator defined as ∇=(∂/∂x,∂/∂y) in a Cartesian reference system.</text></s>
<s sid="82"><CoreSc1 advantage="None" conceptID="Mod8" novelty="None" type="Mod"/><text>The following vectors can be defined: r→=Hu→α and s→=Hu¯→2, in which u¯→2 is the depth averaged value of u→2z.</text></s>
<s sid="83"><CoreSc1 advantage="None" conceptID="Mod9" novelty="None" type="Mod"/><text>The explicit expression of s→ is reported in Appendix A.</text></s>
<s sid="84"><CoreSc1 advantage="None" conceptID="Mod10" novelty="None" type="Mod"/><text>The fully non-linear Boussinesq equations expressed in a conservative form in a two-dimensional Cartesian system as a function of the dependent variables H and r→ are:(2)∂H∂t+∇⋅r→=-∇⋅s→(3)∂r→∂t+∇⋅r→⊗r→H+GH∇η=-r→H∇⋅s→-HV→+T→+W→-R→where ⊗ is the tensor product between vectors, G is the constant of gravity, V→ and T→ are the dispersive terms obtained by retaining terms up to O(μ2) and O(εμ2) in depth power expansions of the horizontal velocity according to Wei et al. (1995a), W→ is the term related to the approximation to the second order of the vertical component of the vorticity according to Chen(2006) and R→ is the bottom resistance term.</text></s>
<s sid="85"><CoreSc1 advantage="None" conceptID="Obs1" novelty="None" type="Obs"/><text>The expressions for V→, T→ and W→ are given in the Appendix A.</text></s>
<s sid="86"><CoreSc1 advantage="None" conceptID="Met31" novelty="None" type="Met"/><text>Finite volume methods are effective tools for the numerical integration of depth integrated motion equations in nearshore regions and allow an adequate representation of the breaking waves.</text></s>
<s sid="87"><CoreSc1 advantage="None" conceptID="Bac21" novelty="None" type="Bac"/><text>Their application to the Boussinesq equations is not straightforward because of the presence of high order derivatives in dispersive terms on the right-hand side of Eq.</text></s>
(3).
<s sid="88"><CoreSc1 advantage="None" conceptID="Bac22" novelty="None" type="Bac"/><text>It is possible to rearrange the Eq.</text></s>
<s sid="89"><CoreSc1 advantage="None" conceptID="Bac23" novelty="None" type="Bac"/><text>(3) in order to obtain a momentum equation that can be numerically solved by a hybrid finite volume-finite difference scheme, as suggested by Erduran et al. (2005), Tonelli and Petti (2012) and Shi et al. (2012).</text></s>
<s sid="90"><CoreSc1 advantage="None" conceptID="Goa1" novelty="None" type="Goa"/><text>In order to obtain a system of motion equations in which a conservative part to be solved by a finite volume shock-capturing scheme is present, let us:a)</text></s>
<s sid="91"><CoreSc1 advantage="None" conceptID="Mod11" novelty="None" type="Mod"/><text>Decompose the term HV→ on the right-hand side of Eq.</text></s>
<s sid="92"><CoreSc1 advantage="None" conceptID="Mod12" novelty="None" type="Mod"/><text>(3) according to Wei and Kirby (1995):(4)HV→=∂∂tHV→'-∂H∂tV→'+HV→''where the expressions for V→' and V→'' are given in the Appendix A;</text></s>
b)
<s sid="93"><CoreSc1 advantage="None" conceptID="Mod13" novelty="None" type="Mod"/><text>Rewrite the free surface elevation term on the left-hand side of Eq.(3) as:(5)GH∇η=GH∇H-H∇h=G∇H22-H∇h</text></s>
c)
<s sid="94"><CoreSc1 advantage="None" conceptID="Mod14" novelty="None" type="Mod"/><text>Introduce the auxiliary variable r→* defined as:(6)r→*=r→+HV→'</text></s>
<s sid="95"><CoreSc1 advantage="None" conceptID="Mod15" novelty="None" type="Mod"/><text>Expressions (4), (5) and (6) permit us to rewrite the Eq.</text></s>
<s sid="96"><CoreSc1 advantage="None" conceptID="Mod16" novelty="None" type="Mod"/><text>(3) in the following form:(7)∂r→*∂t+∇⋅r→⊗r→H+G∇H22=GH∇h-R→-r→H∇⋅s→+∂H∂tV→'-HV→''-HT→-HW→</text></s>
<s sid="97"><CoreSc1 advantage="None" conceptID="Mod17" novelty="None" type="Mod"/><text>The dependent variables of the new system of Eqs.</text></s>
<s sid="98"><CoreSc1 advantage="None" conceptID="Mod18" novelty="None" type="Mod"/><text>(2) and (7) are H and r→*.</text></s>
<s sid="99"><CoreSc1 advantage="None" conceptID="Mod19" novelty="None" type="Mod"/><text>The conservative part at the left-hand side of Eqs.</text></s>
<s sid="100"><CoreSc1 advantage="None" conceptID="Mod20" novelty="None" type="Mod"/><text>(2) and (7), consisting of the dispersive terms and the terms related to the free surface elevation, can be numerically solved by a shock-capturing finite volume scheme whereas the terms at the right-hand side of the above-mentioned equations can be discretised by a cell-centred finite difference scheme.</text></s>
<s sid="101"><CoreSc1 advantage="None" conceptID="Mod21" novelty="None" type="Mod"/><text>Integral form of the contravariant fully non-linear Boussinesq equations</text></s>
Let us rewrite Eqs.
<s sid="102"><CoreSc1 advantage="None" conceptID="Mod22" novelty="None" type="Mod"/><text>(2) and (7) in contravariant formulation in a two-dimensional system of generalised curvilinear coordinates.</text></s>
<s sid="103"><CoreSc1 advantage="None" conceptID="Mod23" novelty="None" type="Mod"/><text>We consider a transformation xl=xl(ξ1,ξ2) from the Cartesian coordinates x→ to the curvilinear coordinates ξ→ (note that hereinafter the superscript indicates the generic component and not the powers).</text></s>
<s sid="104"><CoreSc1 advantage="None" conceptID="Mod24" novelty="None" type="Mod"/><text>Let g→l=∂x→/∂ξl be the covariant base vectors and g→l=∂ξl/∂x→ the contravariant base vectors.</text></s>
<s sid="105"><CoreSc1 advantage="None" conceptID="Mod25" novelty="None" type="Mod"/><text>The metric tensor and its inverse are defined, respectively, by glm=g→l⋅g→m and glm=g→l⋅g→ml,m=1,2.</text></s>
<s sid="106"><CoreSc1 advantage="None" conceptID="Mod26" novelty="None" type="Mod"/><text>The Jacobian of the transformation is g=detglm.</text></s>
<s sid="107"><CoreSc1 advantage="None" conceptID="Mod27" novelty="None" type="Mod"/><text>The transformation relationships between the components of the generic vector b→ in the Cartesian coordinate system and its contravariant and covariant components, bl and bl, in the curvilinear coordinate system are given by:(8)bl=g→l⋅b→,b→=blg→l,bl=g→l⋅b→b→=blg→l</text></s>
<s sid="108"><CoreSc1 advantage="None" conceptID="Mod28" novelty="None" type="Mod"/><text>In the following equations, a comma with an index in a subscript stands for covariant differentiation.</text></s>
<s sid="109"><CoreSc1 advantage="None" conceptID="Mod29" novelty="None" type="Mod"/><text>The covariant derivative is defined as b,ml=∂bl/∂ξm+Γmklbk, where Γmkl is the Christoffel symbol (Aris, 1989) given by:(9)Γmkl=g→l⋅∂g→k/∂ξm</text></s>
<s sid="110"><CoreSc1 advantage="None" conceptID="Mod30" novelty="None" type="Mod"/><text>Let r*l be the l-th contravariant component of the vector r→* defined by the expression (6).</text></s>
r*l is given by:(10)r*l=rl+HV'l
<s sid="111"><CoreSc1 advantage="None" conceptID="Mod31" novelty="None" type="Mod"/><text>The differential contravariant form of the continuity Eq.</text></s>
(2) and momentum Eq.
<s sid="112"><CoreSc1 advantage="None" conceptID="Mod32" novelty="None" type="Mod"/><text>(7) can be expressed as:(11)∂H∂t+rm,m=-sm,m(12)∂r*l∂t+rlrmH+GglmH22,m=GHglmh,m-Rl-rlHsm,m+∂H∂tV'l-HV''l-HTl-HWl</text></s>
In Eq.
<s sid="113"><CoreSc1 advantage="None" conceptID="Mod33" novelty="None" type="Mod"/><text>(11) the second term on the left-hand side is the flux term.</text></s>
In Eq.
<s sid="114"><CoreSc1 advantage="None" conceptID="Mod34" novelty="None" type="Mod"/><text>(12) the second term on the left-hand side is the flux term, the first term on the right-hand side is the source term related to the bottom slope, the second term on the right-hand side, Rl is the bottom resistance term approximated by a quadratic law as in Tonelli and Petti (2012).</text></s>
<s sid="115"><CoreSc1 advantage="None" conceptID="Obs2" novelty="None" type="Obs"/><text>Expressions for terms sl, V'l, V″l, Tl and Wl are given in the Appendix B.</text></s>
<s sid="116"><CoreSc1 advantage="None" conceptID="Obs3" novelty="None" type="Obs"/><text>The integration on the generic surface element of area ΔA of Eqs.</text></s>
<s sid="117"><CoreSc1 advantage="None" conceptID="Obs4" novelty="None" type="Obs"/><text>(11) and (12) results in the following expressions:(13)∬ΔA∂H∂tdA+∬ΔArl,ldA+∬ΔAsl,ldA=0(14)∬ΔA∂r*l∂tdA+∬ΔArlrmH+GglmH22,mdA=∬ΔAGHglmh,mdA-∬ΔARldA-∬ΔArlHsm,mdA+∬ΔA∂H∂tV'ldA-∬ΔAHV''ldA-∬ΔAHTldA-∬ΔAHWldAin which the covariant derivative in the second integral at the left-hand side of Eq.</text></s>
<s sid="118"><CoreSc1 advantage="None" conceptID="Res8" novelty="None" type="Res"/><text>(14) does not allow the avoidance of the appearance of the Christoffel symbols.</text></s>
<s sid="119"><CoreSc1 advantage="None" conceptID="Goa2" novelty="None" type="Goa"/><text>Our main goal is to formalise an integral expression of the contravariant fully non-linear Boussinesq equations in which the Christoffel symbols are absent.</text></s>
<s sid="120"><CoreSc1 advantage="None" conceptID="Res9" novelty="None" type="Res"/><text>From a general point of view, in order to express the momentum equation in an integral form, the rate of change of the momentum in a material volume and the total net force must be projected along a physical direction.</text></s>
<s sid="121"><CoreSc1 advantage="None" conceptID="Res10" novelty="None" type="Res"/><text>A given curvilinear coordinate line changes its direction in space unlike what happens in a Cartesian reference system.</text></s>
<s sid="122"><CoreSc1 advantage="None" conceptID="Res11" novelty="None" type="Res"/><text>Consequently, the volume integral of the projection of the motion equations along a curvilinear coordinate line has no physical meaning, since it does not represent the volume integral of the projection of the above-mentioned equations along a physical direction (Aris, 1989).</text></s>
<s sid="123"><CoreSc1 advantage="None" conceptID="Obj18" novelty="None" type="Obj"/><text>Let us consider a constant parallel vector field and equate the rate of change of the momentum of a material volume to the total net force in this direction.</text></s>
<s sid="124"><CoreSc1 advantage="None" conceptID="Mod35" novelty="None" type="Mod"/><text>We choose, as a parallel vector field, the one which is normal to the coordinate line on which the ξl component is constant at point P0∈ΔA whose coordinates are ξ01 and ξ02.</text></s>
<s sid="125"><CoreSc1 advantage="None" conceptID="Mod36" novelty="None" type="Mod"/><text>In this work, following the approach proposed in Gallerano and Cannata (2011b), we use the contravariant base vector defined at point P0 which is normal to the coordinate line on which ξl is constant in order to identify the parallel vector field.</text></s>
<s sid="126"><CoreSc1 advantage="None" conceptID="Mod37" novelty="None" type="Mod"/><text>Let λk(ξ1,ξ2) be the covariant component of g→lξ01ξ02, given by:(15)λkξ1ξ2=g→lξ01ξ02⋅g→kξ1ξ2</text></s>
<s sid="127"><CoreSc1 advantage="None" conceptID="Mod38" novelty="None" type="Mod"/><text>We indicate g˜→l=g→lξ01ξ02 and g→k=g→kξ1ξ2.</text></s>
<s sid="128"><CoreSc1 advantage="None" conceptID="Mod39" novelty="None" type="Mod"/><text>We integrate over an arbitrary surface element of area ΔA and resolve in the direction λk the rate of change of the depth integrated momentum (per unit mass) and the depth integrated resultant force (per unit mass).</text></s>
Consequently we get:(16)∬ΔA∂r*k∂tλkdA+∬ΔArkrmH+GgkmH22,mλkdA=∬ΔAGHgkmh,mλkdA-∬ΔARkλkdA-∬ΔArkHsm,mλkdA+∬ΔA∂H∂tV'kλkdA-∬ΔAHV''kλkdA-∬ΔAHTkλkdA-∬ΔAHWkλkdA
<s sid="129"><CoreSc1 advantage="None" conceptID="Mod40" novelty="None" type="Mod"/><text>Since the vector field is constant and parallel, λk,m=0.</text></s>
<s sid="130"><CoreSc1 advantage="None" conceptID="Mod41" novelty="None" type="Mod"/><text>Using Green's theorem for the second integral at the left-hand side of Eq.</text></s>
<s sid="131"><CoreSc1 advantage="None" conceptID="Mod42" novelty="None" type="Mod"/><text>(13) and for the second integral at the left-hand side of Eq.</text></s>
(16), using Eq.
<s sid="132"><CoreSc1 advantage="None" conceptID="Mod43" novelty="None" type="Mod"/><text>(15) and recalling that g→k⋅g→m=δkm, we get:(17)∬ΔA∂H∂tdA+∫LrmnmdL=-∬ΔAsl,ldA∬ΔAg˜→l⋅g→k∂r*k∂tdA+∫Lg˜→l⋅g→krkrmH+Gg˜→l⋅g→mH22nmdL=∬ΔAg˜→l⋅g→kGHgkmh,mdA-∬ΔAg˜→l⋅g→kRkdA-∬ΔAg˜→l⋅g→krkHsm,mdA+∬ΔAg˜→l⋅g→k∂H∂tV'kdA(18)-∬ΔAg˜→l⋅g→kHV''kdA-∬ΔAg˜→l⋅g→kHTkdA-∬ΔAg˜→l⋅g→kHWkdAwhere L is the contour line of ΔA and nm is the m-th component of the covariant outward normal.</text></s>
<s sid="133"><CoreSc1 advantage="None" conceptID="Mod44" novelty="None" type="Mod"/><text>Eqs. (17) and (18) represent the integral expressions of the fully non-linear Boussinesq equations in contravariant formulation in which Christoffel symbols are absent.</text></s>
<s sid="134"><CoreSc1 advantage="None" conceptID="Mod45" novelty="None" type="Mod"/><text>These equations are accurate to O(μ2) and O(εμ2) in dispersive terms and retain the conservation of potential vorticity up to O(μ2), in accordance with the formulation proposed by Chen (2006).</text></s>
<s sid="135"><CoreSc1 advantage="None" conceptID="Mod46" novelty="None" type="Mod"/><text>Let us introduce a restrictive condition on the surface element of area ΔA: in the following this surface element must be considered as a surface element which is bounded by four curves lying on the coordinate lines.</text></s>
<s sid="136"><CoreSc1 advantage="None" conceptID="Mod47" novelty="None" type="Mod"/><text>Since dA=gdξ1dξ2 and by indicating with H¯˜ the averaged value of H over the surface element of area ΔA, given by H¯˜=1/ΔA∬ΔAHgdξ1dξ2, Eq.</text></s>
<s sid="137"><CoreSc1 advantage="None" conceptID="Mod48" novelty="None" type="Mod"/><text>(17) can be rewritten as:(19)∂H¯˜∂t=-1ΔA∑μ=12∫Δξμ+grμdξυ-∫Δξμ-grμdξυ-1ΔA∬ΔA∂skg∂ξkdξ1dξ2where Δξμ+ and Δξμ- indicate the segments of the contour line on which ξμ is constant and which are respectively located at the larger and smaller value of ξμ.</text></s>
In Eq.
<s sid="138"><CoreSc1 advantage="None" conceptID="Mod49" novelty="None" type="Mod"/><text>(19) the indexes μ and ν are cyclic.</text></s>
<s sid="139"><CoreSc1 advantage="None" conceptID="Mod50" novelty="None" type="Mod"/><text>Let us define r¯˜*l as:(20)r¯˜*l=1ΔA∬ΔAg˜→l⋅g→kr*kgdξ1dξ2</text></s>
By dividing Eq.
<s sid="140"><CoreSc1 advantage="None" conceptID="Mod51" novelty="None" type="Mod"/><text>(18) by ΔA and by using Eq.</text></s>
(20), Eq.
<s sid="141"><CoreSc1 advantage="None" conceptID="Mod52" novelty="None" type="Mod"/><text>(18) becomes:(21)∂r¯˜*l∂t=1ΔA-∑μ=12∫Δξμ+g˜→l⋅g→krkrμH+g˜→l⋅g→μGH22gdξυ-∫Δξμ-g˜→l⋅g→krkrμH+g˜→l⋅g→μGH22gdξυ+∬ΔAg˜→l⋅g→kGη-η¯˜gmkh,mgdξ1dξ2+Gη¯˜∑μ=12∫Δξμ+g˜→l⋅g→μhgdξυ-∫Δξμ-g˜→l⋅g→μhgdξυ+G2∑μ=12∫Δξμ+g˜→l⋅g→μh2gdξυ-∫Δξμ-g˜→l⋅g→μh2gdξυ-∬ΔAg˜→l⋅g→kRkgdξ1dξ2-∬ΔAg˜→l⋅g→krkHsm,mgdξ1dξ2+∬ΔAg˜→l⋅g→k∂H∂tV'kgdξ1dξ2-∬ΔAg˜→l⋅g→kHV''kgdξ1dξ2-∬ΔAg˜→l⋅g→kHTkgdξ1dξ2-∬ΔAg˜→l⋅g→kHWkgdξ1dξ2where η is the free surface elevation and η¯ is the averaged value of η over the surface element ΔA.</text></s>
<s sid="142"><CoreSc1 advantage="None" conceptID="Mod53" novelty="None" type="Mod"/><text>The left-hand side of Eq.</text></s>
<s sid="143"><CoreSc1 advantage="None" conceptID="Mod54" novelty="None" type="Mod"/><text>(21) represents the surface average of the time derivative of the l-th contravariant component of the r→* vector expressed as a function of the contravariant base vector g→l defined in ξ01, ξ02.</text></s>
<s sid="144"><CoreSc1 advantage="None" conceptID="Obs5" novelty="None" type="Obs"/><text>The second, third and fourth terms on the right-hand side of Eq.</text></s>
<s sid="145"><CoreSc1 advantage="None" conceptID="Res12" novelty="None" type="Res"/><text>(21) result from the splitting of the term related to the bottom slope, according to Xing and Shu (2006).</text></s>
<s sid="146"><CoreSc1 advantage="None" conceptID="Res13" novelty="None" type="Res"/><text>It must be emphasised that Eqs.</text></s>
<s sid="147"><CoreSc1 advantage="None" conceptID="Res14" novelty="None" type="Res"/><text>(19) and (21) are free of Christoffel symbols.</text></s>
The numerical scheme
<s sid="148"><CoreSc1 advantage="None" conceptID="Res15" novelty="None" type="Res"/><text>The numerical integration of Eqs.</text></s>
<s sid="149"><CoreSc1 advantage="None" conceptID="Mod55" novelty="None" type="Mod"/><text>(19) and (21) is carried out by a high order upwind WENO scheme.</text></s>
<s sid="150"><CoreSc1 advantage="None" conceptID="Mod56" novelty="None" type="Mod"/><text>The computational domain discretisation is based on a grid defined by the coordinate lines ξ1 and ξ2 and by the points of coordinates ξ1=iΔξ1 and ξ2=jΔξ2, which represent the centres of the calculation cells Ii;j=(ξi-1/21,ξi+1/21)×(ξi-1/22,ξi+1/22).</text></s>
<s sid="151"><CoreSc1 advantage="None" conceptID="Mod57" novelty="None" type="Mod"/><text>tn is the time level of the known variables, while tn+1=tn+Δt is the time level of the unknown variables.</text></s>
<s sid="152"><CoreSc1 advantage="None" conceptID="Mod58" novelty="None" type="Mod"/><text>Let us indicate with L(r1,r2) and with LB(S1,S2) respectively the first and the second term on the right-hand side of Eq.</text></s>
(19).
<s sid="153"><CoreSc1 advantage="None" conceptID="Mod59" novelty="None" type="Mod"/><text>Let us indicate with D(H,r1,r2) the sum of the convective and free surface elevation terms (which is split according to Xing and Shu (2006) in order to ensure a well-balanced scheme) on the right-hand side of Eq.</text></s>
<s sid="154"><CoreSc1 advantage="None" conceptID="Mod60" novelty="None" type="Mod"/><text>(21) and with D(H,r1,r2) the bottom friction term, the sum of dispersive terms and the term related to the approximation to the second order of the vertical vorticity on the right-hand side of this equation.</text></s>
By integrating Eqs.
<s sid="155"><CoreSc1 advantage="None" conceptID="Mod61" novelty="None" type="Mod"/><text>(19) and (21) over [tn,tn+1] we get:(22)H≃i;jn+1=H≃i;jn-1ΔA∫tntn+1Lr1r2+LBs1s2dt(23)r≃*i;jln+1=r≃*i;jln-1ΔA∫tntn+1DHr1r2+DBHr1r2s1s2dt</text></s>
<s sid="156"><CoreSc1 advantage="None" conceptID="Mod62" novelty="None" type="Mod"/><text>Eqs. (22) and (23) represent the advancing from time level tn to time level tn+1, of the variables H¯i;j and r≃*i;jl.</text></s>
<s sid="157"><CoreSc1 advantage="None" conceptID="Mod63" novelty="None" type="Mod"/><text>The state of the system is known at the centre of the calculation cell and it is defined by the cell-averaged values H¯i;j and r≃*i;jl.</text></s>
<s sid="158"><CoreSc1 advantage="None" conceptID="Mod64" novelty="None" type="Mod"/><text>In this paper, time integration of Eqs.</text></s>
<s sid="159"><CoreSc1 advantage="None" conceptID="Mod65" novelty="None" type="Mod"/><text>(22) and (23) is carried out by means of a third order accurate Strong Stability Preserving Runge-Kutta method (SSPRK) reported in Spiteri and Ruuth (2002).</text></s>
<s sid="160"><CoreSc1 advantage="None" conceptID="Mod66" novelty="None" type="Mod"/><text>The SSPRK method can be written in compact form as follows:(24)H≃i;j0=H≃i;jn;r¯˜*i;jl0=r¯˜*i;jln(25)H≃i;jp=∑q=0p-1ΩpqHi;jq+ΔtφpqLr1qr2q+LBs1ps2p(26)r≃*i;jlp=∑q=0p-1Ωpqr*i;jlp+ΔtφpqDHqr1qr2q+DBHpr1pr2ps1ps2p(27)H≃i;jn+1=H≃i;j3;r¯˜*i;jln+1=r¯˜*i;jl3where p=1; 2; 3.</text></s>
<s sid="161"><CoreSc1 advantage="None" conceptID="Mod67" novelty="None" type="Mod"/><text>See Spiteri and Ruuth (2002) for Ωpq and φpq values.</text></s>
<s sid="162"><CoreSc1 advantage="None" conceptID="Mod68" novelty="None" type="Mod"/><text>The computation of L(r1,r2), D(H,r1,r2), LB(s1,s2) and DB(H,r1,r2,s1,s2) terms needs the numerical approximation of the spatial integrals on the right-hand side of Eqs.</text></s>
(19) and (21).
<s sid="163"><CoreSc1 advantage="None" conceptID="Mod69" novelty="None" type="Mod"/><text>According to the method proposed by Erduran et al. (2005) and used among the others by Tonelli and Petti (2012) and Shi et al. (2012), this numerical approximation is carried out by means of a hybrid finite volume-finite difference scheme.</text></s>
<s sid="164"><CoreSc1 advantage="None" conceptID="Mod70" novelty="None" type="Mod"/><text>By applying this method, once the values of the auxiliary variable r¯˜*l are known, the values of the original variables r¯˜l at each stage of the Runge-Kutta method are computed by solving the following equation:(28)r≃*l=rl≃+H¯˜V¯˜′lin which V¯′l includes first and second derivative of r¯˜l/H¯˜ with respect to ξ1 and ξ2 and cross derivatives (see Appendix B).</text></s>
<s sid="165"><CoreSc1 advantage="None" conceptID="Mod71" novelty="None" type="Mod"/><text>The numerical approximation of the derivatives in the V¯˜'l term is carried out by a second order central difference scheme.</text></s>
<s sid="166"><CoreSc1 advantage="None" conceptID="Mod72" novelty="None" type="Mod"/><text>The velocity at the elevation σ, averaged over the generic computational cell Ii;j and indicated with r¯˜l/H¯˜i;j can be found by solving a system of equations with tridiagonal matrix formed by Eq.</text></s>
<s sid="167"><CoreSc1 advantage="None" conceptID="Mod73" novelty="None" type="Mod"/><text>(28) in which all cross-derivatives are moved to the right-hand side of the equation.</text></s>
<s sid="168"><CoreSc1 advantage="None" conceptID="Mod74" novelty="None" type="Mod"/><text>Once the values of r¯˜l/H¯˜i;j are known, the LB(s1,s2) and DB(H,r1,r2,s1,s2) terms on the right-hand side of Eqs.</text></s>
<s sid="169"><CoreSc1 advantage="None" conceptID="Mod75" novelty="None" type="Mod"/><text>(25) and (26) are discretised using a second order central difference scheme at the cell centroids, as in Wei and Kirby (1995) and Shi et al. (2012).</text></s>
<s sid="170"><CoreSc1 advantage="None" conceptID="Mod76" novelty="None" type="Mod"/><text>Since the LB and DB terms need to be updated using H,r1,r2,s1,s2 at the corresponding time step, an iteration is needed to achieve convergence, as suggested by Shi et al. (2012).</text></s>
<s sid="171"><CoreSc1 advantage="None" conceptID="Mod77" novelty="None" type="Mod"/><text>Convective terms and terms related to the free surface elevation that define the L(r1,r2) and D(H,r1,r2) terms on the right-hand side of Eqs.</text></s>
<s sid="172"><CoreSc1 advantage="None" conceptID="Mod78" novelty="None" type="Mod"/><text>(25) and (26) are computed by a high-order finite volume WENO scheme.</text></s>
<s sid="173"><CoreSc1 advantage="None" conceptID="Met32" novelty="None" type="Met"/><text>According to the procedure proposed by Gallerano et al. (2012) this numerical scheme is based on the following sequence:1.</text></s>
<s sid="174"><CoreSc1 advantage="None" conceptID="Met33" novelty="None" type="Met"/><text>Starting from cell averaged values, the point values of the unknown variables at the centre of the contour segments which define the calculation cells are computed by means of WENO reconstructions.</text></s>
<s sid="175"><CoreSc1 advantage="None" conceptID="Met34" novelty="None" type="Met"/><text>Two WENO reconstructions defined on two adjacent cells are used to get two point values of the unknown variables at the centre of the contour segment which is common with the two adjacent cells.</text></s>
2.
<s sid="176"><CoreSc1 advantage="None" conceptID="Met35" novelty="None" type="Met"/><text>The point values of the unknown variables at the centre of the contour segments are advanced in time by means of the so-called exact solution of a local Riemann problem, with initial data given by the pair of point-values computed by two WENO reconstructions defined on the two adjacent cells.</text></s>
<s sid="177"><CoreSc1 advantage="None" conceptID="Met36" novelty="None" type="Met"/><text>In accordance with the procedure proposed by Rossmanith et al. (2004), all necessary Riemann problems are solved in a locally valid orthonormal basis.</text></s>
<s sid="178"><CoreSc1 advantage="None" conceptID="Mod79" novelty="None" type="Mod"/><text>This orthonormalisation allows one to solve Cartesian Riemann problems that are devoid of geometric terms.</text></s>
3.
<s sid="179"><CoreSc1 advantage="None" conceptID="Mod80" novelty="None" type="Mod"/><text>The spatial integrals that define the L(r1,r2) and D(H,r1,r2) terms are numerically approximated by means of a high order quadrature rule, starting from point values of the dependent variables computed at the previous step.</text></s>
Results
<s sid="180"><CoreSc1 advantage="None" conceptID="Mod81" novelty="None" type="Mod"/><text>In this section the proposed scheme for the solution of the fully non-linear Boussinesq equations in contravariant form, expressed by Eqs.</text></s>
<s sid="181"><CoreSc1 advantage="None" conceptID="Exp1" novelty="None" type="Exp"/><text>(19) and (21), is tested against a set of benchmark test cases.</text></s>
<s sid="182"><CoreSc1 advantage="None" conceptID="Exp2" novelty="None" type="Exp"/><text>In all the tests, simulations are carried out by switching from Boussinesq equations to non-linear shallow water equations when the wave height to water depth ratio is equal to 0.8, according to Tonelli and Petti (2012) and Shi et al. (2012).</text></s>
<s sid="183"><CoreSc1 advantage="None" conceptID="Exp3" novelty="None" type="Exp"/><text>1D: Breaking on a sloping beach</text></s>
<s sid="184"><CoreSc1 advantage="None" conceptID="Exp4" novelty="None" type="Exp"/><text>The results from the model described in the previous Sections are first compared to a set of experimental data with regular waves performed by Hansen and Svendsen (1979).</text></s>
<s sid="185"><CoreSc1 advantage="None" conceptID="Exp5" novelty="None" type="Exp"/><text>The experiments were conducted in a 40m long wave flume with a horizontal bottom at a depth of 0.36m and a planar slope of 1:34.26 where waves shoal and break (see Fig. 1).</text></s>
<s sid="186"><CoreSc1 advantage="None" conceptID="Obj19" novelty="None" type="Obj"/><text>This test permits us to verify the ability of the model to represent phenomena of shoaling, breaking and after breaking wave energy decay.</text></s>
<s sid="187"><CoreSc1 advantage="None" conceptID="Goa3" novelty="None" type="Goa"/><text>The results obtained with the model presented in this paper are also compared with the results obtained by applying the numerical integration procedure described in Section 4 to the one-dimensional weakly non-linear Boussinesq equations proposed by Madsen and Sørensen (1992) and to those proposed by Nwogu (1993).</text></s>
<s sid="188"><CoreSc1 advantage="None" conceptID="Obs6" novelty="None" type="Obs"/><text>Table 1 reports the period and wave heights at the start of the slope for the test cases simulated.</text></s>
<s sid="189"><CoreSc1 advantage="None" conceptID="Obs7" novelty="None" type="Obs"/><text>The spatial discretisation is Δx=0.02m and the time step is Δt=0.005s.</text></s>
<s sid="190"><CoreSc1 advantage="None" conceptID="Obs8" novelty="None" type="Obs"/><text>Figs. 2 and 3 show the comparison between computed and measured time-averaged wave heights as the waves propagate up the slope respectively for test cases 1 and 2: the computed values are obtained by using Madsen's equations, Nwogu's equations and the proposed fully non-linear Boussinesq model.</text></s>
<s sid="191"><CoreSc1 advantage="None" conceptID="Res16" novelty="None" type="Res"/><text>It can be seen that wave heights at the beginning of the slope are well represented with all the equations used, but significant differences are evident as the waves approach the breaking point.</text></s>
<s sid="192"><CoreSc1 advantage="None" conceptID="Res17" novelty="None" type="Res"/><text>Madsen's equations significantly underpredict the peak wave height at breaking: this is consistent with the fact that these equations are based on the lowest order weakly-non-linear theory.</text></s>
<s sid="193"><CoreSc1 advantage="None" conceptID="Res18" novelty="None" type="Res"/><text>Nwogu's equations slightly underpredict wave height at the breaking point for test case 1 (see Fig. 2) while they overpredict peak wave height for test case 2 (see Fig. 3).</text></s>
From Figs.
<s sid="194"><CoreSc1 advantage="None" conceptID="Res19" novelty="None" type="Res"/><text>2 and 3 it can be noted that, for both test cases, the wave heights computed with the proposed fully non-linear model are in a better agreement with the experimental data in the shoaling region, at the breaking point and in the surf zone where wave energy decays.</text></s>
<s sid="195"><CoreSc1 advantage="None" conceptID="Res20" novelty="None" type="Res"/><text>The comparison between the computed wave heights obtained using the Nwogu's equations and those obtained using the proposed fully non linear Boussinesq model shows the importance of retaining terms up to O(εμ2) in variable depth power expansion.</text></s>
<s sid="196"><CoreSc1 advantage="None" conceptID="Obs9" novelty="None" type="Obs"/><text>Figs. 4 and 5 show the comparison between measured and computed values of the mean water level respectively for test cases 1 and 2: the computed values are obtained by using Madsen's equations, Nwogu's equations and the proposed fully non-linear Boussinesq model.</text></s>
From Figs.
<s sid="197"><CoreSc1 advantage="None" conceptID="Res21" novelty="None" type="Res"/><text>4 and 5 it can be seen that the prediction of the wave induced set-down and setup, obtained with all the above-mentioned equations, is in good agreement with the experimental data.</text></s>
<s sid="198"><CoreSc1 advantage="None" conceptID="Obs10" novelty="None" type="Obs"/><text>The capability of the model to adequately represent the flow characteristics in the surf zone will be further investigated with a two-dimensional test case in Section 5.4.</text></s>
<s sid="199"><CoreSc1 advantage="None" conceptID="Obs11" novelty="None" type="Obs"/><text>Spectral evolution over a submerged bar</text></s>
<s sid="200"><CoreSc1 advantage="None" conceptID="Obs12" novelty="None" type="Obs"/><text>The ability of the proposed model to simulate the wave decomposition and spectrum evolution over a submerged bar is verified: numerical results are compared against experimental results from two test cases presented by Beji and Battjes (1994) and two test cases presented by Beji and Battjes (1994) whose characteristics are listed in Table 2.</text></s>
<s sid="201"><CoreSc1 advantage="None" conceptID="Obs13" novelty="None" type="Obs"/><text>The above-mentioned authors performed an experimental study on the propagation of unidirectional regular and irregular waves over a submerged bar whose geometry is sketched is Fig. 6.</text></s>
<s sid="202"><CoreSc1 advantage="None" conceptID="Obs14" novelty="None" type="Obs"/><text>Beji and Battjes (1993, 1994) recorded the free surface elevation at different measurement stations whose location is sketched in Fig. 6.</text></s>
<s sid="203"><CoreSc1 advantage="None" conceptID="Obs15" novelty="None" type="Obs"/><text>The validation of the model proposed in this work is carried out by directly comparing the spectra presented by Beji and Battjes (1993, 1994) with the spectra obtained from the time series of the simulated free surface elevation in correspondence with the same measurement stations shown in Fig. 6.</text></s>
<s sid="204"><CoreSc1 advantage="None" conceptID="Met37" novelty="None" type="Met"/><text>The simulation of each of the irregular waves is performed starting from the generation, in the input section, of time series of the free surface elevation defined by JONSWAP type spectra with frequency peak fp and peak wave height Hp equal to those of the waves experimentally generated by Beji and Battjes (1993, 1994) and listed in Table 2.</text></s>
<s sid="205"><CoreSc1 advantage="None" conceptID="Met38" novelty="None" type="Met"/><text>The waves are internally generated at the abscissa x=0m (Fig. 6) following the procedure proposed by Wei et al. (1999).</text></s>
<s sid="206"><CoreSc1 advantage="None" conceptID="Met39" novelty="None" type="Met"/><text>This procedure requires the addition of a source function F(t) to the continuity equation.</text></s>
<s sid="207"><CoreSc1 advantage="None" conceptID="Met40" novelty="None" type="Met"/><text>With regard to the generation of irregular waves, the time series of the aforementioned source function is obtained as a superposition of N elementary harmonics each characterised by a frequency ωi, an amplitude Di and a random value of the phase ξi that follows a uniform probability distribution in the interval [0, 2π].</text></s>
<s sid="208"><CoreSc1 advantage="None" conceptID="Met41" novelty="None" type="Met"/><text>The expression of this source function is(29)Ft=∑i=1NDicosωit-ξiin which the i-th amplitude Di is computed starting from JONSWAP type spectra with the values of the peak frequency fp and peak wave height Hp equal to those of the waves performed by Beji and Battjes (1993, 1994) and listed in Table 2.</text></s>
<s sid="209"><CoreSc1 advantage="None" conceptID="Met42" novelty="None" type="Met"/><text>Consistent with Beji and Battjes (1993, 1994), for each of the random wave test cases (tests B, C and D in Table 2) five different simulations of the spatial and temporal evolution of the free surface elevation are carried out by varying the set of random values ξi for the phases of the elementary harmonics that compose the source function F(t).</text></s>
<s sid="210"><CoreSc1 advantage="None" conceptID="Met43" novelty="None" type="Met"/><text>In order to produce the power spectra, the statistical analysis of the time series of the simulated surface elevation, at points corresponding to the different measurement stations, is carried out according to the procedure described in Beji and Battjes (1993) and reported below.</text></s>
<s sid="211"><CoreSc1 advantage="None" conceptID="Met44" novelty="None" type="Met"/><text>Each of the aforementioned time series of the free surface elevation, containing 9000 data points, is divided into two parts each containing 4096 data points.</text></s>
<s sid="212"><CoreSc1 advantage="None" conceptID="Obs16" novelty="None" type="Obs"/><text>In this process the data points at the end of each series are discarded.</text></s>
<s sid="213"><CoreSc1 advantage="None" conceptID="Res22" novelty="None" type="Res"/><text>Each set of 4096 data points is divided into M data segments each of which is 10% cosine tapered.</text></s>
<s sid="214"><CoreSc1 advantage="None" conceptID="Res23" novelty="None" type="Res"/><text>Using a standard FFT package, from each of the aforesaid M data segments a power spectrum is computed.</text></s>
<s sid="215"><CoreSc1 advantage="None" conceptID="Res24" novelty="None" type="Res"/><text>Each of these spectra is rescaled to take account of the tapering (Bendat and Piersol, 1971).</text></s>
<s sid="216"><CoreSc1 advantage="None" conceptID="Res25" novelty="None" type="Res"/><text>Consistently with Beji and Battjes (1993, 1994), the spectra shown in this section are the result of an average in the frequency domain carried out on the spectra of all the data segments of the five different simulations.</text></s>
<s sid="217"><CoreSc1 advantage="None" conceptID="Obs17" novelty="None" type="Obs"/><text>In particular, for the test case B of Table 2 the number M of segments is equal to 4, each data segment is 40.98s long and the corresponding frequency resolution is equal to 0.024Hz.</text></s>
<s sid="218"><CoreSc1 advantage="None" conceptID="Res26" novelty="None" type="Res"/><text>The resulting spectral estimates have 80 degrees of freedom and a statistical error equal to 15.8% consistently with the spectral estimates shown in Beji and Battjes (1994).</text></s>
<s sid="219"><CoreSc1 advantage="None" conceptID="Obs18" novelty="None" type="Obs"/><text>For the test cases C and D of Table 2 the number M of data segments is equal to 16, each data segment is 25.6s long and the corresponding frequency resolution is equal to 0.039Hz.</text></s>
<s sid="220"><CoreSc1 advantage="None" conceptID="Res27" novelty="None" type="Res"/><text>The resulting spectra have 320 degrees of freedom and a statistical error equal to 7.9% consistently with the spectral estimates shown in Beji and Battjes (1993).</text></s>
<s sid="221"><CoreSc1 advantage="None" conceptID="Mod82" novelty="None" type="Mod"/><text>The numerical simulations are carried out with a spatial discretization step of 0.05m and a time step of 0.02s.</text></s>
<s sid="222"><CoreSc1 advantage="None" conceptID="Obs19" novelty="None" type="Obs"/><text>Fig. 7 shows the comparison between the computed and measured values of the free surface elevation for the regular wave shown in Beji and Battjes (1994) (test A of Table 2).</text></s>
<s sid="223"><CoreSc1 advantage="None" conceptID="Res28" novelty="None" type="Res"/><text>At station 2, the wave train is still almost sinusoidal and the agreement between numerical and experimental data is very good.</text></s>
<s sid="224"><CoreSc1 advantage="None" conceptID="Res29" novelty="None" type="Res"/><text>Also in the next stations the agreement between the numerical and experimental results is very good.</text></s>
<s sid="225"><CoreSc1 advantage="None" conceptID="Res30" novelty="None" type="Res"/><text>In particular, consistent with what had already been highlighted by Beji and Battjes (1994) in the successive stations the waves are progressively steepened by interaction with the bar and lose vertical symmetry to assume a typical sawtooth shape; furthermore the secondary wave mode gains energy from the main wave mode.</text></s>
<s sid="226"><CoreSc1 advantage="None" conceptID="Obs20" novelty="None" type="Obs"/><text>Fig. 7 shows the ability of the proposed model to simulate wave transformation due to the wave-bar interaction in terms of both phases and amplitudes.</text></s>
<s sid="227"><CoreSc1 advantage="None" conceptID="Obs21" novelty="None" type="Obs"/><text>In Fig. 8 is shown the spatial evolution of the spectrum of the non-breaking irregular wave (test B of Table 2).</text></s>
<s sid="228"><CoreSc1 advantage="None" conceptID="Obs22" novelty="None" type="Obs"/><text>In this figure the spectra from the simulated time series of surface elevation are compared against the spectra reported by Beji and Battjes (1994) for the same test case.</text></s>
<s sid="229"><CoreSc1 advantage="None" conceptID="Obs23" novelty="None" type="Obs"/><text>Fig. 8 shows a good agreement between the spectra obtained from the numerical simulations and those from the experiments, attesting the ability of the proposed model to correctly simulate the spectral evolution of irregular waves propagating over a submerged bar: both the bounded harmonics amplification phenomenon occurring during the shoaling process (stations 2 and 3 in Fig. 8) and the spectral decomposition occurring in the deepening region behind the bar, where free second and higher harmonics propagated in relatively deep water (stations 5, 6 and 7 in Fig. 8).</text></s>
<s sid="230"><CoreSc1 advantage="None" conceptID="Obs24" novelty="None" type="Obs"/><text>In Fig. 9 the spectral evolution of the non-breaking wave from Beji and Battjes (1993) (test C of Table 2) is compared with the spectra obtained from the numerical simulations carried out with the proposed model.</text></s>
<s sid="231"><CoreSc1 advantage="None" conceptID="Res31" novelty="None" type="Res"/><text>Consistent with Beji and Battjes (1993), all spectra shown are normalised so that the total area under each spectrum is equal to 1.</text></s>
<s sid="232"><CoreSc1 advantage="None" conceptID="Res32" novelty="None" type="Res"/><text>A good agreement can be seen between the results obtained from the numerical simulations and those from the experimental measurements of Beji and Battjes (1993) at all measurement stations.</text></s>
<s sid="233"><CoreSc1 advantage="None" conceptID="Obs25" novelty="None" type="Obs"/><text>From Fig. 9 it can be seen that the numerical model correctly represents the fact that the wave decomposition and the redistribution of the total energy among the fundamental harmonic and other harmonics mainly occur mainly occur, due to de-shoaling, in the region behind the bar where water depth increases once again.</text></s>
<s sid="234"><CoreSc1 advantage="None" conceptID="Obs26" novelty="None" type="Obs"/><text>In Fig. 10 is shown the comparison between the spatial evolution of the spectra obtained from the numerical simulations and those presented by Beji and Battjes (1993) for a breaking wave (test D of Table 2).</text></s>
<s sid="235"><CoreSc1 advantage="None" conceptID="Obs27" novelty="None" type="Obs"/><text>Once again, the agreement between the spectra obtained from the numerical simulations and those obtained from the experimental measurements is good.</text></s>
<s sid="236"><CoreSc1 advantage="None" conceptID="Obs28" novelty="None" type="Obs"/><text>Moreover, comparing Fig. 9 with Fig. 10, it can be seen that, in agreement with the experimental data, the spatial evolution of the spectra for the breaking wave does not show significant differences with the spatial evolution of the spectra for the non-breaking wave, as already noted by Beji and Battjes (1993).</text></s>
<s sid="237"><CoreSc1 advantage="None" conceptID="Res33" novelty="None" type="Res"/><text>Undertow prediction under breaking waves</text></s>
<s sid="238"><CoreSc1 advantage="None" conceptID="Con1" novelty="None" type="Con"/><text>In this section the ability of the proposed shock-capturing scheme to simulate vertical distribution of the horizontal velocity components under breaking waves is verified.</text></s>
<s sid="239"><CoreSc1 advantage="None" conceptID="Met45" novelty="None" type="Met"/><text>In the surf zone, vertical profiles of horizontal velocity components averaged over a wave period predicted by most of the Boussinesq models involving wave breaking dissipation models and by non-linear shallow water equations solved by shock-capturing schemes are characterised by uniform values below the mean trough level and by a direction opposite to that of the horizontal velocity above the mean trough level.</text></s>
<s sid="240"><CoreSc1 advantage="None" conceptID="Met46" novelty="None" type="Met"/><text>Lynett (2006) proved that these undertows below the mean trough level were underestimated by the above-mentioned Boussinesq models.</text></s>
<s sid="241"><CoreSc1 advantage="None" conceptID="Met47" novelty="None" type="Met"/><text>Lynett (2006) proposed a method to improve the undertow prediction obtained by the Boussinesq models which involve wave breaking dissipation models.</text></s>
<s sid="242"><CoreSc1 advantage="None" conceptID="Obs29" novelty="None" type="Obs"/><text>In particular, in the surf zone Lynett (2006) added a specific exponential profile a posteriori to the instantaneous vertical profile of the horizontal velocity components obtained by a Boussinesq model.</text></s>
<s sid="243"><CoreSc1 advantage="None" conceptID="Con2" novelty="None" type="Con"/><text>In the surf zone, vertical profiles of the horizontal velocity components averaged over a wave period obtained by the shock-capturing scheme proposed in this paper present distributions similar to those predicted by the Boussinesq models which involve breaking dissipation models and, in the same way as these, underestimate the undertow below the mean trough level, as it is shown in this section.</text></s>
<s sid="244"><CoreSc1 advantage="None" conceptID="Con3" novelty="None" type="Con"/><text>In this paper the improvement of the undertow predictions is obtained by using the methodology proposed by Lynett (2006).</text></s>
<s sid="245"><CoreSc1 advantage="None" conceptID="Obs30" novelty="None" type="Obs"/><text>In particular, the modified instantaneous vertical profile of the horizontal velocities u→L is given by(30)u→L=u→+u→Bwhere u→ is the instantaneous horizontal velocity vector obtained by the proposed model and u→B is the exponential vertical profile proposed in Lynett (2006).</text></s>
<s sid="246"><CoreSc1 advantage="None" conceptID="Obs31" novelty="None" type="Obs"/><text>The modified vertical profiles of the horizontal velocities averaged over a wave period and obtained with the proposed model are compared to the experimental data by Ting and Kirby (1996).</text></s>
<s sid="247"><CoreSc1 advantage="None" conceptID="Exp6" novelty="None" type="Exp"/><text>These experiments were performed in a 40m long wave flume in which a planar beach with a 1:35 slope was set.</text></s>
<s sid="248"><CoreSc1 advantage="None" conceptID="Obs32" novelty="None" type="Obs"/><text>The comparison between numerical and experimental results is made for the case of spilling breaking wave with a period of 2s presented by the above authors.</text></s>
<s sid="249"><CoreSc1 advantage="None" conceptID="Obs33" novelty="None" type="Obs"/><text>In Fig. 11 is shown the comparison between the measured and the computed mean crest level, the mean water level and the mean trough level.</text></s>
<s sid="250"><CoreSc1 advantage="None" conceptID="Obs34" novelty="None" type="Obs"/><text>The agreement between the experimental and numerical values is very good.</text></s>
<s sid="251"><CoreSc1 advantage="None" conceptID="Obs35" novelty="None" type="Obs"/><text>In the aforementioned procedure the only calibration parameter k to be specified is given as proportional to the inverse of the total water depth H.</text></s>
<s sid="252"><CoreSc1 advantage="None" conceptID="Obs36" novelty="None" type="Obs"/><text>In Lynett (2006) the value of this parameter is set to 5/H.</text></s>
<s sid="253"><CoreSc1 advantage="None" conceptID="Res34" novelty="None" type="Res"/><text>Lynett (2006) states that the value of this parameter can be different for different Boussinesq models and it has to be calibrated on a case-by-case basis.</text></s>
<s sid="254"><CoreSc1 advantage="None" conceptID="Res35" novelty="None" type="Res"/><text>The k value assumed in the simulations whose results are shown in Fig. 12 is equal to 3.8/H.</text></s>
<s sid="255"><CoreSc1 advantage="None" conceptID="Obs37" novelty="None" type="Obs"/><text>Fig. 12 shows the comparison between numerically simulated vertical profiles of the horizontal velocity components averaged over a wave period and the experimental values: both the modified and unmodified profiles are shown.</text></s>
<s sid="256"><CoreSc1 advantage="None" conceptID="Obs38" novelty="None" type="Obs"/><text>From Fig. 12 it can be seen that undertow prediction below the mean trough level carried out by solving the non-linear shallow water equations by means of the shock-capturing scheme proposed in this paper are underestimated with respect to the experimental results.</text></s>
<s sid="257"><CoreSc1 advantage="None" conceptID="Obs39" novelty="None" type="Obs"/><text>From the same figure it can be noted that the modified vertical profiles averaged over a wave period show an undertow prediction in good agreement with the experimental data.</text></s>
Symmetric channel constriction
<s sid="258"><CoreSc1 advantage="None" conceptID="Obs40" novelty="None" type="Obs"/><text>In this Section, the shock-capturing properties of the scheme when the equations are already switched to the non-linear shallow water equations are tested on highly distorted grids by means of the simulation of a super-critical flow in a channel with wall constrictions.</text></s>
<s sid="259"><CoreSc1 advantage="None" conceptID="Obs41" novelty="None" type="Obs"/><text>The channel is 40m wide and 90m long with two symmetrical wall constrictions from both sides with angle β=5° to the x-direction, starting from x=10m.</text></s>
<s sid="260"><CoreSc1 advantage="None" conceptID="Res36" novelty="None" type="Res"/><text>The simulations were run on two different grids: a 121×53 regular curvilinear grid, with nearly square-shaped calculation cells and a highly distorted grid obtained by deforming the above-mentioned 121×53 regular grid.</text></s>
<s sid="261"><CoreSc1 advantage="None" conceptID="Res37" novelty="None" type="Res"/><text>The initial and inflow conditions are the water depth h=1m and the Froude number Fr=2.5.</text></s>
<s sid="262"><CoreSc1 advantage="None" conceptID="Obs42" novelty="None" type="Obs"/><text>The result of the numerical simulation on the highly distorted grid is shown in Fig. 13.</text></s>
<s sid="263"><CoreSc1 advantage="None" conceptID="Obs43" novelty="None" type="Obs"/><text>In this figure the contour plot of the water depth with 16 uniformed spaced contour lines, from 1.05m to 1.8m, is shown.</text></s>
<s sid="264"><CoreSc1 advantage="None" conceptID="Res38" novelty="None" type="Res"/><text>It can be seen that the shocks are nicely resolved.</text></s>
<s sid="265"><CoreSc1 advantage="None" conceptID="Res39" novelty="None" type="Res"/><text>By comparing the numerical results with the analytical solution for this test case, computed by adopting the procedure proposed by Ippen (1951), L1 norms of the error in total water depth H and in modulus of the depth-averaged velocity vector u→ are computed and shown in Table 3.</text></s>
<s sid="266"><CoreSc1 advantage="None" conceptID="Res40" novelty="None" type="Res"/><text>It can be seen that the L1 norms of the error computed on highly distorted grids is less than 7% greater to the L1 norms of the error computed on the regular grid, despite the presence of discontinuities in the solution.</text></s>
<s sid="267"><CoreSc1 advantage="None" conceptID="Res41" novelty="None" type="Res"/><text>So the capability of the proposed scheme to simulate wave motion inside the surf zone, where shock waves are present, is not compromised by the presence of the highly distorted grid.</text></s>
<s sid="268"><CoreSc1 advantage="None" conceptID="Res42" novelty="None" type="Res"/><text>Convergence test: wave evolution in a rectangular basin</text></s>
<s sid="269"><CoreSc1 advantage="None" conceptID="Res43" novelty="None" type="Res"/><text>According to Shi et al. (2001) and Shi et al. (2003), the wave evolution in a closed basin is computed to test the numerical convergence of the scheme with both space and time discretisation.</text></s>
<s sid="270"><CoreSc1 advantage="None" conceptID="Res44" novelty="None" type="Res"/><text>The basin size is 20×20m and the water depth is constant at 0.5m.</text></s>
<s sid="271"><CoreSc1 advantage="None" conceptID="Obs44" novelty="None" type="Obs"/><text>The initial condition is a superelevation of the water surface above the still water level given by a motionless Gaussian hump placed at the centre of the basin:(31)η0=h0exp-12ϑ2x-xc2+y-yc2where h0=0.2m is the initial maximum elevation of the hump, ϑ=1.12 and (xc,yc) are the coordinates of the centre of the basin.</text></s>
<s sid="272"><CoreSc1 advantage="None" conceptID="Obs45" novelty="None" type="Obs"/><text>Spatial profiles of surface elevation at t=0,2,4,6,8 and 10s are shown in Fig. 14 for illustrative purposes.</text></s>
<s sid="273"><CoreSc1 advantage="None" conceptID="Obj20" novelty="None" type="Obj"/><text>In order to test convergence with space discretisation a sequence of different grid spacing is considered.</text></s>
<s sid="274"><CoreSc1 advantage="None" conceptID="Obs46" novelty="None" type="Obs"/><text>As in Shi et al. (2001) the sequence is given by Δx/i, with ∆x=0.4m and i=1,2,…,8.</text></s>
<s sid="275"><CoreSc1 advantage="None" conceptID="Res45" novelty="None" type="Res"/><text>The time step remains constant at Δt=0.01s for the different grid sizes.</text></s>
<s sid="276"><CoreSc1 advantage="None" conceptID="Res46" novelty="None" type="Res"/><text>The convergence rate with grid refinement is evaluated by the RMS differences of simulated surface elevations between i and i+1 at t=5s and at the same computational points.</text></s>
<s sid="277"><CoreSc1 advantage="None" conceptID="Res47" novelty="None" type="Res"/><text>The convergence rate is evaluated as in Shi et al. (2001) with the following formula:(32)Rij=logRMSi/RMSjlogΔxi/Δxj</text></s>
<s sid="278"><CoreSc1 advantage="None" conceptID="Res48" novelty="None" type="Res"/><text>Convergence rates with grid refinement are shown in Fig. 15.</text></s>
<s sid="279"><CoreSc1 advantage="None" conceptID="Res49" novelty="None" type="Res"/><text>The logarithmic RMS differences linearly decrease with the grid size, so the convergence rates can be considered fairly constant.</text></s>
<s sid="280"><CoreSc1 advantage="None" conceptID="Res50" novelty="None" type="Res"/><text>The average Ri,j obtained is 3.59 that is compatible with the fifth-order and second-order used in the scheme.</text></s>
<s sid="281"><CoreSc1 advantage="None" conceptID="Obj21" novelty="None" type="Obj"/><text>In order to test convergence with time discretisation a sequence of time steps is considered.</text></s>
<s sid="282"><CoreSc1 advantage="None" conceptID="Obs47" novelty="None" type="Obs"/><text>As in Shi et al. (2001) the sequence is given by ∆t/i with ∆t=0.2m and i=1,2,…,10.</text></s>
<s sid="283"><CoreSc1 advantage="None" conceptID="Obs48" novelty="None" type="Obs"/><text>Spatial discretisation is constant at ∆x=0.2m for all the tests.</text></s>
<s sid="284"><CoreSc1 advantage="None" conceptID="Obs49" novelty="None" type="Obs"/><text>Fig. 16 shows convergence rates with time refinement.</text></s>
<s sid="285"><CoreSc1 advantage="None" conceptID="Res51" novelty="None" type="Res"/><text>The average Rij obtained is 2.33.</text></s>
<s sid="286"><CoreSc1 advantage="None" conceptID="Res52" novelty="None" type="Res"/><text>This value obtained with the proposed third-order Runge-Kutta scheme is similar to that obtained by Shi et al.(2003) with a fourth-order Adams-Bashforth-Moulton predictor-corrector scheme.</text></s>
<s sid="287"><CoreSc1 advantage="None" conceptID="Res53" novelty="None" type="Res"/><text>It has to be noted that unlike the latter scheme, the proposed Runge-Kutta scheme allows an adaptive time-stepping as suggested by Shi et al. (2012).</text></s>
Rip current test
<s sid="288"><CoreSc1 advantage="None" conceptID="Goa4" novelty="None" type="Goa"/><text>The ability of the proposed model to reproduce wave propagation from deep water up to the shore, including the surf zone, and breaking induced nearshore circulation, is tested against a set of experimental data performed by Hamm (1992).</text></s>
<s sid="289"><CoreSc1 advantage="None" conceptID="Met48" novelty="None" type="Met"/><text>These experiments were conducted in a 30×30m wave tank.</text></s>
<s sid="290"><CoreSc1 advantage="None" conceptID="Met49" novelty="None" type="Met"/><text>The geometry of the bottom consisted of a horizontal region of water depth 0.5m followed by a planar slope of 1:30 with a rip channel excavated along the centre line (see Fig. 17).</text></s>
<s sid="291"><CoreSc1 advantage="None" conceptID="Met50" novelty="None" type="Met"/><text>In this work the test case performed by Hamm (1992) related to the evolution in the above-mentioned tank of a monochromatic wave with a period T=1.25s and height H0=0.07m is numerically reproduced.</text></s>
<s sid="292"><CoreSc1 advantage="None" conceptID="Met51" novelty="None" type="Met"/><text>The tank presents an axis of symmetry perpendicular to the wave generator, consequently only half of the wave tank is numerically simulated to save computational time.</text></s>
<s sid="293"><CoreSc1 advantage="None" conceptID="Met52" novelty="None" type="Met"/><text>Waves are internally generated at x=0m and a wide absorbing layer is set behind the generation zone, according to the procedure proposed by Wei et al. (1999).</text></s>
<s sid="294"><CoreSc1 advantage="None" conceptID="Met53" novelty="None" type="Met"/><text>A wet and dry technique is used to catch moving shoreline: if the water-depth at the centre of the computational cell is greater than a given threshold value the fluxes at the cell interfaces are computed using the wet bed solution of the Riemann problem, otherwise the fluxes at the cell interfaces are computed using the dry bed solution of the Riemann problem (Toro, 2001).</text></s>
<s sid="295"><CoreSc1 advantage="None" conceptID="Mod83" novelty="None" type="Mod"/><text>Simulations are carried out with the same constant friction factor, fw=0.03, suggested by Sørensen et al. (1998) and Tonelli and Petti (2012).</text></s>
<s sid="296"><CoreSc1 advantage="None" conceptID="Mod84" novelty="None" type="Mod"/><text>Reflective boundary conditions are used at lateral walls.</text></s>
<s sid="297"><CoreSc1 advantage="None" conceptID="Mod85" novelty="None" type="Mod"/><text>The simulations are run for 520s with a time step Δt=0.005s.</text></s>
<s sid="298"><CoreSc1 advantage="None" conceptID="Mod86" novelty="None" type="Mod"/><text>The simulations are carried out on three different computational grids: a Cartesian grid with Δx=0.05m and Δy=0.075m, a highly distorted grid obtained by deforming the above-mentioned Cartesian grid following the procedure proposed by Visbal and Gaitonde (2002) (see Fig. 18) and a curvilinear boundary conforming grid (see Fig. 19).</text></s>
<s sid="299"><CoreSc1 advantage="None" conceptID="Con4" novelty="None" type="Con"/><text>Let us indicate with FNBE the scheme obtained by applying the numerical integration procedure presented in Section 4 to the contravariant motion Eqs.</text></s>
<s sid="300"><CoreSc1 advantage="None" conceptID="Res54" novelty="None" type="Res"/><text>(19) and (21) that are accurate up to O(μ2) and O(εμ2) and include the term related to the approximation to the second order of the vertical vorticity.</text></s>
<s sid="301"><CoreSc1 advantage="None" conceptID="Met54" novelty="None" type="Met"/><text>Let us indicate with NBE the scheme obtained by applying the same numerical integration procedure to the contravariant motion equations obtained by neglecting in Eqs.</text></s>
<s sid="302"><CoreSc1 advantage="None" conceptID="Mod87" novelty="None" type="Mod"/><text>(19) and (21) the O(εμ2) contribution to the dispersive terms and the O(μ2) contribution to the vertical vorticity.</text></s>
<s sid="303"><CoreSc1 advantage="None" conceptID="Mod88" novelty="None" type="Mod"/><text>The neglected terms are given in Appendix B and consist of: a) all the terms that multiply η on the right-hand side of Eq.</text></s>
<s sid="304"><CoreSc1 advantage="None" conceptID="Mod89" novelty="None" type="Mod"/><text>(B.1); b) the third term on the right-hand side of Eq.</text></s>
<s sid="305"><CoreSc1 advantage="None" conceptID="Mod90" novelty="None" type="Mod"/><text>(B.3) and c) terms defined by Eqs.</text></s>
(B.4), (B.5) and (B.6).
<s sid="306"><CoreSc1 advantage="None" conceptID="Res55" novelty="None" type="Res"/><text>The equations resulting from neglecting the above-mentioned terms are accurate only up to O(μ2), do not include the term related to the approximation to the second order of the vertical vorticity and are consistent with the Boussinesq equations proposed by Nwogu (1993) in a Cartesian reference system.</text></s>
<s sid="307"><CoreSc1 advantage="None" conceptID="Obs50" novelty="None" type="Obs"/><text>Fig. 20 shows a snapshot of the wave field at t=190s, when the breaking induced circulations are fully developed, carried out by applying the FNBE scheme on the highly distorted grid illustrated in Fig. 18.</text></s>
<s sid="308"><CoreSc1 advantage="None" conceptID="Res56" novelty="None" type="Res"/><text>It must be emphasised that the Christoffel symbols, expressed by Eq.</text></s>
<s sid="309"><CoreSc1 advantage="None" conceptID="Res57" novelty="None" type="Res"/><text>(9), that appear in the contravariant formulation of the Boussinesq Eqs.</text></s>
<s sid="310"><CoreSc1 advantage="None" conceptID="Res58" novelty="None" type="Res"/><text>(13) and (14) are extra source terms that come in with the variability of the contravariant base vectors.</text></s>
<s sid="311"><CoreSc1 advantage="None" conceptID="Res59" novelty="None" type="Res"/><text>The numerical discretization of these terms introduces computational errors related to mesh non-uniformities that can affect the numerical solution.</text></s>
<s sid="312"><CoreSc1 advantage="None" conceptID="Res60" novelty="None" type="Res"/><text>The integral contravariant formulation of the fully non-linear Boussinesq equations, expressed by Eqs.</text></s>
<s sid="313"><CoreSc1 advantage="None" conceptID="Res61" novelty="None" type="Res"/><text>(19) and (21), is free of Christoffel symbols.</text></s>
<s sid="314"><CoreSc1 advantage="None" conceptID="Res62" novelty="None" type="Res"/><text>From Fig. 20 it is possible to highlight that spurious oscillations do not appear in the numerical solution even in domain regions characterised by a highly distorted computational grid.</text></s>
<s sid="315"><CoreSc1 advantage="None" conceptID="Res63" novelty="None" type="Res"/><text>Consequently it can be deduced that numerical solutions resulting from the integration of the contravariant equations in which Christoffel Symbols are absent are not affected by numerical errors that come in with the distortion of the grid cells.</text></s>
<s sid="316"><CoreSc1 advantage="None" conceptID="Obs51" novelty="None" type="Obs"/><text>In Fig. 21 the instantaneous surface elevation over the bathymetry obtained by applying the FNBE scheme on the curvilinear grid illustrated in Fig. 19 is shown.</text></s>
<s sid="317"><CoreSc1 advantage="None" conceptID="Res64" novelty="None" type="Res"/><text>The presence of the channel causes the occurrence of a rip current.</text></s>
<s sid="318"><CoreSc1 advantage="None" conceptID="Res65" novelty="None" type="Res"/><text>This current flowing offshore-ward interacts with the incoming waves.</text></s>
<s sid="319"><CoreSc1 advantage="None" conceptID="Res66" novelty="None" type="Res"/><text>As shown in Fig. 21, the effects of this interaction are an increment in wave height and a local bend in the wave fronts at the channel location.</text></s>
<s sid="320"><CoreSc1 advantage="None" conceptID="Obj22" novelty="None" type="Obj"/><text>In order to verify the need to retain terms up to O(μ2) and O(εμ2) in variable depth power expansion and the term related to the approximation to the second order of the vertical vorticity in the Boussinesq equations, the numerical results obtained with the FNBE scheme are compared with the results obtained with the NBE scheme.</text></s>
<s sid="321"><CoreSc1 advantage="None" conceptID="Obj23" novelty="None" type="Obj"/><text>Wave heights computed with the FNBE and NBE schemes on the three above-mentioned computational grids are compared with the wave heights measured by Hamm (1992) along two cross-sections: one inside the rip channel (see section A-A in Fig. 17) and one in the part of the domain characterised by linearly varying bottom elevation (see section B-B in Fig 17).</text></s>
<s sid="322"><CoreSc1 advantage="None" conceptID="Obs52" novelty="None" type="Obs"/><text>Figs. 22 and 23 show the results related respectively to these two sections and carried out by the FNBE and NBE scheme on the Cartesian grid.</text></s>
<s sid="323"><CoreSc1 advantage="None" conceptID="Con5" novelty="None" type="Con"/><text>It can be noted that using the NBE scheme the peak wave height at breaking is overestimated, especially for the rip channel section where the rip current opposing the incoming waves makes them steeper.</text></s>
<s sid="324"><CoreSc1 advantage="None" conceptID="Con6" novelty="None" type="Con"/><text>Numerical results carried out by the FNBE scheme show a better agreement with the experimental data.</text></s>
In Figs.
<s sid="325"><CoreSc1 advantage="None" conceptID="Res67" novelty="None" type="Res"/><text>24 and 25 the results, for sections A-A and B-B respectively (Fig. 17), obtained by applying the FNBE and NBE schemes on the distorted grid illustrated in Fig. 18 are compared with the experimental data: wave height profiles for the distorted grid are similar to those shown in Figs.</text></s>
<s sid="326"><CoreSc1 advantage="None" conceptID="Con7" novelty="None" type="Con"/><text>22 and 23 obtained by applying the FNBE and NBE schemes on the Cartesian grid.</text></s>
From Figs.
<s sid="327"><CoreSc1 advantage="None" conceptID="Con8" novelty="None" type="Con"/><text>24 and 25 it can once again be deduced that the wave transformation in the shoaling and breaking region is not altered by the highly distorted computational grid.</text></s>
In Figs.
<s sid="328"><CoreSc1 advantage="None" conceptID="Obj24" novelty="None" type="Obj"/><text>26 and 27 the wave heights respectively for the two cross-sections computed with the FNBE and NBE schemes applied on a curvilinear boundary conforming grid, illustrated in Fig. 19, are compared with the experimental data.</text></s>
<s sid="329"><CoreSc1 advantage="None" conceptID="Res68" novelty="None" type="Res"/><text>Wave heights computed on the curvilinear grid are similar to those already shown for the application of the FNBE and NBE scheme on the Cartesian grid (see Figs.</text></s>
<s sid="330"><CoreSc1 advantage="None" conceptID="Res69" novelty="None" type="Res"/><text>22 and 23) and on the highly distorted grid (see Figs.</text></s>
24 and 25).
<s sid="331"><CoreSc1 advantage="None" conceptID="Res70" novelty="None" type="Res"/><text>Consequently it has been shown that the retaining in the motion equations of the O(εμ2) contribution to the dispersive terms and the O(μ2) contribution to the vertical vorticity, gives rise to numerical results in a better agreement with the experimental data with respect to those obtained by neglecting them.</text></s>
<s sid="332"><CoreSc1 advantage="None" conceptID="Obs53" novelty="None" type="Obs"/><text>Fig. 28 shows the time-averaged velocity field and the mean water elevation carried out by applying the FNBE scheme on the curvilinear grid illustrated in Fig. 19.</text></s>
<s sid="333"><CoreSc1 advantage="None" conceptID="Res71" novelty="None" type="Res"/><text>In this figure it can be seen that the presence of the rip channel makes the waves break at different positions in the cross-shore direction.</text></s>
<s sid="334"><CoreSc1 advantage="None" conceptID="Res72" novelty="None" type="Res"/><text>The waves propagating on the part of the domain characterised by the linearly varying bottom elevation (section B-B in Fig. 17) and water depths lower than those present at the rip channel (section A-A in Fig. 17) start to break earlier than the waves propagating on the rip channel.</text></s>
<s sid="335"><CoreSc1 advantage="None" conceptID="Con9" novelty="None" type="Con"/><text>Different values of breaking induced wave setup cause gradients in mean water level elevation driving alongshore currents that turn offshore-ward producing the rip current at the channel location.</text></s>
<s sid="336"><CoreSc1 advantage="None" conceptID="Con10" novelty="None" type="Con"/><text>This figure shows the occurrence of a clockwise vortex, with the centre approximately at coordinates x=22m and y=14m.</text></s>
<s sid="337"><CoreSc1 advantage="None" conceptID="Con11" novelty="None" type="Con"/><text>Furthermore, it is possible to identify the occurrence of small vortices, located around the abscissa x=19m and between the ordinates y=5m and y=9m, that are not present in the velocity field obtained with the NBE.</text></s>
<s sid="338"><CoreSc1 advantage="None" conceptID="Con12" novelty="None" type="Con"/><text>In Fig. 29 a comparison between the time-averaged velocity field obtained with the FNBE and NBE schemes is shown.</text></s>
<s sid="339"><CoreSc1 advantage="None" conceptID="Con13" novelty="None" type="Con"/><text>From this figure it can be seen that the clockwise vortex, with the centre approximatively at coordinates x=22m and y=14m, resulting from the application of the FNBE scheme is larger than the one resulting from the application of the NBE scheme.</text></s>
<s sid="340"><CoreSc1 advantage="None" conceptID="Con14" novelty="None" type="Con"/><text>Furthermore, the NBE scheme produces longshore currents characterised by higher velocity values than those produced by the FNBE scheme: the maximum values for the alongshore velocities are respectively of 0.28m/s and 0.25m/s.</text></s>
<s sid="341"><CoreSc1 advantage="None" conceptID="Con15" novelty="None" type="Con"/><text>The presence in the motion equations of the term related to approximation to the second order of the vertical vorticity provides results that best represent the articulated and complex nature of the breaking induced nearshore circulations.</text></s>
Conclusions
<s sid="342"><CoreSc1 advantage="None" conceptID="Con16" novelty="None" type="Con"/><text>In this paper an integral form of the fully non-linear Boussinesq equations in contravariant formulation has been proposed in which Christoffel symbols are avoided in order to simulate wave transformation phenomena, wave breaking and nearshore currents in computational domains representing the complex morphology of real coastal regions.</text></s>
<s sid="343"><CoreSc1 advantage="None" conceptID="Con17" novelty="None" type="Con"/><text>The motion equations include the term related to the approximation to the second order of the vertical vorticity.</text></s>
<s sid="344"><CoreSc1 advantage="None" conceptID="Con18" novelty="None" type="Con"/><text>A new Upwind Weighted Essentially Non-Oscillatory scheme for the solution of the fully non-linear Boussinesq equations on generalised curvilinear coordinate systems has been proposed.</text></s>
<s sid="345"><CoreSc1 advantage="None" conceptID="Con19" novelty="None" type="Con"/><text>A high order shock capturing method in which an exact Riemann solver is involved has been used to intrinsically model the wave breaking.</text></s>
<s sid="346"><CoreSc1 advantage="None" conceptID="Con20" novelty="None" type="Con"/><text>It has been demonstrated that the proposed numerical scheme applied to the contravariant fully non-linear Boussinesq equations in which Chrystoffel symbols are absent has good non-oscillatory properties and good shock-capturing properties on highly distorted grids.</text></s>
<s sid="347"><CoreSc1 advantage="None" conceptID="Con21" novelty="None" type="Con"/><text>It has moreover been demonstrated that the proposed model permits us to represent, with good agreement with the experimental data, the wave evolution from deep waters up to the shoreline and the breaking induced nearshore currents on computational domains representing the complexity of real coastlines.</text></s>
<s sid="348"><CoreSc1 advantage="None" conceptID="Res73" novelty="None" type="Res"/><text>Furthermore, retaining in the motion equations the high order dispersive terms and the term related to the approximation to the second order of the vertical vorticity gives rise to simulations whose results are in a better agreement with the experimental data with respect to those obtained by neglecting them.</text></s>
<s sid="349"><CoreSc1 advantage="None" conceptID="Res74" novelty="None" type="Res"/><text>Cartesian expressions of the terms: s→, V→, V→', V→'' and W→</text></s>
<s sid="350"><CoreSc1 advantage="None" conceptID="Res75" novelty="None" type="Res"/><text>(A.1)s→=Hσ22-16h2-hη+η2∇∇⋅r→H+σ+12h-η∇∇⋅hr→H(A.2)V→=12σ2∇∇⋅∂∂tr→H+σ∇∇⋅h∂∂tr→H-∇12η2∇⋅∂∂tr→H+η∇⋅h∂∂tr→H(A.3)V→'=12σ2∇∇⋅r→H+σ∇∇⋅hr→H-∇12η2∇⋅r→H+η∇⋅hr→H(A.4)V→''=∇∂∂tη22∇⋅r→H+∇∂η∂t∇⋅hr→H(A.5)T→=∇σ-ηr→H⋅∇∇⋅hr→H+12σ2-η2r→H⋅∇∇⋅r→H+12∇∇⋅hr→H+η∇⋅r→H2(A.6)W→=i^Ω-syH-Θ-ryH+j^ΩsxH-ΘrxHin which: Ω=∂∂xryH-∂∂yrxH and Θ=∂∂xsxH-∂∂ysyH</text></s>
<s sid="351"><CoreSc1 advantage="None" conceptID="Res76" novelty="None" type="Res"/><text>Contravariant expression of the terms: sl, Vl, V'l, V''l, Tl and Wl</text></s>
(B.1)sl=h+ησ22-16h2-hη+η2glmrkH,k,m+σ+12h-ηglmhrkH,k,m(B.2)Vl=σ22glm∂∂trkH,k,m+σglmh∂∂trkH,k,m-glm12η2∂∂trkH,k+ηh∂∂trkH,k,m(B.3)V'l=12σ2glmrkH,k,m+σglmhrkH,k,m-glm12η2rkH,k+ηhrkH,k,m(B.4)V''l=glm∂∂tη22rkH,k,m+glm∂η∂thrkH,k,m(B.5)Tl=glmσ-ηriHhrkH,k,i+12σ2-η2riHrkH,k,i,m+12glmhrkH,k+ηrkH,k2,m(B.6)Wl=εmigipr,mpHεjlsjH+εmigips,mpHεjlrjHin which: εmi=1gifmiisanevenpermutationof(1,2)-1gifmiisanoddpermutationof(1,2)0ifthetwoindicesareequal

</BODY>
</PAPER>